!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("jQuery"),require("_"));else if("function"==typeof define&&define.amd)define(["jQuery","_"],t);else{var n="object"==typeof exports?t(require("jQuery"),require("_")):t(e.jQuery,e._);for(var i in n)("object"==typeof exports?exports:e)[i]=n[i]}}(this,function(e,t){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return e[i].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){e.exports=n(1)},function(e,t,n){"use strict";var i=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(2),o=n(3),s=n(4),a=n(5),l=n(8),c=n(10),u=n(82),h=n(83);n(94),n(95),n(97),n(98),n(100);var d=function(e){function t(){e.apply(this,arguments)}return i(t,e),t.prototype.onStart=function(){this._modalRegion=new u.ModalRegion,this._radio=new l.Radio,this._router=new c.Router,this._services=new h.Services,s.history.start({hashChange:!0,pushState:!1})||console.error("didn't route")},Object.defineProperty(t,"instance",{get:function(){return t._instance},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"radio",{get:function(){return this._radio},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"modalRegion",{get:function(){return this._modalRegion},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"router",{get:function(){return this._router},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"services",{get:function(){return this._services},enumerable:!0,configurable:!0}),t._instance=new t,t}(a.Application);t.Application=d,r(function(){o.extend(s.Model.prototype,s.Validation.mixin),d.instance.start()})},function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t,n){var i,r;(function(o){!function(s){var a="object"==typeof self&&self.self===self&&self||"object"==typeof o&&o.global===o&&o;i=[n(3),n(2),t],r=function(e,t,n){a.Backbone=s(a,n,e,t)}.apply(t,i),!(void 0!==r&&(e.exports=r))}(function(e,t,n,i){var r=e.Backbone,o=Array.prototype.slice;t.VERSION="1.3.3",t.$=i,t.noConflict=function(){return e.Backbone=r,this},t.emulateHTTP=!1,t.emulateJSON=!1;var s=function(e,t,i){switch(e){case 1:return function(){return n[t](this[i])};case 2:return function(e){return n[t](this[i],e)};case 3:return function(e,r){return n[t](this[i],l(e,this),r)};case 4:return function(e,r,o){return n[t](this[i],l(e,this),r,o)};default:return function(){var e=o.call(arguments);return e.unshift(this[i]),n[t].apply(n,e)}}},a=function(e,t,i){n.each(t,function(t,r){n[r]&&(e.prototype[r]=s(t,r,i))})},l=function(e,t){return n.isFunction(e)?e:n.isObject(e)&&!t._isModel(e)?c(e):n.isString(e)?function(t){return t.get(e)}:e},c=function(e){var t=n.matches(e);return function(e){return t(e.attributes)}},u=t.Events={},h=/\s+/,d=function(e,t,i,r,o){var s,a=0;if(i&&"object"==typeof i){void 0!==r&&"context"in o&&void 0===o.context&&(o.context=r);for(s=n.keys(i);a<s.length;a++)t=d(e,t,s[a],i[s[a]],o)}else if(i&&h.test(i))for(s=i.split(h);a<s.length;a++)t=e(t,s[a],r,o);else t=e(t,i,r,o);return t};u.on=function(e,t,n){return f(this,e,t,n)};var f=function(e,t,n,i,r){if(e._events=d(p,e._events||{},t,n,{context:i,ctx:e,listening:r}),r){var o=e._listeners||(e._listeners={});o[r.id]=r}return e};u.listenTo=function(e,t,i){if(!e)return this;var r=e._listenId||(e._listenId=n.uniqueId("l")),o=this._listeningTo||(this._listeningTo={}),s=o[r];if(!s){var a=this._listenId||(this._listenId=n.uniqueId("l"));s=o[r]={obj:e,objId:r,id:a,listeningTo:o,count:0}}return f(e,t,i,this,s),this};var p=function(e,t,n,i){if(n){var r=e[t]||(e[t]=[]),o=i.context,s=i.ctx,a=i.listening;a&&a.count++,r.push({callback:n,context:o,ctx:o||s,listening:a})}return e};u.off=function(e,t,n){return this._events?(this._events=d(g,this._events,e,t,{context:n,listeners:this._listeners}),this):this},u.stopListening=function(e,t,i){var r=this._listeningTo;if(!r)return this;for(var o=e?[e._listenId]:n.keys(r),s=0;s<o.length;s++){var a=r[o[s]];if(!a)break;a.obj.off(t,i,this)}return this};var g=function(e,t,i,r){if(e){var o,s=0,a=r.context,l=r.listeners;if(t||i||a){for(var c=t?[t]:n.keys(e);s<c.length;s++){t=c[s];var u=e[t];if(!u)break;for(var h=[],d=0;d<u.length;d++){var f=u[d];i&&i!==f.callback&&i!==f.callback._callback||a&&a!==f.context?h.push(f):(o=f.listening,o&&0===--o.count&&(delete l[o.id],delete o.listeningTo[o.objId]))}h.length?e[t]=h:delete e[t]}return e}for(var p=n.keys(l);s<p.length;s++)o=l[p[s]],delete l[o.id],delete o.listeningTo[o.objId]}};u.once=function(e,t,i){var r=d(v,{},e,t,n.bind(this.off,this));return"string"==typeof e&&null==i&&(t=void 0),this.on(r,t,i)},u.listenToOnce=function(e,t,i){var r=d(v,{},t,i,n.bind(this.stopListening,this,e));return this.listenTo(e,r)};var v=function(e,t,i,r){if(i){var o=e[t]=n.once(function(){r(t,o),i.apply(this,arguments)});o._callback=i}return e};u.trigger=function(e){if(!this._events)return this;for(var t=Math.max(0,arguments.length-1),n=Array(t),i=0;i<t;i++)n[i]=arguments[i+1];return d(m,this._events,e,void 0,n),this};var m=function(e,t,n,i){if(e){var r=e[t],o=e.all;r&&o&&(o=o.slice()),r&&y(r,i),o&&y(o,[t].concat(i))}return e},y=function(e,t){var n,i=-1,r=e.length,o=t[0],s=t[1],a=t[2];switch(t.length){case 0:for(;++i<r;)(n=e[i]).callback.call(n.ctx);return;case 1:for(;++i<r;)(n=e[i]).callback.call(n.ctx,o);return;case 2:for(;++i<r;)(n=e[i]).callback.call(n.ctx,o,s);return;case 3:for(;++i<r;)(n=e[i]).callback.call(n.ctx,o,s,a);return;default:for(;++i<r;)(n=e[i]).callback.apply(n.ctx,t);return}};u.bind=u.on,u.unbind=u.off,n.extend(t,u);var b=t.Model=function(e,t){var i=e||{};t||(t={}),this.cid=n.uniqueId(this.cidPrefix),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(i=this.parse(i,t)||{});var r=n.result(this,"defaults");i=n.defaults(n.extend({},r,i),r),this.set(i,t),this.changed={},this.initialize.apply(this,arguments)};n.extend(b.prototype,u,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",initialize:function(){},toJSON:function(e){return n.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return n.escape(this.get(e))},has:function(e){return null!=this.get(e)},matches:function(e){return!!n.iteratee(e,this)(this.attributes)},set:function(e,t,i){if(null==e)return this;var r;if("object"==typeof e?(r=e,i=t):(r={})[e]=t,i||(i={}),!this._validate(r,i))return!1;var o=i.unset,s=i.silent,a=[],l=this._changing;this._changing=!0,l||(this._previousAttributes=n.clone(this.attributes),this.changed={});var c=this.attributes,u=this.changed,h=this._previousAttributes;for(var d in r)t=r[d],n.isEqual(c[d],t)||a.push(d),n.isEqual(h[d],t)?delete u[d]:u[d]=t,o?delete c[d]:c[d]=t;if(this.idAttribute in r&&(this.id=this.get(this.idAttribute)),!s){a.length&&(this._pending=i);for(var f=0;f<a.length;f++)this.trigger("change:"+a[f],this,c[a[f]],i)}if(l)return this;if(!s)for(;this._pending;)i=this._pending,this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,n.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var i in this.attributes)t[i]=void 0;return this.set(t,n.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!n.isEmpty(this.changed):n.has(this.changed,e)},changedAttributes:function(e){if(!e)return!!this.hasChanged()&&n.clone(this.changed);var t=this._changing?this._previousAttributes:this.attributes,i={};for(var r in e){var o=e[r];n.isEqual(t[r],o)||(i[r]=o)}return!!n.size(i)&&i},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(e){e=n.extend({parse:!0},e);var t=this,i=e.success;return e.success=function(n){var r=e.parse?t.parse(n,e):n;return!!t.set(r,e)&&(i&&i.call(e.context,t,n,e),void t.trigger("sync",t,n,e))},z(this,e),this.sync("read",this,e)},save:function(e,t,i){var r;null==e||"object"==typeof e?(r=e,i=t):(r={})[e]=t,i=n.extend({validate:!0,parse:!0},i);var o=i.wait;if(r&&!o){if(!this.set(r,i))return!1}else if(!this._validate(r,i))return!1;var s=this,a=i.success,l=this.attributes;i.success=function(e){s.attributes=l;var t=i.parse?s.parse(e,i):e;return o&&(t=n.extend({},r,t)),!(t&&!s.set(t,i))&&(a&&a.call(i.context,s,e,i),void s.trigger("sync",s,e,i))},z(this,i),r&&o&&(this.attributes=n.extend({},l,r));var c=this.isNew()?"create":i.patch?"patch":"update";"patch"!==c||i.attrs||(i.attrs=r);var u=this.sync(c,this,i);return this.attributes=l,u},destroy:function(e){e=e?n.clone(e):{};var t=this,i=e.success,r=e.wait,o=function(){t.stopListening(),t.trigger("destroy",t,t.collection,e)};e.success=function(n){r&&o(),i&&i.call(e.context,t,n,e),t.isNew()||t.trigger("sync",t,n,e)};var s=!1;return this.isNew()?n.defer(e.success):(z(this,e),s=this.sync("delete",this,e)),r||o(),s},url:function(){var e=n.result(this,"urlRoot")||n.result(this.collection,"url")||j();if(this.isNew())return e;var t=this.get(this.idAttribute);return e.replace(/[^\/]$/,"$&/")+encodeURIComponent(t)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},n.extend({},e,{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=n.extend({},this.attributes,e);var i=this.validationError=this.validate(e,t)||null;return!i||(this.trigger("invalid",this,i,n.extend(t,{validationError:i})),!1)}});var w={keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1};a(b,w,"attributes");var _=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,n.extend({silent:!0},t))},x={add:!0,remove:!0,merge:!0},k={add:!0,remove:!1},S=function(e,t,n){n=Math.min(Math.max(n,0),e.length);var i,r=Array(e.length-n),o=t.length;for(i=0;i<r.length;i++)r[i]=e[i+n];for(i=0;i<o;i++)e[i+n]=t[i];for(i=0;i<r.length;i++)e[i+o+n]=r[i]};n.extend(_.prototype,u,{model:b,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,n.extend({merge:!1},t,k))},remove:function(e,t){t=n.extend({},t);var i=!n.isArray(e);e=i?[e]:e.slice();var r=this._removeModels(e,t);return!t.silent&&r.length&&(t.changes={added:[],merged:[],removed:r},this.trigger("update",this,t)),i?r[0]:r},set:function(e,t){if(null!=e){t=n.extend({},x,t),t.parse&&!this._isModel(e)&&(e=this.parse(e,t)||[]);var i=!n.isArray(e);e=i?[e]:e.slice();var r=t.at;null!=r&&(r=+r),r>this.length&&(r=this.length),r<0&&(r+=this.length+1);var o,s,a=[],l=[],c=[],u=[],h={},d=t.add,f=t.merge,p=t.remove,g=!1,v=this.comparator&&null==r&&t.sort!==!1,m=n.isString(this.comparator)?this.comparator:null;for(s=0;s<e.length;s++){o=e[s];var y=this.get(o);if(y){if(f&&o!==y){var b=this._isModel(o)?o.attributes:o;t.parse&&(b=y.parse(b,t)),y.set(b,t),c.push(y),v&&!g&&(g=y.hasChanged(m))}h[y.cid]||(h[y.cid]=!0,a.push(y)),e[s]=y}else d&&(o=e[s]=this._prepareModel(o,t),o&&(l.push(o),this._addReference(o,t),h[o.cid]=!0,a.push(o)))}if(p){for(s=0;s<this.length;s++)o=this.models[s],h[o.cid]||u.push(o);u.length&&this._removeModels(u,t)}var w=!1,_=!v&&d&&p;if(a.length&&_?(w=this.length!==a.length||n.some(this.models,function(e,t){return e!==a[t]}),this.models.length=0,S(this.models,a,0),this.length=this.models.length):l.length&&(v&&(g=!0),S(this.models,l,null==r?this.length:r),this.length=this.models.length),g&&this.sort({silent:!0}),!t.silent){for(s=0;s<l.length;s++)null!=r&&(t.index=r+s),o=l[s],o.trigger("add",o,this,t);(g||w)&&this.trigger("sort",this,t),(l.length||u.length||c.length)&&(t.changes={added:l,removed:u,merged:c},this.trigger("update",this,t))}return i?e[0]:e}},reset:function(e,t){t=t?n.clone(t):{};for(var i=0;i<this.models.length;i++)this._removeReference(this.models[i],t);return t.previousModels=this.models,this._reset(),e=this.add(e,n.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,n.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e)},unshift:function(e,t){return this.add(e,n.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e)},slice:function(){return o.apply(this.models,arguments)},get:function(e){if(null!=e)return this._byId[e]||this._byId[this.modelId(e.attributes||e)]||e.cid&&this._byId[e.cid]},has:function(e){return null!=this.get(e)},at:function(e){return e<0&&(e+=this.length),this.models[e]},where:function(e,t){return this[t?"find":"filter"](e)},findWhere:function(e){return this.where(e,!0)},sort:function(e){var t=this.comparator;if(!t)throw new Error("Cannot sort a set without a comparator");e||(e={});var i=t.length;return n.isFunction(t)&&(t=n.bind(t,this)),1===i||n.isString(t)?this.models=this.sortBy(t):this.models.sort(t),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return this.map(e+"")},fetch:function(e){e=n.extend({parse:!0},e);var t=e.success,i=this;return e.success=function(n){var r=e.reset?"reset":"set";i[r](n,e),t&&t.call(e.context,i,n,e),i.trigger("sync",i,n,e)},z(this,e),this.sync("read",this,e)},create:function(e,t){t=t?n.clone(t):{};var i=t.wait;if(e=this._prepareModel(e,t),!e)return!1;i||this.add(e,t);var r=this,o=t.success;return t.success=function(e,t,n){i&&r.add(e,n),o&&o.call(n.context,e,t,n)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(e){return e[this.model.prototype.idAttribute||"id"]},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(this._isModel(e))return e.collection||(e.collection=this),e;t=t?n.clone(t):{},t.collection=this;var i=new this.model(e,t);return i.validationError?(this.trigger("invalid",this,i.validationError,t),!1):i},_removeModels:function(e,t){for(var n=[],i=0;i<e.length;i++){var r=this.get(e[i]);if(r){var o=this.indexOf(r);this.models.splice(o,1),this.length--,delete this._byId[r.cid];var s=this.modelId(r.attributes);null!=s&&delete this._byId[s],t.silent||(t.index=o,r.trigger("remove",r,this,t)),n.push(r),this._removeReference(r,t)}}return n},_isModel:function(e){return e instanceof b},_addReference:function(e,t){this._byId[e.cid]=e;var n=this.modelId(e.attributes);null!=n&&(this._byId[n]=e),e.on("all",this._onModelEvent,this)},_removeReference:function(e,t){delete this._byId[e.cid];var n=this.modelId(e.attributes);null!=n&&delete this._byId[n],this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,i){if(t){if(("add"===e||"remove"===e)&&n!==this)return;if("destroy"===e&&this.remove(t,i),"change"===e){var r=this.modelId(t.previousAttributes()),o=this.modelId(t.attributes);r!==o&&(null!=r&&delete this._byId[r],null!=o&&(this._byId[o]=t))}}this.trigger.apply(this,arguments)}});var C={forEach:3,each:3,map:3,collect:3,reduce:0,foldl:0,inject:0,reduceRight:0,foldr:0,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3,findIndex:3,findLastIndex:3};a(_,C,"models");var F=t.View=function(e){this.cid=n.uniqueId("view"),n.extend(this,n.pick(e,O)),this._ensureElement(),this.initialize.apply(this,arguments)},E=/^(\S+)\s*(.*)$/,O=["model","collection","el","id","attributes","className","tagName","events"];n.extend(F.prototype,u,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(e){return this.undelegateEvents(),this._setElement(e),this.delegateEvents(),this},_setElement:function(e){this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0]},delegateEvents:function(e){if(e||(e=n.result(this,"events")),!e)return this;this.undelegateEvents();for(var t in e){var i=e[t];if(n.isFunction(i)||(i=this[i]),i){var r=t.match(E);this.delegate(r[1],r[2],n.bind(i,this))}}return this},delegate:function(e,t,n){return this.$el.on(e+".delegateEvents"+this.cid,t,n),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(e,t,n){return this.$el.off(e+".delegateEvents"+this.cid,t,n),this},_createElement:function(e){return document.createElement(e)},_ensureElement:function(){if(this.el)this.setElement(n.result(this,"el"));else{var e=n.extend({},n.result(this,"attributes"));this.id&&(e.id=n.result(this,"id")),this.className&&(e.class=n.result(this,"className")),this.setElement(this._createElement(n.result(this,"tagName"))),this._setAttributes(e)}},_setAttributes:function(e){this.$el.attr(e)}}),t.sync=function(e,i,r){var o=N[e];n.defaults(r||(r={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var s={type:o,dataType:"json"};if(r.url||(s.url=n.result(i,"url")||j()),null!=r.data||!i||"create"!==e&&"update"!==e&&"patch"!==e||(s.contentType="application/json",s.data=JSON.stringify(r.attrs||i.toJSON(r))),r.emulateJSON&&(s.contentType="application/x-www-form-urlencoded",s.data=s.data?{model:s.data}:{}),r.emulateHTTP&&("PUT"===o||"DELETE"===o||"PATCH"===o)){s.type="POST",r.emulateJSON&&(s.data._method=o);var a=r.beforeSend;r.beforeSend=function(e){if(e.setRequestHeader("X-HTTP-Method-Override",o),a)return a.apply(this,arguments)}}"GET"===s.type||r.emulateJSON||(s.processData=!1);var l=r.error;r.error=function(e,t,n){r.textStatus=t,r.errorThrown=n,l&&l.call(r.context,e,t,n)};var c=r.xhr=t.ajax(n.extend(s,r));return i.trigger("request",i,c,r),c};var N={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var $=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},I=/\((.*?)\)/g,T=/(\(\?)?:\w+/g,A=/\*\w+/g,V=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend($.prototype,u,{initialize:function(){},route:function(e,i,r){n.isRegExp(e)||(e=this._routeToRegExp(e)),n.isFunction(i)&&(r=i,i=""),r||(r=this[i]);var o=this;return t.history.route(e,function(n){var s=o._extractParameters(e,n);o.execute(r,s,i)!==!1&&(o.trigger.apply(o,["route:"+i].concat(s)),o.trigger("route",i,s),t.history.trigger("route",o,i,s))}),this},execute:function(e,t,n){e&&e.apply(this,t)},navigate:function(e,n){return t.history.navigate(e,n),this},_bindRoutes:function(){if(this.routes){this.routes=n.result(this,"routes");for(var e,t=n.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(V,"\\$&").replace(I,"(?:$1)?").replace(T,function(e,t){return t?e:"([^/?]+)"}).replace(A,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var i=e.exec(t).slice(1);return n.map(i,function(e,t){return t===i.length-1?e||null:e?decodeURIComponent(e):null})}});var M=t.History=function(){this.handlers=[],this.checkUrl=n.bind(this.checkUrl,this),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},R=/^[#\/]|\s+$/g,D=/^\/+|\/+$/g,P=/#.*$/;M.started=!1,n.extend(M.prototype,u,{interval:50,atRoot:function(){var e=this.location.pathname.replace(/[^\/]$/,"$&/");return e===this.root&&!this.getSearch()},matchRoot:function(){var e=this.decodeFragment(this.location.pathname),t=e.slice(0,this.root.length-1)+"/";return t===this.root},decodeFragment:function(e){return decodeURI(e.replace(/%25/g,"%2525"))},getSearch:function(){var e=this.location.href.replace(/#.*/,"").match(/\?.+/);return e?e[0]:""},getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getPath:function(){var e=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===e.charAt(0)?e.slice(1):e},getFragment:function(e){return null==e&&(e=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash()),e.replace(R,"")},start:function(e){if(M.started)throw new Error("Backbone.history has already been started");if(M.started=!0,this.options=n.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._hasHashChange="onhashchange"in window&&(void 0===document.documentMode||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.history||!this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(D,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var t=this.root.slice(0,-1)||"/";return this.location.replace(t+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var i=document.body,r=i.insertBefore(this.iframe,i.firstChild).contentWindow;r.document.open(),r.document.close(),r.location.hash="#"+this.fragment}var o=window.addEventListener||function(e,t){return attachEvent("on"+e,t)};if(this._usePushState?o("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?o("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),!this.options.silent)return this.loadUrl()},stop:function(){var e=window.removeEventListener||function(e,t){return detachEvent("on"+e,t)};this._usePushState?e("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&e("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),M.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();return t===this.fragment&&this.iframe&&(t=this.getHash(this.iframe.contentWindow)),t!==this.fragment&&(this.iframe&&this.navigate(t),void this.loadUrl())},loadUrl:function(e){return!!this.matchRoot()&&(e=this.fragment=this.getFragment(e),n.some(this.handlers,function(t){if(t.route.test(e))return t.callback(e),!0}))},navigate:function(e,t){if(!M.started)return!1;t&&t!==!0||(t={trigger:!!t}),e=this.getFragment(e||"");var n=this.root;""!==e&&"?"!==e.charAt(0)||(n=n.slice(0,-1)||"/");var i=n+e;if(e=this.decodeFragment(e.replace(P,"")),this.fragment!==e){if(this.fragment=e,this._usePushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);if(this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getHash(this.iframe.contentWindow)){var r=this.iframe.contentWindow;t.replace||(r.document.open(),r.document.close()),this._updateHash(r.location,e,t.replace)}}return t.trigger?this.loadUrl(e):void 0}},_updateHash:function(e,t,n){if(n){var i=e.href.replace(/(javascript:|#).*$/,"");e.replace(i+"#"+t)}else e.hash="#"+t}}),t.history=new M;var W=function(e,t){var i,r=this;return i=e&&n.has(e,"constructor")?e.constructor:function(){return r.apply(this,arguments)},n.extend(i,r,t),i.prototype=n.create(r.prototype,e),i.prototype.constructor=i,i.__super__=r.prototype,i};b.extend=_.extend=$.extend=F.extend=M.extend=W;var j=function(){throw new Error('A "url" property or function must be specified')},z=function(e,t){var n=t.error;t.error=function(i){n&&n.call(t.context,e,i,t),e.trigger("error",e,i,t)}};return t})}).call(t,function(){return this}())},function(e,t,n){var i,r;!function(o,s){i=[n(4),n(3),n(6),n(7)],r=function(e,t){return o.Marionette=o.Mn=s(o,e,t)}.apply(t,i),!(void 0!==r&&(e.exports=r))}(this,function(e,t,n){"use strict";var i=e.Marionette,r=e.Mn,o=t.Marionette={};o.VERSION="2.4.7",o.noConflict=function(){return e.Marionette=i,e.Mn=r,this},o.Deferred=t.$.Deferred,o.FEATURES={},o.isEnabled=function(e){return!!o.FEATURES[e]},o.extend=t.Model.extend,o.isNodeAttached=function(e){return t.$.contains(document.documentElement,e)},o.mergeOptions=function(e,t){e&&n.extend(this,n.pick(e,t))},o.getOption=function(e,t){if(e&&t)return e.options&&void 0!==e.options[t]?e.options[t]:e[t]},o.proxyGetOption=function(e){return o.getOption(this,e)},o._getValue=function(e,t,i){return n.isFunction(e)&&(e=i?e.apply(t,i):e.call(t)),e},o.normalizeMethods=function(e){return n.reduce(e,function(e,t,i){return n.isFunction(t)||(t=this[t]),t&&(e[i]=t),e},{},this)},o.normalizeUIString=function(e,t){return e.replace(/@ui\.[a-zA-Z-_$0-9]*/g,function(e){return t[e.slice(4)]})},o.normalizeUIKeys=function(e,t){return n.reduce(e,function(e,n,i){var r=o.normalizeUIString(i,t);return e[r]=n,e},{})},o.normalizeUIValues=function(e,t,i){return n.each(e,function(r,s){n.isString(r)?e[s]=o.normalizeUIString(r,t):n.isObject(r)&&n.isArray(i)&&(n.extend(r,o.normalizeUIValues(n.pick(r,i),t)),n.each(i,function(e){var i=r[e];n.isString(i)&&(r[e]=o.normalizeUIString(i,t))}))}),e},o.actAsCollection=function(e,t){var i=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];n.each(i,function(i){e[i]=function(){var e=n.values(n.result(this,t)),r=[e].concat(n.toArray(arguments));return n[i].apply(n,r)}})};var s=o.deprecate=function(e,t){n.isObject(e)&&(e=e.prev+" is going to be removed in the future. Please use "+e.next+" instead."+(e.url?" See: "+e.url:"")),void 0!==t&&t||s._cache[e]||(s._warn("Deprecation warning: "+e),s._cache[e]=!0)};s._console="undefined"!=typeof console?console:{},s._warn=function(){var e=s._console.warn||s._console.log||function(){};return e.apply(s._console,arguments)},s._cache={},o._triggerMethod=function(){function e(e,t,n){return n.toUpperCase()}var t=/(^|:)(\w)/gi;return function(i,r,o){var s=arguments.length<3;s&&(o=r,r=o[0]);var a,l="on"+r.replace(t,e),c=i[l];return n.isFunction(c)&&(a=c.apply(i,s?n.rest(o):o)),n.isFunction(i.trigger)&&(s+o.length>1?i.trigger.apply(i,s?o:[r].concat(n.drop(o,0))):i.trigger(r)),a}}(),o.triggerMethod=function(e){return o._triggerMethod(this,arguments)},o.triggerMethodOn=function(e){var t=n.isFunction(e.triggerMethod)?e.triggerMethod:o.triggerMethod;return t.apply(e,n.rest(arguments))},o.MonitorDOMRefresh=function(e){function t(){e._isShown=!0,i()}function n(){e._isRendered=!0,i()}function i(){e._isShown&&e._isRendered&&o.isNodeAttached(e.el)&&o.triggerMethodOn(e,"dom:refresh",e)}e._isDomRefreshMonitored||(e._isDomRefreshMonitored=!0,e.on({show:t,render:n}))},function(e){function t(t,i,r,o){var s=o.split(/\s+/);n.each(s,function(n){var o=t[n];if(!o)throw new e.Error('Method "'+n+'" was configured as an event handler, but does not exist.');t.listenTo(i,r,o)})}function i(e,t,n,i){e.listenTo(t,n,i)}function r(e,t,i,r){var o=r.split(/\s+/);n.each(o,function(n){var r=e[n];e.stopListening(t,i,r)})}function o(e,t,n,i){e.stopListening(t,n,i)}function s(t,i,r,o,s){if(i&&r){if(!n.isObject(r))throw new e.Error({message:"Bindings must be an object or function.",url:"marionette.functions.html#marionettebindentityevents"});r=e._getValue(r,t),n.each(r,function(e,r){n.isFunction(e)?o(t,i,r,e):s(t,i,r,e)})}}e.bindEntityEvents=function(e,n,r){s(e,n,r,i,t)},e.unbindEntityEvents=function(e,t,n){s(e,t,n,o,r)},e.proxyBindEntityEvents=function(t,n){return e.bindEntityEvents(this,t,n)},e.proxyUnbindEntityEvents=function(t,n){return e.unbindEntityEvents(this,t,n)}}(o);var a=["description","fileName","lineNumber","name","message","number"];return o.Error=o.extend.call(Error,{urlRoot:"http://marionettejs.com/docs/v"+o.VERSION+"/",constructor:function(e,t){n.isObject(e)?(t=e,e=t.message):t||(t={});var i=Error.call(this,e);n.extend(this,n.pick(i,a),n.pick(t,a)),this.captureStackTrace(),t.url&&(this.url=this.urlRoot+t.url)},captureStackTrace:function(){Error.captureStackTrace&&Error.captureStackTrace(this,o.Error)},toString:function(){return this.name+": "+this.message+(this.url?" See: "+this.url:"")}}),o.Error.extend=o.extend,o.Callbacks=function(){this._deferred=o.Deferred(),this._callbacks=[]},n.extend(o.Callbacks.prototype,{add:function(e,t){var i=n.result(this._deferred,"promise");this._callbacks.push({cb:e,ctx:t}),i.then(function(n){t&&(n.context=t),e.call(n.context,n.options)})},run:function(e,t){this._deferred.resolve({options:e,context:t})},reset:function(){var e=this._callbacks;this._deferred=o.Deferred(),this._callbacks=[],n.each(e,function(e){this.add(e.cb,e.ctx)},this)}}),o.Controller=function(e){this.options=e||{},n.isFunction(this.initialize)&&this.initialize(this.options)},o.Controller.extend=o.extend,n.extend(o.Controller.prototype,t.Events,{destroy:function(){return o._triggerMethod(this,"before:destroy",arguments),o._triggerMethod(this,"destroy",arguments),this.stopListening(),this.off(),this},triggerMethod:o.triggerMethod,mergeOptions:o.mergeOptions,getOption:o.proxyGetOption}),o.Object=function(e){this.options=n.extend({},n.result(this,"options"),e),this.initialize.apply(this,arguments)},o.Object.extend=o.extend,n.extend(o.Object.prototype,t.Events,{initialize:function(){},destroy:function(e){return e=e||{},this.triggerMethod("before:destroy",e),this.triggerMethod("destroy",e),this.stopListening(),this},triggerMethod:o.triggerMethod,mergeOptions:o.mergeOptions,getOption:o.proxyGetOption,bindEntityEvents:o.proxyBindEntityEvents,unbindEntityEvents:o.proxyUnbindEntityEvents}),o.Region=o.Object.extend({constructor:function(e){if(this.options=e||{},this.el=this.getOption("el"),this.el=this.el instanceof t.$?this.el[0]:this.el,!this.el)throw new o.Error({name:"NoElError",message:'An "el" must be specified for a region.'});this.$el=this.getEl(this.el),o.Object.call(this,e)},show:function(e,t){if(this._ensureElement()){this._ensureViewIsIntact(e),o.MonitorDOMRefresh(e);var i=t||{},r=e!==this.currentView,s=!!i.preventDestroy,a=!!i.forceShow,l=!!this.currentView,c=r&&!s,u=r||a;if(l&&this.triggerMethod("before:swapOut",this.currentView,this,t),this.currentView&&r&&delete this.currentView._parent,c?this.empty():l&&u&&this.currentView.off("destroy",this.empty,this),u){e.once("destroy",this.empty,this),e._parent=this,this._renderView(e),l&&this.triggerMethod("before:swap",e,this,t),this.triggerMethod("before:show",e,this,t),o.triggerMethodOn(e,"before:show",e,this,t),l&&this.triggerMethod("swapOut",this.currentView,this,t);var h=o.isNodeAttached(this.el),d=[],f=n.extend({triggerBeforeAttach:this.triggerBeforeAttach,triggerAttach:this.triggerAttach},i);return h&&f.triggerBeforeAttach&&(d=this._displayedViews(e),this._triggerAttach(d,"before:")),this.attachHtml(e),this.currentView=e,h&&f.triggerAttach&&(d=this._displayedViews(e),this._triggerAttach(d)),l&&this.triggerMethod("swap",e,this,t),this.triggerMethod("show",e,this,t),o.triggerMethodOn(e,"show",e,this,t),this}return this}},triggerBeforeAttach:!0,triggerAttach:!0,_triggerAttach:function(e,t){var i=(t||"")+"attach";n.each(e,function(e){o.triggerMethodOn(e,i,e,this)},this)},_displayedViews:function(e){return n.union([e],n.result(e,"_getNestedViews")||[])},_renderView:function(e){e.supportsRenderLifecycle||o.triggerMethodOn(e,"before:render",e),e.render(),e.supportsRenderLifecycle||o.triggerMethodOn(e,"render",e)},_ensureElement:function(){if(n.isObject(this.el)||(this.$el=this.getEl(this.el),
this.el=this.$el[0]),!this.$el||0===this.$el.length){if(this.getOption("allowMissingEl"))return!1;throw new o.Error('An "el" '+this.$el.selector+" must exist in DOM")}return!0},_ensureViewIsIntact:function(e){if(!e)throw new o.Error({name:"ViewNotValid",message:"The view passed is undefined and therefore invalid. You must pass a view instance to show."});if(e.isDestroyed)throw new o.Error({name:"ViewDestroyedError",message:'View (cid: "'+e.cid+'") has already been destroyed and cannot be used.'})},getEl:function(e){return t.$(e,o._getValue(this.options.parentEl,this))},attachHtml:function(e){this.$el.contents().detach(),this.el.appendChild(e.el)},empty:function(e){var t=this.currentView,n=e||{},i=!!n.preventDestroy;return t?(t.off("destroy",this.empty,this),this.triggerMethod("before:empty",t),i||this._destroyView(),this.triggerMethod("empty",t),delete this.currentView,i&&this.$el.contents().detach(),this):this},_destroyView:function(){var e=this.currentView;e.isDestroyed||(e.supportsDestroyLifecycle||o.triggerMethodOn(e,"before:destroy",e),e.destroy?e.destroy():(e.remove(),e.isDestroyed=!0),e.supportsDestroyLifecycle||o.triggerMethodOn(e,"destroy",e))},attachView:function(e){return this.currentView&&delete this.currentView._parent,e._parent=this,this.currentView=e,this},hasView:function(){return!!this.currentView},reset:function(){return this.empty(),this.$el&&(this.el=this.$el.selector),delete this.$el,this}},{buildRegion:function(e,t){if(n.isString(e))return this._buildRegionFromSelector(e,t);if(e.selector||e.el||e.regionClass)return this._buildRegionFromObject(e,t);if(n.isFunction(e))return this._buildRegionFromRegionClass(e);throw new o.Error({message:"Improper region configuration type.",url:"marionette.region.html#region-configuration-types"})},_buildRegionFromSelector:function(e,t){return new t({el:e})},_buildRegionFromObject:function(e,t){var i=e.regionClass||t,r=n.omit(e,"selector","regionClass");return e.selector&&!r.el&&(r.el=e.selector),new i(r)},_buildRegionFromRegionClass:function(e){return new e}}),o.RegionManager=o.Controller.extend({constructor:function(e){this._regions={},this.length=0,o.Controller.call(this,e),this.addRegions(this.getOption("regions"))},addRegions:function(e,t){return e=o._getValue(e,this,arguments),n.reduce(e,function(e,i,r){return n.isString(i)&&(i={selector:i}),i.selector&&(i=n.defaults({},i,t)),e[r]=this.addRegion(r,i),e},{},this)},addRegion:function(e,t){var n;return n=t instanceof o.Region?t:o.Region.buildRegion(t,o.Region),this.triggerMethod("before:add:region",e,n),n._parent=this,this._store(e,n),this.triggerMethod("add:region",e,n),n},get:function(e){return this._regions[e]},getRegions:function(){return n.clone(this._regions)},removeRegion:function(e){var t=this._regions[e];return this._remove(e,t),t},removeRegions:function(){var e=this.getRegions();return n.each(this._regions,function(e,t){this._remove(t,e)},this),e},emptyRegions:function(){var e=this.getRegions();return n.invoke(e,"empty"),e},destroy:function(){return this.removeRegions(),o.Controller.prototype.destroy.apply(this,arguments)},_store:function(e,t){this._regions[e]||this.length++,this._regions[e]=t},_remove:function(e,t){this.triggerMethod("before:remove:region",e,t),t.empty(),t.stopListening(),delete t._parent,delete this._regions[e],this.length--,this.triggerMethod("remove:region",e,t)}}),o.actAsCollection(o.RegionManager.prototype,"_regions"),o.TemplateCache=function(e){this.templateId=e},n.extend(o.TemplateCache,{templateCaches:{},get:function(e,t){var n=this.templateCaches[e];return n||(n=new o.TemplateCache(e),this.templateCaches[e]=n),n.load(t)},clear:function(){var e,t=n.toArray(arguments),i=t.length;if(i>0)for(e=0;e<i;e++)delete this.templateCaches[t[e]];else this.templateCaches={}}}),n.extend(o.TemplateCache.prototype,{load:function(e){if(this.compiledTemplate)return this.compiledTemplate;var t=this.loadTemplate(this.templateId,e);return this.compiledTemplate=this.compileTemplate(t,e),this.compiledTemplate},loadTemplate:function(e,n){var i=t.$(e);if(!i.length)throw new o.Error({name:"NoTemplateError",message:'Could not find template: "'+e+'"'});return i.html()},compileTemplate:function(e,t){return n.template(e,t)}}),o.Renderer={render:function(e,t){if(!e)throw new o.Error({name:"TemplateNotFoundError",message:"Cannot render the template since its false, null or undefined."});var i=n.isFunction(e)?e:o.TemplateCache.get(e);return i(t)}},o.View=t.View.extend({isDestroyed:!1,supportsRenderLifecycle:!0,supportsDestroyLifecycle:!0,constructor:function(e){this.render=n.bind(this.render,this),e=o._getValue(e,this),this.options=n.extend({},n.result(this,"options"),e),this._behaviors=o.Behaviors(this),t.View.call(this,this.options),o.MonitorDOMRefresh(this)},getTemplate:function(){return this.getOption("template")},serializeModel:function(e){return e.toJSON.apply(e,n.rest(arguments))},mixinTemplateHelpers:function(e){e=e||{};var t=this.getOption("templateHelpers");return t=o._getValue(t,this),n.extend(e,t)},normalizeUIKeys:function(e){var t=n.result(this,"_uiBindings");return o.normalizeUIKeys(e,t||n.result(this,"ui"))},normalizeUIValues:function(e,t){var i=n.result(this,"ui"),r=n.result(this,"_uiBindings");return o.normalizeUIValues(e,r||i,t)},configureTriggers:function(){if(this.triggers){var e=this.normalizeUIKeys(n.result(this,"triggers"));return n.reduce(e,function(e,t,n){return e[n]=this._buildViewTrigger(t),e},{},this)}},delegateEvents:function(e){return this._delegateDOMEvents(e),this.bindEntityEvents(this.model,this.getOption("modelEvents")),this.bindEntityEvents(this.collection,this.getOption("collectionEvents")),n.each(this._behaviors,function(e){e.bindEntityEvents(this.model,e.getOption("modelEvents")),e.bindEntityEvents(this.collection,e.getOption("collectionEvents"))},this),this},_delegateDOMEvents:function(e){var i=o._getValue(e||this.events,this);i=this.normalizeUIKeys(i),n.isUndefined(e)&&(this.events=i);var r={},s=n.result(this,"behaviorEvents")||{},a=this.configureTriggers(),l=n.result(this,"behaviorTriggers")||{};n.extend(r,s,i,a,l),t.View.prototype.delegateEvents.call(this,r)},undelegateEvents:function(){return t.View.prototype.undelegateEvents.apply(this,arguments),this.unbindEntityEvents(this.model,this.getOption("modelEvents")),this.unbindEntityEvents(this.collection,this.getOption("collectionEvents")),n.each(this._behaviors,function(e){e.unbindEntityEvents(this.model,e.getOption("modelEvents")),e.unbindEntityEvents(this.collection,e.getOption("collectionEvents"))},this),this},_ensureViewIsIntact:function(){if(this.isDestroyed)throw new o.Error({name:"ViewDestroyedError",message:'View (cid: "'+this.cid+'") has already been destroyed and cannot be used.'})},destroy:function(){if(this.isDestroyed)return this;var e=n.toArray(arguments);return this.triggerMethod.apply(this,["before:destroy"].concat(e)),this.isDestroyed=!0,this.triggerMethod.apply(this,["destroy"].concat(e)),this.unbindUIElements(),this.isRendered=!1,this.remove(),n.invoke(this._behaviors,"destroy",e),this},bindUIElements:function(){this._bindUIElements(),n.invoke(this._behaviors,this._bindUIElements)},_bindUIElements:function(){if(this.ui){this._uiBindings||(this._uiBindings=this.ui);var e=n.result(this,"_uiBindings");this.ui={},n.each(e,function(e,t){this.ui[t]=this.$(e)},this)}},unbindUIElements:function(){this._unbindUIElements(),n.invoke(this._behaviors,this._unbindUIElements)},_unbindUIElements:function(){this.ui&&this._uiBindings&&(n.each(this.ui,function(e,t){delete this.ui[t]},this),this.ui=this._uiBindings,delete this._uiBindings)},_buildViewTrigger:function(e){var t=n.defaults({},e,{preventDefault:!0,stopPropagation:!0}),i=n.isObject(e)?t.event:e;return function(e){e&&(e.preventDefault&&t.preventDefault&&e.preventDefault(),e.stopPropagation&&t.stopPropagation&&e.stopPropagation());var n={view:this,model:this.model,collection:this.collection};this.triggerMethod(i,n)}},setElement:function(){var e=t.View.prototype.setElement.apply(this,arguments);return n.invoke(this._behaviors,"proxyViewProperties",this),e},triggerMethod:function(){var e=o._triggerMethod(this,arguments);return this._triggerEventOnBehaviors(arguments),this._triggerEventOnParentLayout(arguments[0],n.rest(arguments)),e},_triggerEventOnBehaviors:function(e){for(var t=o._triggerMethod,n=this._behaviors,i=0,r=n&&n.length;i<r;i++)t(n[i],e)},_triggerEventOnParentLayout:function(e,t){var i=this._parentLayoutView();if(i){var r=o.getOption(i,"childViewEventPrefix"),s=r+":"+e,a=[this].concat(t);o._triggerMethod(i,s,a);var l=o.getOption(i,"childEvents");l=o._getValue(l,i);var c=i.normalizeMethods(l);c&&n.isFunction(c[e])&&c[e].apply(i,a)}},_getImmediateChildren:function(){return[]},_getNestedViews:function(){var e=this._getImmediateChildren();return e.length?n.reduce(e,function(e,t){return t._getNestedViews?e.concat(t._getNestedViews()):e},e):e},_parentLayoutView:function(){for(var e=this._parent;e;){if(e instanceof o.LayoutView)return e;e=e._parent}},normalizeMethods:o.normalizeMethods,mergeOptions:o.mergeOptions,getOption:o.proxyGetOption,bindEntityEvents:o.proxyBindEntityEvents,unbindEntityEvents:o.proxyUnbindEntityEvents}),o.ItemView=o.View.extend({constructor:function(){o.View.apply(this,arguments)},serializeData:function(){if(!this.model&&!this.collection)return{};var e=[this.model||this.collection];return arguments.length&&e.push.apply(e,arguments),this.model?this.serializeModel.apply(this,e):{items:this.serializeCollection.apply(this,e)}},serializeCollection:function(e){return e.toJSON.apply(e,n.rest(arguments))},render:function(){return this._ensureViewIsIntact(),this.triggerMethod("before:render",this),this._renderTemplate(),this.isRendered=!0,this.bindUIElements(),this.triggerMethod("render",this),this},_renderTemplate:function(){var e=this.getTemplate();if(e!==!1){if(!e)throw new o.Error({name:"UndefinedTemplateError",message:"Cannot render the template since it is null or undefined."});var t=this.mixinTemplateHelpers(this.serializeData()),n=o.Renderer.render(e,t,this);return this.attachElContent(n),this}},attachElContent:function(e){return this.$el.html(e),this}}),o.CollectionView=o.View.extend({childViewEventPrefix:"childview",sort:!0,constructor:function(e){this.once("render",this._initialEvents),this._initChildViewStorage(),o.View.apply(this,arguments),this.on({"before:show":this._onBeforeShowCalled,show:this._onShowCalled,"before:attach":this._onBeforeAttachCalled,attach:this._onAttachCalled}),this.initRenderBuffer()},initRenderBuffer:function(){this._bufferedChildren=[]},startBuffering:function(){this.initRenderBuffer(),this.isBuffering=!0},endBuffering:function(){var e,t=this._isShown&&o.isNodeAttached(this.el);this.isBuffering=!1,this._isShown&&this._triggerMethodMany(this._bufferedChildren,this,"before:show"),t&&this._triggerBeforeAttach&&(e=this._getNestedViews(),this._triggerMethodMany(e,this,"before:attach")),this.attachBuffer(this,this._createBuffer()),t&&this._triggerAttach&&(e=this._getNestedViews(),this._triggerMethodMany(e,this,"attach")),this._isShown&&this._triggerMethodMany(this._bufferedChildren,this,"show"),this.initRenderBuffer()},_triggerMethodMany:function(e,t,i){var r=n.drop(arguments,3);n.each(e,function(e){o.triggerMethodOn.apply(e,[e,i,e,t].concat(r))})},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this._onCollectionAdd),this.listenTo(this.collection,"remove",this._onCollectionRemove),this.listenTo(this.collection,"reset",this.render),this.getOption("sort")&&this.listenTo(this.collection,"sort",this._sortViews))},_onCollectionAdd:function(e,t,i){var r=void 0!==i.at&&(i.index||t.indexOf(e));if((this.getOption("filter")||r===!1)&&(r=n.indexOf(this._filteredSortedModels(r),e)),this._shouldAddChild(e,r)){this.destroyEmptyView();var o=this.getChildView(e);this.addChild(e,o,r)}},_onCollectionRemove:function(e){var t=this.children.findByModel(e);this.removeChildView(t),this.checkEmpty()},_onBeforeShowCalled:function(){this._triggerBeforeAttach=this._triggerAttach=!1,this.children.each(function(e){o.triggerMethodOn(e,"before:show",e)})},_onShowCalled:function(){this.children.each(function(e){o.triggerMethodOn(e,"show",e)})},_onBeforeAttachCalled:function(){this._triggerBeforeAttach=!0},_onAttachCalled:function(){this._triggerAttach=!0},render:function(){return this._ensureViewIsIntact(),this.triggerMethod("before:render",this),this._renderChildren(),this.isRendered=!0,this.triggerMethod("render",this),this},reorder:function(){var e=this.children,t=this._filteredSortedModels();if(!t.length&&this._showingEmptyView)return this;var i=n.some(t,function(t){return!e.findByModel(t)});if(i)this.render();else{var r=n.map(t,function(t,n){var i=e.findByModel(t);return i._index=n,i.el}),o=e.filter(function(e){return!n.contains(r,e.el)});this.triggerMethod("before:reorder"),this._appendReorderedChildren(r),n.each(o,this.removeChildView,this),this.checkEmpty(),this.triggerMethod("reorder")}},resortView:function(){o.getOption(this,"reorderOnSort")?this.reorder():this.render()},_sortViews:function(){var e=this._filteredSortedModels(),t=n.find(e,function(e,t){var n=this.children.findByModel(e);return!n||n._index!==t},this);t&&this.resortView()},_emptyViewIndex:-1,_appendReorderedChildren:function(e){this.$el.append(e)},_renderChildren:function(){this.destroyEmptyView(),this.destroyChildren({checkEmpty:!1}),this.isEmpty(this.collection)?this.showEmptyView():(this.triggerMethod("before:render:collection",this),this.startBuffering(),this.showCollection(),this.endBuffering(),this.triggerMethod("render:collection",this),this.children.isEmpty()&&this.getOption("filter")&&this.showEmptyView())},showCollection:function(){var e,t=this._filteredSortedModels();n.each(t,function(t,n){e=this.getChildView(t),this.addChild(t,e,n)},this)},_filteredSortedModels:function(e){var t=this.getViewComparator(),i=this.collection.models;if(e=Math.min(Math.max(e,0),i.length-1),t){var r;e&&(r=i[e],i=i.slice(0,e).concat(i.slice(e+1))),i=this._sortModelsBy(i,t),r&&i.splice(e,0,r)}return this.getOption("filter")&&(i=n.filter(i,function(e,t){return this._shouldAddChild(e,t)},this)),i},_sortModelsBy:function(e,t){return"string"==typeof t?n.sortBy(e,function(e){return e.get(t)},this):1===t.length?n.sortBy(e,t,this):e.sort(n.bind(t,this))},showEmptyView:function(){var e=this.getEmptyView();if(e&&!this._showingEmptyView){this.triggerMethod("before:render:empty"),this._showingEmptyView=!0;var n=new t.Model;this.addEmptyView(n,e),this.triggerMethod("render:empty")}},destroyEmptyView:function(){this._showingEmptyView&&(this.triggerMethod("before:remove:empty"),this.destroyChildren(),delete this._showingEmptyView,this.triggerMethod("remove:empty"))},getEmptyView:function(){return this.getOption("emptyView")},addEmptyView:function(e,t){var i,r=this._isShown&&!this.isBuffering&&o.isNodeAttached(this.el),s=this.getOption("emptyViewOptions")||this.getOption("childViewOptions");n.isFunction(s)&&(s=s.call(this,e,this._emptyViewIndex));var a=this.buildChildView(e,t,s);a._parent=this,this.proxyChildEvents(a),a.once("render",function(){this._isShown&&o.triggerMethodOn(a,"before:show",a),r&&this._triggerBeforeAttach&&(i=this._getViewAndNested(a),this._triggerMethodMany(i,this,"before:attach"))},this),this.children.add(a),this.renderChildView(a,this._emptyViewIndex),r&&this._triggerAttach&&(i=this._getViewAndNested(a),this._triggerMethodMany(i,this,"attach")),this._isShown&&o.triggerMethodOn(a,"show",a)},getChildView:function(e){var t=this.getOption("childView");if(!t)throw new o.Error({name:"NoChildViewError",message:'A "childView" must be specified'});return t},addChild:function(e,t,n){var i=this.getOption("childViewOptions");i=o._getValue(i,this,[e,n]);var r=this.buildChildView(e,t,i);return this._updateIndices(r,!0,n),this.triggerMethod("before:add:child",r),this._addChildView(r,n),this.triggerMethod("add:child",r),r._parent=this,r},_updateIndices:function(e,t,n){this.getOption("sort")&&(t&&(e._index=n),this.children.each(function(n){n._index>=e._index&&(n._index+=t?1:-1)}))},_addChildView:function(e,t){var n,i=this._isShown&&!this.isBuffering&&o.isNodeAttached(this.el);this.proxyChildEvents(e),e.once("render",function(){this._isShown&&!this.isBuffering&&o.triggerMethodOn(e,"before:show",e),i&&this._triggerBeforeAttach&&(n=this._getViewAndNested(e),this._triggerMethodMany(n,this,"before:attach"))},this),this.children.add(e),this.renderChildView(e,t),i&&this._triggerAttach&&(n=this._getViewAndNested(e),this._triggerMethodMany(n,this,"attach")),this._isShown&&!this.isBuffering&&o.triggerMethodOn(e,"show",e)},renderChildView:function(e,t){return e.supportsRenderLifecycle||o.triggerMethodOn(e,"before:render",e),e.render(),e.supportsRenderLifecycle||o.triggerMethodOn(e,"render",e),this.attachHtml(this,e,t),e},buildChildView:function(e,t,i){var r=n.extend({model:e},i),s=new t(r);return o.MonitorDOMRefresh(s),s},removeChildView:function(e){return e?(this.triggerMethod("before:remove:child",e),e.supportsDestroyLifecycle||o.triggerMethodOn(e,"before:destroy",e),e.destroy?e.destroy():e.remove(),e.supportsDestroyLifecycle||o.triggerMethodOn(e,"destroy",e),delete e._parent,this.stopListening(e),this.children.remove(e),this.triggerMethod("remove:child",e),this._updateIndices(e,!1),e):e},isEmpty:function(){return!this.collection||0===this.collection.length},checkEmpty:function(){this.isEmpty(this.collection)&&this.showEmptyView()},attachBuffer:function(e,t){e.$el.append(t)},_createBuffer:function(){var e=document.createDocumentFragment();return n.each(this._bufferedChildren,function(t){e.appendChild(t.el)}),e},attachHtml:function(e,t,n){e.isBuffering?e._bufferedChildren.splice(n,0,t):e._insertBefore(t,n)||e._insertAfter(t)},_insertBefore:function(e,t){var n,i=this.getOption("sort")&&t<this.children.length-1;return i&&(n=this.children.find(function(e){return e._index===t+1})),!!n&&(n.$el.before(e.el),!0)},_insertAfter:function(e){this.$el.append(e.el)},_initChildViewStorage:function(){this.children=new t.ChildViewContainer},destroy:function(){return this.isDestroyed?this:(this.triggerMethod("before:destroy:collection"),this.destroyChildren({checkEmpty:!1}),this.triggerMethod("destroy:collection"),o.View.prototype.destroy.apply(this,arguments))},destroyChildren:function(e){var t=e||{},i=!0,r=this.children.map(n.identity);return n.isUndefined(t.checkEmpty)||(i=t.checkEmpty),this.children.each(this.removeChildView,this),i&&this.checkEmpty(),r},_shouldAddChild:function(e,t){var i=this.getOption("filter");return!n.isFunction(i)||i.call(this,e,t,this.collection)},proxyChildEvents:function(e){var t=this.getOption("childViewEventPrefix");this.listenTo(e,"all",function(){var i=n.toArray(arguments),r=i[0],o=this.normalizeMethods(n.result(this,"childEvents"));i[0]=t+":"+r,i.splice(1,0,e),"undefined"!=typeof o&&n.isFunction(o[r])&&o[r].apply(this,i.slice(1)),this.triggerMethod.apply(this,i)})},_getImmediateChildren:function(){return n.values(this.children._views)},_getViewAndNested:function(e){return[e].concat(n.result(e,"_getNestedViews")||[])},getViewComparator:function(){return this.getOption("viewComparator")}}),o.CompositeView=o.CollectionView.extend({constructor:function(){o.CollectionView.apply(this,arguments)},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this._onCollectionAdd),this.listenTo(this.collection,"remove",this._onCollectionRemove),this.listenTo(this.collection,"reset",this._renderChildren),this.getOption("sort")&&this.listenTo(this.collection,"sort",this._sortViews))},getChildView:function(e){var t=this.getOption("childView")||this.constructor;return t},serializeData:function(){var e={};return this.model&&(e=n.partial(this.serializeModel,this.model).apply(this,arguments)),e},render:function(){return this._ensureViewIsIntact(),this._isRendering=!0,this.resetChildViewContainer(),this.triggerMethod("before:render",this),this._renderTemplate(),this._renderChildren(),this._isRendering=!1,this.isRendered=!0,this.triggerMethod("render",this),this},_renderChildren:function(){(this.isRendered||this._isRendering)&&o.CollectionView.prototype._renderChildren.call(this)},_renderTemplate:function(){var e={};e=this.serializeData(),e=this.mixinTemplateHelpers(e),this.triggerMethod("before:render:template");var t=this.getTemplate(),n=o.Renderer.render(t,e,this);this.attachElContent(n),this.bindUIElements(),this.triggerMethod("render:template")},attachElContent:function(e){return this.$el.html(e),this},attachBuffer:function(e,t){var n=this.getChildViewContainer(e);n.append(t)},_insertAfter:function(e){var t=this.getChildViewContainer(this,e);t.append(e.el)},_appendReorderedChildren:function(e){var t=this.getChildViewContainer(this);t.append(e)},getChildViewContainer:function(e,t){if(e.$childViewContainer)return e.$childViewContainer;var n,i=o.getOption(e,"childViewContainer");if(i){var r=o._getValue(i,e);if(n="@"===r.charAt(0)&&e.ui?e.ui[r.substr(4)]:e.$(r),n.length<=0)throw new o.Error({name:"ChildViewContainerMissingError",message:'The specified "childViewContainer" was not found: '+e.childViewContainer})}else n=e.$el;return e.$childViewContainer=n,n},resetChildViewContainer:function(){this.$childViewContainer&&(this.$childViewContainer=void 0)}}),o.LayoutView=o.ItemView.extend({regionClass:o.Region,options:{destroyImmediate:!1},childViewEventPrefix:"childview",constructor:function(e){e=e||{},this._firstRender=!0,this._initializeRegions(e),o.ItemView.call(this,e)},render:function(){return this._ensureViewIsIntact(),this._firstRender?this._firstRender=!1:this._reInitializeRegions(),o.ItemView.prototype.render.apply(this,arguments)},destroy:function(){return this.isDestroyed?this:(this.getOption("destroyImmediate")===!0&&this.$el.remove(),this.regionManager.destroy(),o.ItemView.prototype.destroy.apply(this,arguments))},showChildView:function(e,t,i){var r=this.getRegion(e);return r.show.apply(r,n.rest(arguments))},getChildView:function(e){return this.getRegion(e).currentView},addRegion:function(e,t){var n={};return n[e]=t,this._buildRegions(n)[e]},addRegions:function(e){return this.regions=n.extend({},this.regions,e),this._buildRegions(e)},removeRegion:function(e){return delete this.regions[e],this.regionManager.removeRegion(e)},getRegion:function(e){return this.regionManager.get(e)},getRegions:function(){return this.regionManager.getRegions()},_buildRegions:function(e){var t={regionClass:this.getOption("regionClass"),parentEl:n.partial(n.result,this,"el")};return this.regionManager.addRegions(e,t)},_initializeRegions:function(e){var t;this._initRegionManager(),t=o._getValue(this.regions,this,[e])||{};var i=this.getOption.call(e,"regions");i=o._getValue(i,this,[e]),n.extend(t,i),t=this.normalizeUIValues(t,["selector","el"]),this.addRegions(t)},_reInitializeRegions:function(){this.regionManager.invoke("reset")},getRegionManager:function(){return new o.RegionManager},_initRegionManager:function(){this.regionManager=this.getRegionManager(),this.regionManager._parent=this,this.listenTo(this.regionManager,"before:add:region",function(e){this.triggerMethod("before:add:region",e)}),this.listenTo(this.regionManager,"add:region",function(e,t){this[e]=t,this.triggerMethod("add:region",e,t)}),this.listenTo(this.regionManager,"before:remove:region",function(e){this.triggerMethod("before:remove:region",e)}),this.listenTo(this.regionManager,"remove:region",function(e,t){delete this[e],this.triggerMethod("remove:region",e,t)})},_getImmediateChildren:function(){return n.chain(this.regionManager.getRegions()).pluck("currentView").compact().value()}}),o.Behavior=o.Object.extend({constructor:function(e,t){this.view=t,this.defaults=n.result(this,"defaults")||{},this.options=n.extend({},this.defaults,e),this.ui=n.extend({},n.result(t,"ui"),n.result(this,"ui")),o.Object.apply(this,arguments)},$:function(){return this.view.$.apply(this.view,arguments)},destroy:function(){return this.stopListening(),this},proxyViewProperties:function(e){this.$el=e.$el,this.el=e.el}}),o.Behaviors=function(e,t){function n(e,i){return t.isObject(e.behaviors)?(i=n.parseBehaviors(e,i||t.result(e,"behaviors")),n.wrap(e,i,t.keys(s)),i):{}}function i(e,t){this._view=e,this._behaviors=t,this._triggers={}}function r(e){return e._uiBindings||e.ui}var o=/^(\S+)\s*(.*)$/,s={behaviorTriggers:function(e,t){var n=new i(this,t);return n.buildBehaviorTriggers()},behaviorEvents:function(n,i){var s={};return t.each(i,function(n,i){var a={},l=t.clone(t.result(n,"events"))||{};l=e.normalizeUIKeys(l,r(n));var c=0;t.each(l,function(e,r){var s=r.match(o),l=s[1]+"."+[this.cid,i,c++," "].join(""),u=s[2],h=l+u,d=t.isFunction(e)?e:n[e];d&&(a[h]=t.bind(d,n))},this),s=t.extend(s,a)},this),s}};return t.extend(n,{behaviorsLookup:function(){throw new e.Error({message:"You must define where your behaviors are stored.",url:"marionette.behaviors.html#behaviorslookup"})},getBehaviorClass:function(t,i){return t.behaviorClass?t.behaviorClass:e._getValue(n.behaviorsLookup,this,[t,i])[i]},parseBehaviors:function(e,i){return t.chain(i).map(function(i,r){var o=n.getBehaviorClass(i,r),s=new o(i,e),a=n.parseBehaviors(e,t.result(s,"behaviors"));return[s].concat(a)}).flatten().value()},wrap:function(e,n,i){t.each(i,function(i){e[i]=t.partial(s[i],e[i],n)})}}),t.extend(i.prototype,{buildBehaviorTriggers:function(){return t.each(this._behaviors,this._buildTriggerHandlersForBehavior,this),this._triggers},_buildTriggerHandlersForBehavior:function(n,i){var o=t.clone(t.result(n,"triggers"))||{};o=e.normalizeUIKeys(o,r(n)),t.each(o,t.bind(this._setHandlerForBehavior,this,n,i))},_setHandlerForBehavior:function(e,t,n,i){var r=i.replace(/^\S+/,function(e){return e+".behaviortriggers"+t});this._triggers[r]=this._view._buildViewTrigger(n)}}),n}(o,n),o.AppRouter=t.Router.extend({constructor:function(e){this.options=e||{},t.Router.apply(this,arguments);var n=this.getOption("appRoutes"),i=this._getController();this.processAppRoutes(i,n),this.on("route",this._processOnRoute,this)},appRoute:function(e,t){var n=this._getController();this._addAppRoute(n,e,t)},_processOnRoute:function(e,t){if(n.isFunction(this.onRoute)){var i=n.invert(this.getOption("appRoutes"))[e];this.onRoute(e,i,t)}},processAppRoutes:function(e,t){if(t){var i=n.keys(t).reverse();n.each(i,function(n){this._addAppRoute(e,n,t[n])},this)}},_getController:function(){return this.getOption("controller")},_addAppRoute:function(e,t,i){var r=e[i];if(!r)throw new o.Error('Method "'+i+'" was not found on the controller');this.route(t,i,n.bind(r,e))},mergeOptions:o.mergeOptions,getOption:o.proxyGetOption,triggerMethod:o.triggerMethod,bindEntityEvents:o.proxyBindEntityEvents,unbindEntityEvents:o.proxyUnbindEntityEvents}),o.Application=o.Object.extend({constructor:function(e){this._initializeRegions(e),this._initCallbacks=new o.Callbacks,this.submodules={},n.extend(this,e),this._initChannel(),o.Object.apply(this,arguments)},execute:function(){this.commands.execute.apply(this.commands,arguments)},request:function(){return this.reqres.request.apply(this.reqres,arguments)},addInitializer:function(e){this._initCallbacks.add(e)},start:function(e){this.triggerMethod("before:start",e),this._initCallbacks.run(e,this),this.triggerMethod("start",e)},addRegions:function(e){return this._regionManager.addRegions(e)},emptyRegions:function(){return this._regionManager.emptyRegions()},removeRegion:function(e){return this._regionManager.removeRegion(e)},getRegion:function(e){return this._regionManager.get(e)},getRegions:function(){return this._regionManager.getRegions()},module:function(e,t){var i=o.Module.getClass(t),r=n.toArray(arguments);return r.unshift(this),i.create.apply(i,r)},getRegionManager:function(){return new o.RegionManager},_initializeRegions:function(e){var t=n.isFunction(this.regions)?this.regions(e):this.regions||{};this._initRegionManager();var i=o.getOption(e,"regions");return n.isFunction(i)&&(i=i.call(this,e)),n.extend(t,i),this.addRegions(t),this},_initRegionManager:function(){this._regionManager=this.getRegionManager(),this._regionManager._parent=this,this.listenTo(this._regionManager,"before:add:region",function(){o._triggerMethod(this,"before:add:region",arguments)}),this.listenTo(this._regionManager,"add:region",function(e,t){this[e]=t,o._triggerMethod(this,"add:region",arguments)}),this.listenTo(this._regionManager,"before:remove:region",function(){o._triggerMethod(this,"before:remove:region",arguments)}),this.listenTo(this._regionManager,"remove:region",function(e){delete this[e],o._triggerMethod(this,"remove:region",arguments)})},_initChannel:function(){this.channelName=n.result(this,"channelName")||"global",this.channel=n.result(this,"channel")||t.Wreqr.radio.channel(this.channelName),this.vent=n.result(this,"vent")||this.channel.vent,this.commands=n.result(this,"commands")||this.channel.commands,this.reqres=n.result(this,"reqres")||this.channel.reqres}}),o.Module=function(e,t,i){this.moduleName=e,this.options=n.extend({},this.options,i),this.initialize=i.initialize||this.initialize,this.submodules={},this._setupInitializersAndFinalizers(),this.app=t,n.isFunction(this.initialize)&&this.initialize(e,t,this.options)},o.Module.extend=o.extend,n.extend(o.Module.prototype,t.Events,{startWithParent:!0,initialize:function(){},addInitializer:function(e){this._initializerCallbacks.add(e)},addFinalizer:function(e){this._finalizerCallbacks.add(e)},start:function(e){this._isInitialized||(n.each(this.submodules,function(t){t.startWithParent&&t.start(e)}),this.triggerMethod("before:start",e),this._initializerCallbacks.run(e,this),this._isInitialized=!0,this.triggerMethod("start",e))},stop:function(){this._isInitialized&&(this._isInitialized=!1,this.triggerMethod("before:stop"),n.invoke(this.submodules,"stop"),this._finalizerCallbacks.run(void 0,this),this._initializerCallbacks.reset(),this._finalizerCallbacks.reset(),this.triggerMethod("stop"))},addDefinition:function(e,t){this._runModuleDefinition(e,t)},_runModuleDefinition:function(e,i){if(e){var r=n.flatten([this,this.app,t,o,t.$,n,i]);e.apply(this,r)}},_setupInitializersAndFinalizers:function(){this._initializerCallbacks=new o.Callbacks,this._finalizerCallbacks=new o.Callbacks},triggerMethod:o.triggerMethod}),n.extend(o.Module,{create:function(e,t,i){var r=e,o=n.drop(arguments,3);t=t.split(".");var s=t.length,a=[];return a[s-1]=i,n.each(t,function(t,n){var s=r;r=this._getModule(s,t,e,i),this._addModuleDefinition(s,r,a[n],o)},this),r},_getModule:function(e,t,i,r,o){var s=n.extend({},r),a=this.getClass(r),l=e[t];return l||(l=new a(t,i,s),e[t]=l,e.submodules[t]=l),l},getClass:function(e){var t=o.Module;return e?e.prototype instanceof t?e:e.moduleClass||t:t},_addModuleDefinition:function(e,t,n,i){var r=this._getDefine(n),o=this._getStartWithParent(n,t);r&&t.addDefinition(r,i),this._addStartWithParent(e,t,o)},_getStartWithParent:function(e,t){var i;return n.isFunction(e)&&e.prototype instanceof o.Module?(i=t.constructor.prototype.startWithParent,!!n.isUndefined(i)||i):!n.isObject(e)||(i=e.startWithParent,!!n.isUndefined(i)||i)},_getDefine:function(e){return!n.isFunction(e)||e.prototype instanceof o.Module?n.isObject(e)?e.define:null:e},_addStartWithParent:function(e,t,n){t.startWithParent=t.startWithParent&&n,t.startWithParent&&!t.startWithParentIsConfigured&&(t.startWithParentIsConfigured=!0,e.addInitializer(function(e){t.startWithParent&&t.start(e)}))}}),o})},function(e,t,n){var i,r;!function(o,s){i=[n(4),n(3)],r=function(e,t){return s(e,t)}.apply(t,i),!(void 0!==r&&(e.exports=r))}(this,function(e,t){"use strict";var n=e.Wreqr,i=e.Wreqr={};return e.Wreqr.VERSION="1.3.6",e.Wreqr.noConflict=function(){return e.Wreqr=n,this},i.Handlers=function(e,t){var n=function(e){this.options=e,this._wreqrHandlers={},t.isFunction(this.initialize)&&this.initialize(e)};return n.extend=e.Model.extend,t.extend(n.prototype,e.Events,{setHandlers:function(e){t.each(e,function(e,n){var i=null;t.isObject(e)&&!t.isFunction(e)&&(i=e.context,e=e.callback),this.setHandler(n,e,i)},this)},setHandler:function(e,t,n){var i={callback:t,context:n
};this._wreqrHandlers[e]=i,this.trigger("handler:add",e,t,n)},hasHandler:function(e){return!!this._wreqrHandlers[e]},getHandler:function(e){var t=this._wreqrHandlers[e];if(t)return function(){return t.callback.apply(t.context,arguments)}},removeHandler:function(e){delete this._wreqrHandlers[e]},removeAllHandlers:function(){this._wreqrHandlers={}}}),n}(e,t),i.CommandStorage=function(){var n=function(e){this.options=e,this._commands={},t.isFunction(this.initialize)&&this.initialize(e)};return t.extend(n.prototype,e.Events,{getCommands:function(e){var t=this._commands[e];return t||(t={command:e,instances:[]},this._commands[e]=t),t},addCommand:function(e,t){var n=this.getCommands(e);n.instances.push(t)},clearCommands:function(e){var t=this.getCommands(e);t.instances=[]}}),n}(),i.Commands=function(e,t){return e.Handlers.extend({storageType:e.CommandStorage,constructor:function(t){this.options=t||{},this._initializeStorage(this.options),this.on("handler:add",this._executeCommands,this),e.Handlers.prototype.constructor.apply(this,arguments)},execute:function(e){e=arguments[0];var n=t.rest(arguments);this.hasHandler(e)?this.getHandler(e).apply(this,n):this.storage.addCommand(e,n)},_executeCommands:function(e,n,i){var r=this.storage.getCommands(e);t.each(r.instances,function(e){n.apply(i,e)}),this.storage.clearCommands(e)},_initializeStorage:function(e){var n,i=e.storageType||this.storageType;n=t.isFunction(i)?new i:i,this.storage=n}})}(i,t),i.RequestResponse=function(e,t){return e.Handlers.extend({request:function(e){if(this.hasHandler(e))return this.getHandler(e).apply(this,t.rest(arguments))}})}(i,t),i.EventAggregator=function(e,t){var n=function(){};return n.extend=e.Model.extend,t.extend(n.prototype,e.Events),n}(e,t),i.Channel=function(n){var i=function(t){this.vent=new e.Wreqr.EventAggregator,this.reqres=new e.Wreqr.RequestResponse,this.commands=new e.Wreqr.Commands,this.channelName=t};return t.extend(i.prototype,{reset:function(){return this.vent.off(),this.vent.stopListening(),this.reqres.removeAllHandlers(),this.commands.removeAllHandlers(),this},connectEvents:function(e,t){return this._connect("vent",e,t),this},connectCommands:function(e,t){return this._connect("commands",e,t),this},connectRequests:function(e,t){return this._connect("reqres",e,t),this},_connect:function(e,n,i){if(n){i=i||this;var r="vent"===e?"on":"setHandler";t.each(n,function(n,o){this[e][r](o,t.bind(n,i))},this)}}}),i}(i),i.radio=function(e,t){var n=function(){this._channels={},this.vent={},this.commands={},this.reqres={},this._proxyMethods()};t.extend(n.prototype,{channel:function(e){if(!e)throw new Error("Channel must receive a name");return this._getChannel(e)},_getChannel:function(t){var n=this._channels[t];return n||(n=new e.Channel(t),this._channels[t]=n),n},_proxyMethods:function(){t.each(["vent","commands","reqres"],function(e){t.each(i[e],function(t){this[e][t]=r(this,e,t)},this)},this)}});var i={vent:["on","off","trigger","once","stopListening","listenTo","listenToOnce"],commands:["execute","setHandler","setHandlers","removeHandler","removeAllHandlers"],reqres:["request","setHandler","setHandlers","removeHandler","removeAllHandlers"]},r=function(e,n,i){return function(r){var o=e._getChannel(r)[n];return o[i].apply(o,t.rest(arguments))}};return new n}(i,t),e.Wreqr})},function(e,t,n){var i,r;!function(o,s){i=[n(4),n(3)],r=function(e,t){return s(e,t)}.apply(t,i),!(void 0!==r&&(e.exports=r))}(this,function(e,t){"use strict";var n=e.ChildViewContainer;return e.ChildViewContainer=function(e,t){var n=function(e){this._views={},this._indexByModel={},this._indexByCustom={},this._updateLength(),t.each(e,this.add,this)};t.extend(n.prototype,{add:function(e,t){var n=e.cid;return this._views[n]=e,e.model&&(this._indexByModel[e.model.cid]=n),t&&(this._indexByCustom[t]=n),this._updateLength(),this},findByModel:function(e){return this.findByModelCid(e.cid)},findByModelCid:function(e){var t=this._indexByModel[e];return this.findByCid(t)},findByCustom:function(e){var t=this._indexByCustom[e];return this.findByCid(t)},findByIndex:function(e){return t.values(this._views)[e]},findByCid:function(e){return this._views[e]},remove:function(e){var n=e.cid;return e.model&&delete this._indexByModel[e.model.cid],t.any(this._indexByCustom,function(e,t){if(e===n)return delete this._indexByCustom[t],!0},this),delete this._views[n],this._updateLength(),this},call:function(e){this.apply(e,t.tail(arguments))},apply:function(e,n){t.each(this._views,function(i){t.isFunction(i[e])&&i[e].apply(i,n||[])})},_updateLength:function(){this.length=t.size(this._views)}});var i=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck","reduce"];return t.each(i,function(e){n.prototype[e]=function(){var n=t.values(this._views),i=[n].concat(t.toArray(arguments));return t[e].apply(t,i)}}),n}(e,t),e.ChildViewContainer.VERSION="0.1.11",e.ChildViewContainer.noConflict=function(){return e.ChildViewContainer=n,this},e.ChildViewContainer})},function(e,t,n){"use strict";n(9);var i=function(){function e(){this._globalChannel=Backbone.Radio.channel("global")}return Object.defineProperty(e.prototype,"globalChannel",{get:function(){return this._globalChannel},enumerable:!0,configurable:!0}),e}();t.Radio=i},function(e,t,n){!function(t,i){e.exports=i(n(3),n(4))}(this,function(e,t){"use strict";function n(e,t,n,i){var r=e[t];if(!(n&&n!==r.callback&&n!==r.callback._callback||i&&i!==r.context))return delete e[t],!0}function i(t,i,r,o){t||(t={});for(var s=i?[i]:e.keys(t),a=!1,l=0,c=s.length;l<c;l++)i=s[l],t[i]&&n(t,i,r,o)&&(a=!0);return a}function r(t){return u[t]||(u[t]=e.bind(l.log,l,t))}function o(t){return e.isFunction(t)?t:function(){return t}}e="default"in e?e.default:e,t="default"in t?t.default:t;var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},a=t.Radio,l=t.Radio={};l.VERSION="2.0.0",l.noConflict=function(){return t.Radio=a,this},l.DEBUG=!1,l._debugText=function(e,t,n){return e+(n?" on the "+n+" channel":"")+': "'+t+'"'},l.debugLog=function(e,t,n){l.DEBUG&&console&&console.warn&&console.warn(l._debugText(e,t,n))};var c=/\s+/;l._eventsApi=function(t,n,i,r){if(!i)return!1;var o={};if("object"===("undefined"==typeof i?"undefined":s(i))){for(var a in i){var l=t[n].apply(t,[a,i[a]].concat(r));c.test(a)?e.extend(o,l):o[a]=l}return o}if(c.test(i)){for(var u=i.split(c),h=0,d=u.length;h<d;h++)o[u[h]]=t[n].apply(t,[u[h]].concat(r));return o}return!1},l._callHandler=function(e,t,n){var i=n[0],r=n[1],o=n[2];switch(n.length){case 0:return e.call(t);case 1:return e.call(t,i);case 2:return e.call(t,i,r);case 3:return e.call(t,i,r,o);default:return e.apply(t,n)}};var u={};e.extend(l,{log:function(t,n){if("undefined"!=typeof console){var i=e.toArray(arguments).slice(2);console.log("["+t+'] "'+n+'"',i)}},tuneIn:function(e){var t=l.channel(e);return t._tunedIn=!0,t.on("all",r(e)),this},tuneOut:function(e){var t=l.channel(e);return t._tunedIn=!1,t.off("all",r(e)),delete u[e],this}}),l.Requests={request:function(t){var n=e.toArray(arguments).slice(1),i=l._eventsApi(this,"request",t,n);if(i)return i;var r=this.channelName,o=this._requests;if(r&&this._tunedIn&&l.log.apply(this,[r,t].concat(n)),o&&(o[t]||o.default)){var s=o[t]||o.default;return n=o[t]?n:arguments,l._callHandler(s.callback,s.context,n)}l.debugLog("An unhandled request was fired",t,r)},reply:function(e,t,n){return l._eventsApi(this,"reply",e,[t,n])?this:(this._requests||(this._requests={}),this._requests[e]&&l.debugLog("A request was overwritten",e,this.channelName),this._requests[e]={callback:o(t),context:n||this},this)},replyOnce:function(t,n,i){if(l._eventsApi(this,"replyOnce",t,[n,i]))return this;var r=this,s=e.once(function(){return r.stopReplying(t),o(n).apply(this,arguments)});return this.reply(t,s,i)},stopReplying:function(e,t,n){return l._eventsApi(this,"stopReplying",e)?this:(e||t||n?i(this._requests,e,t,n)||l.debugLog("Attempted to remove the unregistered request",e,this.channelName):delete this._requests,this)}},l._channels={},l.channel=function(e){if(!e)throw new Error("You must provide a name for the channel.");return l._channels[e]?l._channels[e]:l._channels[e]=new l.Channel(e)},l.Channel=function(e){this.channelName=e},e.extend(l.Channel.prototype,t.Events,l.Requests,{reset:function(){return this.off(),this.stopListening(),this.stopReplying(),this}});var h,d,f=[t.Events,l.Requests];return e.each(f,function(t){e.each(t,function(t,n){l[n]=function(t){return d=e.toArray(arguments).slice(1),h=this.channel(t),h[n].apply(h,d)}})}),l.reset=function(t){var n=t?[this._channels[t]]:this._channels;e.each(n,function(e){e.reset()})},l})},function(e,t,n){"use strict";var i=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(4),o=n(3),s=n(1),a=n(11),l=n(22),c=n(32),u=n(36),h=function(e){function t(){e.call(this),this.routes={"":this.home,"worksheet(/:accessionNumber)":this.worksheet},this._bindRoutes(),o.bindAll(this,"home","worksheet")}return i(t,e),t.prototype.home=function(){new a.HomeTopLevelView({model:new r.Model}).render()},t.prototype.worksheet=function(e){return e?void new u.WorksheetTopLevelView({model:l.Worksheet.fetchFromService({accessionNumber:e})}).render():void s.Application.instance.modalRegion.show(new c.WorksheetAccessionNumberPickerView({availableAccessionNumbers:s.Application.instance.services.worksheetQueryService.getWorksheetAccessionNumbersSync()}))},t}(r.Router);t.Router=h},function(e,t,n){"use strict";var i=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(12),o=n(18),s=function(e){function t(){e.apply(this,arguments)}return i(t,e),t.prototype.onRender=function(){e.prototype.onRender.call(this),this.showChildView("content",new r.HomeContentView)},t}(o.TopLevelView);t.HomeTopLevelView=s},function(e,t,n){"use strict";var i=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(3),o=n(4),s=n(5);n(13);var a=function(e){function t(t){e.call(this,r.extend({model:new o.Model,template:r.template(n(17))}))}return i(t,e),t}(s.ItemView);t.HomeContentView=a},function(e,t){},,,,function(e,t){e.exports='<div id="home">\n    <h3 class="page-header" style="text-align: center">Welcome to DressDiscover!</h3>\n    <h5>Click on the <a href="#worksheet">Worksheet</a> tab to start a new worksheet.</h5>\n</div>\n'},function(e,t,n){"use strict";var i=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(3),o=n(5),s=n(19),a=function(e){function t(t){e.call(this,r.extend(t,{el:"#app",regions:{content:"#content",navbar:"#navbar"},template:r.template(n(21))}))}return i(t,e),t.prototype.onRender=function(){this.showChildView("navbar",new s.NavbarView)},t}(o.LayoutView);t.TopLevelView=a},function(e,t,n){"use strict";var i=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(3),o=n(5),s=function(e){function t(){e.apply(this,arguments),this.template=r.template(n(20))}return i(t,e),t}(o.ItemView);t.NavbarView=s},function(e,t){e.exports='<nav class="navbar navbar-default">\r\n    <div class="container-fluid">\r\n        <!-- Brand and toggle get grouped for better mobile display -->\r\n        <div class="navbar-header">\r\n            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse-1" aria-expanded="false">\r\n                <span class="sr-only">Toggle navigation</span>\r\n                <span class="icon-bar"></span>\r\n                <span class="icon-bar"></span>\r\n                <span class="icon-bar"></span>\r\n            </button>\r\n            <a class="navbar-brand" href="#">DressDiscover</a>\r\n        </div>\r\n        <!-- Collect the nav links, forms, and other content for toggling -->\r\n        <div class="collapse navbar-collapse" id="navbar-collapse-1">\r\n            <ul class="nav navbar-nav">\r\n                <li class="active"><a href="#worksheet">Worksheet <span class="sr-only">(current)</span></a></li>\r\n            </ul>\r\n        </div><!-- /.navbar-collapse -->\r\n    </div><!-- /.container-fluid -->\r\n</nav>\r\n'},function(e,t){e.exports='<div id="navbar"></div>\n<div id="content"></div>\n'},function(e,t,n){"use strict";var i=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(4),o=n(1),s=n(23),a=n(31),l=function(e){function t(t){e.call(this),this._allFeatures=[],this._accessionNumber=t.accessionNumber,this._rootFeatureSet=new s.WorksheetFeatureSet({allFeatures:this._allFeatures,definition:t.definition.rootFeatureSet,parentFeatureSet:void 0,parentsChildNumber:void 0,state:t.state.rootFeatureSet});var n=this.__getSelectedFeature(this.rootFeatureSet);if(n?this._selectedFeature=n:(n=this.__getFirstFeature(this.rootFeatureSet),n&&(this._selectedFeature=n,n.selected=!0)),!this._selectedFeature)throw new Error("should never happen")}return i(t,e),Object.defineProperty(t.prototype,"accessionNumber",{get:function(){return this._accessionNumber},enumerable:!0,configurable:!0}),t.fetchFromService=function(e){var n=o.Application.instance.services.worksheetQueryService.getWorksheetDefinitionSync(),i=o.Application.instance.services.worksheetQueryService.getWorksheetStateSync({accessionNumber:e.accessionNumber});return new t({accessionNumber:e.accessionNumber,definition:n,state:i})},Object.defineProperty(t.prototype,"currentState",{get:function(){var e=this.rootFeatureSet.currentState;return e?new a.WorksheetState({accessionNumber:this.accessionNumber,rootFeatureSet:e}):void 0},enumerable:!0,configurable:!0}),t.prototype.putToService=function(){var e=this.currentState;e&&o.Application.instance.services.worksheetCommandService.putWorksheetStateSync({state:e})},Object.defineProperty(t.prototype,"rootFeatureSet",{get:function(){return this._rootFeatureSet},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectedFeature",{get:function(){return this._selectedFeature},set:function(e){this._selectedFeature=e},enumerable:!0,configurable:!0}),t.prototype.__getSelectedFeature=function(e){if(e.features)for(var t=0,n=e.features.models;t<n.length;t++){var i=n[t];if(i.selected)return i}if(e.childFeatureSets)for(var r=0,o=e.childFeatureSets.models;r<o.length;r++){var s=o[r],a=this.__getSelectedFeature(s);if(a)return a}},t.prototype.__getFirstFeature=function(e){if(e.features&&e.features.length>0)return e.features.at(0);if(e.childFeatureSets)for(var t=0,n=e.childFeatureSets.models;t<n.length;t++){var i=n[t],r=this.__getFirstFeature(i);if(r)return r}},t}(r.Model);t.Worksheet=l},function(e,t,n){"use strict";var i=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(3),o=n(4),s=n(24),a=n(26),l=n(29),c=n(30),u=function(e){function t(n){if(e.call(this,{id:n.definition.id}),this._childFeatureSets=new c.WorksheetFeatureSetCollection([]),this._features=new l.WorksheetFeatureCollection([]),this._definition=n.definition,this._parentFeatureSet=n.parentFeatureSet,this._parentsChildNumber=n.parentsChildNumber,n.definition.childFeatureSets)for(var i=0,r=0,o=n.definition.childFeatureSets.models;r<o.length;r++){var s=o[r];this._childFeatureSets.add(new t({allFeatures:n.allFeatures,definition:s,parentFeatureSet:this,parentsChildNumber:i++,state:n.state&&n.state.childFeatureSets?n.state.childFeatureSets[s.id]:void 0}))}if(n.definition.features)for(var u=0,h=n.definition.features.models;u<h.length;u++){var d=h[u],f=new a.WorksheetFeature({allFeatures:n.allFeatures,allFeaturesIndex:n.allFeatures.length,definition:d,parentFeatureSet:this,state:n.state&&n.state.features?n.state.features[d.id]:void 0});this._features.add(f),n.allFeatures.push(f)}}return i(t,e),Object.defineProperty(t.prototype,"currentState",{get:function(){if(this.definition.childFeatureSets||this.definition.features){var e=new s.WorksheetFeatureSetState,t=!1;if(this.definition.childFeatureSets){for(var n={},i=0,o=this._childFeatureSets.models;i<o.length;i++){var a=o[i],l=a.currentState;l&&(n[a.id]=l)}r.isEmpty(n)||(e.childFeatureSets=n,t=!0)}if(this.definition.features){for(var c={},u=0,h=this._features.models;u<h.length;u++){var d=h[u],f=d.currentState;f&&(c[d.id]=f)}r.isEmpty(c)||(e.features=c,t=!0)}return t?e:void 0}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"childFeatureSets",{get:function(){return this._childFeatureSets},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"definition",{get:function(){return this._definition},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"displayName",{get:function(){return this._definition.displayName?this._definition.displayName:this._definition.id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"features",{get:function(){return this._features},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parentFeatureSet",{get:function(){return this._parentFeatureSet},enumerable:!0,configurable:!0}),t}(o.Model);t.WorksheetFeatureSet=u},function(e,t,n){"use strict";var i=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(4),o=n(25),s=function(e){function t(n,i){e.call(this,n,i),this.validation={childFeatureSets:{fn:function(e,n,i){if("undefined"!=typeof n&&null!==n){if("object"!=typeof e)return"expected WorksheetFeatureSetState.child_feature_sets to be an object";for(var r in e){var o=e[r];if("string"!=typeof r)return"expected WorksheetFeatureSetState.child_feature_sets key to be a string";if(!(o instanceof t))return"expected WorksheetFeatureSetState.child_feature_sets value to be a WorksheetFeatureSetState";if(!o.isValid(!0))return o.validationError}}},minLength:1,required:!1},features:{fn:function(e,t,n){if("undefined"!=typeof t&&null!==t){if("object"!=typeof e)return"expected WorksheetFeatureSetState.features to be an object";for(var i in e){var r=e[i];if("string"!=typeof i)return"expected WorksheetFeatureSetState.features key to be a string";if(!(r instanceof o.WorksheetFeatureState))return"expected WorksheetFeatureSetState.features value to be a WorksheetFeatureState";if(!r.isValid(!0))return r.validationError}}},minLength:1,required:!1}}}return i(t,e),Object.defineProperty(t.prototype,"childFeatureSets",{get:function(){return this.get("childFeatureSets")},set:function(e){this.set("childFeatureSets",e,{validate:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"features",{get:function(){return this.get("features")},set:function(e){this.set("features",e,{validate:!0})},enumerable:!0,configurable:!0}),t.fromThryftJSON=function(e){var n={};for(var i in e)"child_feature_sets"==i?n.childFeatureSets=function(e){var n={};for(var i in e)n[i]=t.fromThryftJSON(e[i]);return n}(e[i]):"features"==i&&(n.features=function(e){var t={};for(var n in e)t[n]=o.WorksheetFeatureState.fromThryftJSON(e[n]);return t}(e[i]));var r=new t(n);if(!r.isValid(!0))throw new Error(r.validationError);return r},t.prototype.toThryftJSON=function(){var e={};return this.has("childFeatureSets")&&(e.child_feature_sets=function(e){var t={};for(var n in e)t[n]=e[n].toThryftJSON();return t}(this.childFeatureSets)),this.has("features")&&(e.features=function(e){var t={};for(var n in e)t[n]=e[n].toThryftJSON();return t}(this.features)),e},t}(r.Model);t.WorksheetFeatureSetState=s},function(e,t,n){"use strict";var i=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(4),o=function(e){function t(t,n){e.call(this,t,n),this.validation={selectedValues:{fn:function(e,t,n){if("undefined"!=typeof t&&null!==t){if(!Array.isArray(e))return"expected WorksheetFeatureState.selected_values to be an Array";for(var i=0;i<e.length;i++)if("string"!=typeof e[i])return"expected WorksheetFeatureState.selected_values[i] to be a string"}},minLength:1,required:!1},text:{fn:function(e,t,n){if("undefined"!=typeof t&&null!==t)return"string"!=typeof e?"expected WorksheetFeatureState.text to be a string":/^\s*$/.test(e)?"WorksheetFeatureState.text is blank":void 0},minLength:1,required:!1}}}return i(t,e),Object.defineProperty(t.prototype,"selectedValues",{get:function(){return this.get("selectedValues")},set:function(e){this.set("selectedValues",e,{validate:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this.get("text")},set:function(e){this.set("text",e,{validate:!0})},enumerable:!0,configurable:!0}),t.fromThryftJSON=function(e){var n={};for(var i in e)"selected_values"==i?n.selectedValues=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);return t}(e[i]):"text"==i&&(n.text=e[i]);var r=new t(n);if(!r.isValid(!0))throw new Error(r.validationError);return r},t.prototype.toThryftJSON=function(){var e={};return this.has("selectedValues")&&(e.selected_values=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);return t}(this.selectedValues)),this.has("text")&&(e.text=this.text),e},t}(r.Model);t.WorksheetFeatureState=o},function(e,t,n){"use strict";var i=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(3),o=n(4),s=n(25),a=n(27),l=n(28),c=function(e){function t(t){if(e.call(this,{id:t.definition.id}),this._allFeatures=t.allFeatures,this._allFeaturesIndex=t.allFeaturesIndex,this._definition=t.definition,this.selected=!1,this._parentFeatureSet=t.parentFeatureSet,t.state&&t.state.text&&this.set("text",t.state.text),t.definition.values_){for(var n=[],i=0,r=t.definition.values_.models;i<r.length;i++){var o=r[i];n.push(new l.WorksheetFeatureValue(o,this,!(!t.state||!t.state.selectedValues)&&t.state.selectedValues.indexOf(o.id)!=-1))}this._values=new a.WorksheetFeatureValueCollection(n)}else this._values=void 0}return i(t,e),Object.defineProperty(t.prototype,"currentState",{get:function(){var e={},t=this.text;if(t&&(e.text=t),this.values_){for(var n=[],i=0,o=this.values_.models;i<o.length;i++){var a=o[i];a.selected&&n.push(a.id)}n.length>0&&(e.selectedValues=n)}return r.isEmpty(e)?void 0:new s.WorksheetFeatureState(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"definition",{get:function(){return this._definition},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"displayName",{get:function(){return this._definition.displayName?this._definition.displayName:this._definition.id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parentFeatureSet",{get:function(){return this._parentFeatureSet},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nextFeature",{get:function(){if(this._allFeaturesIndex+1<this._allFeatures.length)return this._allFeatures[this._allFeaturesIndex+1]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"previousFeature",{get:function(){if(this._allFeaturesIndex>0)return this._allFeatures[this._allFeaturesIndex-1]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selected",{get:function(){return this.get("selected")},set:function(e){this.set("selected",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outputValues",{get:function(){var e=[],t=this.text;if(t&&e.push(t),this._values)for(var n=0,i=this._values.models;n<i.length;n++){var r=i[n];r.selected&&(r.definition.displayName?e.push(r.definition.displayName):e.push(r.definition.id))}return e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this.get("text")},set:function(e){e?this.set("text",e):this.unset("text")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"values_",{get:function(){return this._values},enumerable:!0,configurable:!0}),t}(o.Model);t.WorksheetFeature=c},function(e,t,n){"use strict";var i=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(4),o=function(e){function t(){e.apply(this,arguments)}return i(t,e),t}(r.Collection);t.WorksheetFeatureValueCollection=o},function(e,t,n){"use strict";var i=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(4),o=function(e){function t(t,n,i){e.call(this,{id:t.id}),this._definition=t,this._parentFeature=n,this.selected=i}return i(t,e),Object.defineProperty(t.prototype,"definition",{get:function(){return this._definition},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"displayName",{get:function(){return this._definition.displayName?this._definition.displayName:this._definition.id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parentFeature",{get:function(){return this._parentFeature},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selected",{get:function(){return this.get("selected")},set:function(e){this.set("selected",e)},enumerable:!0,configurable:!0}),t}(r.Model);t.WorksheetFeatureValue=o},function(e,t,n){"use strict";var i=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(4),o=function(e){function t(){e.apply(this,arguments)}return i(t,e),t}(r.Collection);t.WorksheetFeatureCollection=o},function(e,t,n){"use strict";var i=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(4),o=function(e){function t(t){e.call(this,t)}return i(t,e),t}(r.Collection);t.WorksheetFeatureSetCollection=o},function(e,t,n){"use strict";var i=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(4),o=n(24),s=function(e){function t(t,n){e.call(this,t,n),this.validation={accessionNumber:{fn:function(e,t,n){if("string"!=typeof e)return"expected WorksheetState.accession_number to be a string"},required:!0},rootFeatureSet:{fn:function(e,t,n){if("undefined"!=typeof t&&null!==t)return e instanceof o.WorksheetFeatureSetState?e.isValid(!0)?void 0:e.validationError:"expected WorksheetState.root_feature_set to be a WorksheetFeatureSetState"},required:!1}}}return i(t,e),Object.defineProperty(t.prototype,"accessionNumber",{get:function(){return this.get("accessionNumber")},set:function(e){this.set("accessionNumber",e,{validate:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rootFeatureSet",{get:function(){return this.get("rootFeatureSet")},set:function(e){this.set("rootFeatureSet",e,{validate:!0})},enumerable:!0,configurable:!0}),t.fromThryftJSON=function(e){var n={};for(var i in e)"accession_number"==i?n.accessionNumber=e[i]:"root_feature_set"==i&&(n.rootFeatureSet=o.WorksheetFeatureSetState.fromThryftJSON(e[i]));var r=new t(n);if(!r.isValid(!0))throw new Error(r.validationError);return r},t.prototype.toThryftJSON=function(){var e={};return e.accession_number=this.accessionNumber,this.has("rootFeatureSet")&&(e.root_feature_set=this.rootFeatureSet.toThryftJSON()),e},t}(r.Model);t.WorksheetState=s},function(e,t,n){"use strict";var i=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(3),o=n(1),s=n(4),a=n(5);n(33);var l=function(e){function t(t){e.call(this,{events:{"click #footer-close-button":"onClickCloseButton","click #header-close-button":"onClickCloseButton","click #footer-ok-button":"onClickOkButton","keyup #newAccessionNumberInput":"onKeyupNewAccessionNumberInput"},model:new s.Model,template:r.template(n(35))}),this._availableAccessionNumbers=t.availableAccessionNumbers}return i(t,e),t.prototype.initialize=function(){this.ui={accessionNumberSelect:"#accessionNumberSelect",alert:"#alert",newAccessionNumberInput:"#newAccessionNumberInput"}},t.prototype.onClickCloseButton=function(){o.Application.instance.modalRegion.empty(),o.Application.instance.router.navigate("",{trigger:!0})},t.prototype.onClickOkButton=function(){var e=this.ui.accessionNumberSelect.val();if(!e&&(e=this.ui.newAccessionNumberInput.val(),!e||0==e.length)){var t=this.ui.alert;return void t.fadeTo(1e3,500).slideUp(500,function(){t.slideUp(500)})}o.Application.instance.modalRegion.empty(),o.Application.instance.router.navigate("worksheet/"+e,{trigger:!0})},t.prototype.onKeyupNewAccessionNumberInput=function(e){13==e.keyCode&&this.onClickOkButton()},t.prototype.onShow=function(){this.ui.accessionNumberSelect.selectpicker("show"),o.Application.instance.modalRegion.$el.on("shown.bs.modal",{view:this},function(e){e.data.view.ui.newAccessionNumberInput.focus&&e.data.view.ui.newAccessionNumberInput.focus()})},t.prototype.serializeData=function(){return{availableAccessionNumbers:this._availableAccessionNumbers}},t}(a.ItemView);t.WorksheetAccessionNumberPickerView=l},function(e,t){},,function(e,t){e.exports='<div class="modal-dialog" role="document" id="worksheet-accession-number-picker">\n    <div class="modal-content">\n        <div class="modal-header">\n            <button type="button" class="close" aria-label="Close" id="header-close-button"><span aria-hidden="true">&times;</span></button>\n            <h4 class="modal-title">Worksheet</h4>\n        </div>\n        <div class="modal-body">\n            <% if (availableAccessionNumbers.length > 0) { %>\n                <select class="selectpicker show-menu-arrow show-tick" data-width="auto" id="accessionNumberSelect" title="Choose an existing worksheet">\n                    <% for (var i = 0; i < availableAccessionNumbers.length; i++) { %>\n                        <option value="<%= availableAccessionNumbers[i] %>"><%- availableAccessionNumbers[i] %></option>\n                    <% } %>\n                </select>\n                <br /><br />\n            <% } %>\n            <div>\n                <div>\n                    <% if (availableAccessionNumbers.length > 0) { %>\n                    Or enter a new accession number:\n                    <% } else { %>\n                    Enter a new accession number:\n                    <% } %>\n                </div>\n                <input id="newAccessionNumberInput" placeholder="New accession number" size="26" type="text" />\n            </div>\n            <br/>\n            <div class="modal-footer">\n                <button type="button" class="btn btn-default" id="footer-close-button">Cancel</button>\n                <button type="button" class="btn btn-primary" id="footer-ok-button">OK</button>\n            </div>\n            <div class="alert alert-warning" hidden="hidden" id="alert" role="alert">\n                <strong>Please select or enter an accession number</strong>\n            </div>\n        </div>\n    </div>\n</div>\n';
},function(e,t,n){"use strict";var i=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(1),o=n(18),s=n(37),a=n(38),l=function(e){function t(){e.apply(this,arguments)}return i(t,e),t.prototype.initialize=function(){this.listenTo(r.Application.instance.radio.globalChannel,s.WorksheetFeatureInputEvent.NAME,this.onFeatureInput)},t.prototype.onFeatureInput=function(e){this.model.putToService()},t.prototype.onRender=function(){e.prototype.onRender.call(this),this.showChildView("content",new a.WorksheetTwoColumnView({model:this.model}))},t}(o.TopLevelView);t.WorksheetTopLevelView=l},function(e,t){"use strict";var n=function(){function e(e){this._feature=e.feature}return Object.defineProperty(e.prototype,"feature",{get:function(){return this._feature},enumerable:!0,configurable:!0}),e.NAME="worksheet:feature:input",e}();t.WorksheetFeatureInputEvent=n},function(e,t,n){"use strict";var i=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(3),o=n(1),s=n(5),a=n(39),l=n(40),c=n(59);n(79);var u=function(e){function t(t){e.call(this,r.extend(t,{regions:{leftColumn:"#left-column",rightColumn:"#right-column"},template:r.template(n(81))}))}return i(t,e),t.prototype.initialize=function(){this.listenTo(o.Application.instance.radio.globalChannel,a.WorksheetFeatureNavigationEvent.NAME,this.onFeatureNavigation)},t.prototype.onFeatureNavigation=function(e){this.model.selectedFeature.selected=!1,this.model.selectedFeature=e.feature;var t=this.getRegion("rightColumn");t.reset(),t.show(new l.WorksheetInputView({model:e.feature}))},t.prototype.onBeforeShow=function(){this.showChildView("leftColumn",new c.WorksheetSidebarView({model:this.model})),this.showChildView("rightColumn",new l.WorksheetInputView({model:this.model.selectedFeature}))},t}(s.LayoutView);t.WorksheetTwoColumnView=u},function(e,t){"use strict";var n=function(){function e(e){this._feature=e.feature}return Object.defineProperty(e.prototype,"feature",{get:function(){return this._feature},enumerable:!0,configurable:!0}),e.NAME="worksheet:feature:navigation",e}();t.WorksheetFeatureNavigationEvent=n},function(e,t,n){"use strict";var i=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(3),o=n(5),s=n(1),a=n(41),l=n(39),c=function(e){function t(t){e.call(this,r.extend(t,{events:{"click #back-button":"onClickBackButton","click #next-button":"onClickNextButton"},regions:{buttons:"#input-navigation",child:"#input-child"},template:r.template(n(58))})),this._nextFeature=this.model.nextFeature,this._previousFeature=this.model.previousFeature}return i(t,e),t.prototype.initialize=function(){this.ui={backButton:"#back-button",nextButton:"#next-button"}},t.prototype.onBeforeShow=function(){this.showChildView("child",new a.WorksheetFeatureInputView({model:this.model}))},t.prototype.onClickBackButton=function(){this._previousFeature&&s.Application.instance.radio.globalChannel.trigger(l.WorksheetFeatureNavigationEvent.NAME,new l.WorksheetFeatureNavigationEvent({feature:this._previousFeature}))},t.prototype.onClickNextButton=function(){this._nextFeature&&s.Application.instance.radio.globalChannel.trigger(l.WorksheetFeatureNavigationEvent.NAME,new l.WorksheetFeatureNavigationEvent({feature:this._nextFeature}))},t.prototype.onRender=function(){this.ui.backButton.prop("disabled",!this._previousFeature),this.ui.nextButton.prop("disabled",!this._nextFeature)},t}(o.LayoutView);t.WorksheetInputView=c},function(e,t,n){"use strict";var i=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(3),o=n(5),s=n(1),a=n(42),l=n(37);n(54),n(55);var c=function(e){function t(t){e.call(this,r.extend(t,{events:{"click #reset-button":"onClickResetButton"},regions:{values:"#values"},template:r.template(n(57))})),this.bindings={textarea:"text"}}return i(t,e),t.prototype.initialize=function(){this.listenTo(this.model,"change:text",this.onTextChange)},t.prototype.onBeforeDestroy=function(){this.unstickit()},t.prototype.onClickResetButton=function(){if(this.model.text=void 0,this.model.values_)for(var e=0,t=this.model.values_.models;e<t.length;e++){var n=t[e];n.selected=!1}s.Application.instance.radio.globalChannel.trigger(l.WorksheetFeatureInputEvent.NAME,new l.WorksheetFeatureInputEvent({feature:this.model}))},t.prototype.onRender=function(){this.stickit(),this.showChildView("values",new a.WorksheetFeatureValuesInputView({collection:this.model.values_}))},t.prototype.onTextChange=function(){s.Application.instance.radio.globalChannel.trigger(l.WorksheetFeatureInputEvent.NAME,new l.WorksheetFeatureInputEvent({feature:this.model}))},t.prototype.serializeData=function(){return{displayName:this.model.displayName}},t}(o.LayoutView);t.WorksheetFeatureInputView=c},function(e,t,n){"use strict";var i=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(3),o=n(5),s=n(43),a=function(e){function t(t){e.call(this,r.extend(t,{childView:s.WorksheetFeatureValueInputView}))}return i(t,e),t}(o.CollectionView);t.WorksheetFeatureValuesInputView=a},function(e,t,n){"use strict";var i=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(3),o=n(1),s=n(5),a=n(37),l=n(44);n(48),n(50),n(51);var c=function(e){function t(t){e.call(this,r.extend(t,{events:{"click a.display-name":"onClickSelect","click a.full-size":"onClickFullSize","click a.thumbnail":"onClickSelect","click div.checkbox":"onClickSelect"},template:r.template(n(53))})),this.listenTo(this.model,"change:selected",this.onModelChangeSelected)}return i(t,e),t.prototype.initialize=function(){this.ui={checkbox:"input",image:"img"}},t.prototype.onClickFullSize=function(){o.Application.instance.modalRegion.show(new l.WorksheetFeatureValueFullSizeImageView({model:this.model}))},t.prototype.onClickSelect=function(){this.model.selected=!this.model.selected,this.ui.checkbox[0].checked=this.model.selected,o.Application.instance.radio.globalChannel.trigger(a.WorksheetFeatureInputEvent.NAME,new a.WorksheetFeatureInputEvent({feature:this.model.parentFeature}))},t.prototype.onModelChangeSelected=function(){this.ui.checkbox[0].checked=this.model.selected},t.prototype.serializeData=function(){var e=this.model.definition.toJSON();return e.displayName=this.model.displayName,this.model.definition.image?(e.image=this.model.definition.image.toJSON(),e.image.rights=this.model.definition.image.rights.toJSON()):e.image=null,e},t.prototype.onRender=function(){this.ui.checkbox[0].checked=this.model.selected,this.ui.image.magnify()},t}(s.ItemView);t.WorksheetFeatureValueInputView=c},function(e,t,n){"use strict";var i=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(3),o=n(1),s=n(5);n(45);var a=function(e){function t(t){e.call(this,r.extend(t,{events:{"click #close-button":"onClickCloseButton"},template:r.template(n(47))}))}return i(t,e),t.prototype.onClickCloseButton=function(){o.Application.instance.modalRegion.empty()},t.prototype.serializeData=function(){return{displayName:this.model.displayName,url:this.model.definition.image.fullSizeUrl}},t}(s.ItemView);t.WorksheetFeatureValueFullSizeImageView=a},function(e,t){},,function(e,t){e.exports='<div class="modal-dialog" role="document" id="feature-value-full-size-image">\n    <div class="modal-content">\n        <div class="modal-header">\n            <button type="button" class="close" aria-label="Close" id="close-button"><span aria-hidden="true">&times;</span></button>\n            <h4 class="modal-title"><%- displayName %></h4>\n        </div>\n        <div class="modal-body">\n            <img class="img-responsive" src="<%= url %>" />\n        </div>\n    </div>\n</div>\n'},function(e,t){},,function(e,t,n){(function(e){!function(e){e.fn.magnify=function(t){var n=this,i=e.extend({speed:100,timeout:-1,onload:function(){}},t),r=function(t){var n,r,o,a,l,c,u,h,d,f=e(t),p=f.closest("a"),g=0,v=0,m=f.attr("data-magnify-src")||i.src||p.attr("href")||"",y=function(){r.is(":visible")&&r.fadeOut(i.speed,function(){e("html").removeClass("magnifying").trigger("magnifyend")})};if(m){f.data("originalStyle",f.attr("style"));var b=new Image;e(b).on({load:function(){var t,w;f.css("display","block"),f.parent(".magnify").length||f.wrap('<div class="magnify"></div>'),n=f.parent(".magnify"),f.prev(".magnify-lens").length?n.children(".magnify-lens").css("background-image","url('"+m+"')"):f.before('<div class="magnify-lens loading" style="background:url(\''+m+"') no-repeat 0 0\"></div>"),r=n.children(".magnify-lens"),r.removeClass("loading"),o=n.offset(),a=n.width(),l=n.height(),c=f.innerWidth(),u=f.innerHeight(),h=r.width(),d=r.height(),g=b.width,v=b.height,f.data("zoomSize",{width:g,height:v}),b=null,i.onload(),n.off().on({"mousemove touchmove":function(n){if(n.preventDefault(),!l)return void s();if(t=(n.pageX||n.originalEvent.touches[0].pageX)-o.left,w=(n.pageY||n.originalEvent.touches[0].pageY)-o.top,r.is(":animated")||(t<a&&w<l&&t>0&&w>0?r.is(":hidden")&&(e("html").addClass("magnifying").trigger("magnifystart"),r.fadeIn(i.speed)):y()),r.is(":visible")){var f=t-h/2,p=w-d/2;if(g&&v)var m=Math.round(t/c*g-h/2)*-1,b=Math.round(w/u*v-d/2)*-1,_=m+"px "+b+"px";r.css({top:Math.round(p)+"px",left:Math.round(f)+"px",backgroundPosition:_||""})}},mouseenter:function(){o=n.offset()},mouseleave:y}),i.timeout>=0&&n.on("touchend",function(){setTimeout(y,i.timeout)}),e("body").not(n).on("touchstart",y);var _=f.attr("usemap");if(_){var x=e("map[name="+_.slice(1)+"]");f.after(x),n.click(function(n){if(n.clientX||n.clientY){r.hide();var i=document.elementFromPoint(n.clientX||n.originalEvent.touches[0].clientX,n.clientY||n.originalEvent.touches[0].clientY);"AREA"===i.nodeName?i.click():e("area",x).each(function(){var n=e(this).attr("coords").split(",");if(t>=n[0]&&t<=n[2]&&w>=n[1]&&w<=n[3])return this.click(),!1})}})}p.length&&(p.css("display","inline-block"),!p.attr("href")||f.attr("data-magnify-src")||i.src||p.click(function(e){e.preventDefault()}))},error:function(){b=null}}),b.src=m}},o=0,s=function(){clearTimeout(o),o=setTimeout(function(){n.destroy(),n.magnify(i)},100)};return this.destroy=function(){return this.each(function(){var t=e(this),n=t.prev("div.magnify-lens"),i=t.data("originalStyle");t.parent("div.magnify").length&&n.length&&(i?t.attr("style",i):t.removeAttr("style"),t.unwrap(),n.remove())}),e(window).off("resize",s),n},e(window).resize(s),this.each(function(){r(this)})}}(e)}).call(t,n(2))},function(e,t){},,function(e,t){e.exports='<div class="col-sm-3 feature-value">\n    <a class="display-name"><h5><%- displayName %></h5></a>\n    <% if (image) { %>\n    <div class="container-fluid image">\n        <div class="row thumbnail">\n            <a class="thumbnail"><img alt="<%- displayName %>" class="img-responsive" src="<%- image.thumbnailUrl %>" title="<%- displayName %>"></a>\n            <a class="full-size"><i class="glyphicon glyphicon-search"></i></a>\n        </div>\n        <div class="row rights">\n            <div class="panel-group" id="rights-panel-group">\r\n                <div class="panel panel-default">\r\n                    <div class="panel-heading">\r\n                        <h4 class="panel-title">\r\n                            <a class="collapsed rights-toggle" data-toggle="collapse" data-parent="#rights-panel-group" href="#rightsCollapseOne">\r\n                                (C) <%- image.rights.author %>\r\n                            </a>\r\n                        </h4>\r\n                    </div>\r\n                    <div id="rightsCollapseOne" class="panel-collapse collapse">\r\n                        <div class="panel-body">\r\n                            <table>\r\n                                <tr><td class="rights-field-name">Author</td><td class="rights-field-value"><%- image.rights.author %></td></tr>\r\n                                <tr><td class="rights-field-name">License</td><td class="rights-field-value"><%- image.rights.license %></td></tr>\r\n                                <tr><td class="rights-field-name">Source</td><td class="rights-field-value"><a href="<%= image.rights.sourceUrl %>"><%- image.rights.sourceName %></a></td></tr>\r\n                            </table>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\n        </div>\n    </div>\n    <% } %>\n    <div class="checkbox">\n        <input class="form-check-input" name="feature-value-checkbox" type="checkbox" value="" />\n        <label for="feature-value-checkbox"><%- displayName %></label>\n    </div>\n</div>\n'},function(e,t,n){var i,r,o;!function(s){r=[n(3),n(4),t],i=s,o="function"==typeof i?i.apply(t,r):i,!(void 0!==o&&(e.exports=o))}(function(e,t,n){t.Stickit=n,n._handlers=[],n.addHandler=function(t){t=e.map(e.flatten([t]),function(t){return e.defaults({},t,{updateModel:!0,updateView:!0,updateMethod:"text"})}),this._handlers=this._handlers.concat(t)},n.ViewMixin={_modelBindings:null,unstickit:function(t,n){if(e.isObject(n))return void e.each(n,function(e,n){this.unstickit(t,n)},this);var i=[],r=[];this._modelBindings=e.reject(this._modelBindings,function(e){if(!(t&&e.model!==t||n&&e.config.selector!=n))return e.model.off(e.event,e.fn),r.push(e.config._destroy),i.push(e.model),!0}),e.invoke(e.uniq(i),"trigger","stickit:unstuck",this.cid),e.each(e.uniq(r),function(e){e.call(this)},this),this.$el.off(".stickit"+(t?"."+t.cid:""),n)},stickit:function(t,n){var i=t||this.model,r=n||e.result(this,"bindings")||{};this._modelBindings||(this._modelBindings=[]),this.addBinding(i,r);var o=this.remove;return o.stickitWrapped||(this.remove=function(){var e=this;return this.unstickit(),o&&(e=o.apply(this,arguments)),e}),this.remove.stickitWrapped=!0,this},addBinding:function(t,n,r){var g=t||this.model,v=".stickit."+g.cid;if(r=r||{},e.isObject(n)){var m=n;return void e.each(m,function(e,t){this.addBinding(g,t,e)},this)}var y=":el"===n?this.$el:this.$(n);if(this.unstickit(g,n),y.length){e.isString(r)&&(r={observe:r}),e.isFunction(r.observe)&&(r.observe=r.observe.call(this));var b=u(y,r),w=b.observe;b.selector=n,b.view=this;var _=b.bindId=e.uniqueId(),x=e.extend({stickitChange:b},b.setOptions);if(b._destroy=function(){o.call(this,b.destroy,y,g,b)},h(y,b,g,w),f(y,b,g,w),d(y,b,g,w),w){e.each(b.events,function(t){var r=t+v,a=function(e){var t=o.call(this,b.getVal,y,e,b,i.call(arguments,1)),n=s(b.updateModel,t,e,b);n&&l(g,w,t,x,b)},c=":el"===n?"":n;this.$el.on(r,c,e.bind(a,this))},this),e.each(e.flatten([w]),function(e){a(g,"change:"+e,b,function(e,t,n){var i=n&&n.stickitChange&&n.stickitChange.bindId;if(i!==_){var r=c(g,w,b);p(y,b,r,g)}})});var k=c(g,w,b);p(y,b,k,g,!0)}o.call(this,b.initialize,y,g,b)}}},e.extend(t.View.prototype,n.ViewMixin);var i=[].slice,r=function(t,n){var i=(n||"").split("."),r=e.reduce(i,function(e,t){return e[t]},t);return null==r?t:r},o=function(t){if(t=e.isString(t)?r(this,t):t)return t.apply(this,i.call(arguments,1))},s=function(t,n,i){if(e.isBoolean(t))return t;if(e.isFunction(t)||e.isString(t)){var r=e.last(arguments).view;return o.apply(r,arguments)}return!1},a=function(e,t,n,i){var r=n.view;e.on(t,i,r),r._modelBindings.push({model:e,event:t,fn:i,config:n})},l=function(t,n,i,r,s){var a={},l=s.view;s.onSet&&(i=o.call(l,s.onSet,i,s)),s.set?o.call(l,s.set,n,i,r,s):(a[n]=i,e.isArray(n)&&e.isArray(i)&&(a=e.reduce(n,function(t,n,r){return t[n]=e.has(i,r)?i[r]:null,t},{})),t.set(a,r))},c=function(t,n,i){var r=i.view,s=function(e){return t[i.escape?"escape":"get"](e)},a=function(e){return null==e?"":e},l=e.isArray(n)?e.map(n,s):s(n);return i.onGet&&(l=o.call(r,i.onGet,l,i)),e.isArray(l)?e.map(l,a):a(l)},u=n.getConfiguration=function(t,i){var r=[{updateModel:!1,updateMethod:"text",update:function(e,t,n,i){e[i.updateMethod]&&e[i.updateMethod](t)},getVal:function(e,t,n){return e[n.updateMethod]()}}];r=r.concat(e.filter(n._handlers,function(e){return t.is(e.selector)})),r.push(i);var o=e.extend.apply(e,r);return e.has(o,"updateView")||(o.updateView=!o.visible),o},h=function(t,n,i,r){var o=["autofocus","autoplay","async","checked","controls","defer","disabled","hidden","indeterminate","loop","multiple","open","readonly","required","scoped","selected"],s=n.view;e.each(n.attributes||[],function(l){l=e.clone(l),l.view=s;var u="",h=l.observe||(l.observe=r),d=function(){var n=e.contains(o,l.name)?"prop":"attr",r=c(i,h,l);"class"===l.name?(t.removeClass(u).addClass(r),u=r):t[n](l.name,r)};e.each(e.flatten([h]),function(e){a(i,"change:"+e,n,d)}),d()})},d=function(t,n,i,r){e.each(n.classes||[],function(r,o){e.isString(r)&&(r={observe:r}),r.view=n.view;var s=r.observe,l=function(){var e=c(i,s,r);t.toggleClass(o,!!e)};e.each(e.flatten([s]),function(e){a(i,"change:"+e,n,l)}),l()})},f=function(t,n,i,r){if(null!=n.visible){var s=n.view,l=function(){var a=n.visible,l=n.visibleFn,u=c(i,r,n),h=!!u;(e.isFunction(a)||e.isString(a))&&(h=!!o.call(s,a,u,n)),l?o.call(s,l,t,h,n):t.toggle(h)};e.each(e.flatten([r]),function(e){a(i,"change:"+e,n,l)}),l()}},p=function(e,t,n,i,r){var a=t.view;s(t.updateView,n,t)&&(o.call(a,t.update,e,n,i,t),r||o.call(a,t.afterUpdate,e,n,t))};return n.addHandler([{selector:"[contenteditable]",updateMethod:"html",events:["input","change"]},{selector:"input",events:["propertychange","input","change"],update:function(e,t){e.val(t)},getVal:function(e){return e.val()}},{selector:"textarea",events:["propertychange","input","change"],update:function(e,t){e.val(t)},getVal:function(e){return e.val()}},{selector:'input[type="radio"]',events:["change"],update:function(e,t){e.filter('[value="'+t+'"]').prop("checked",!0)},getVal:function(e){return e.filter(":checked").val()}},{selector:'input[type="checkbox"]',events:["change"],update:function(n,i,r,o){if(n.length>1)i||(i=[]),n.each(function(n,r){var o=t.$(r),s=e.contains(i,o.val());o.prop("checked",s)});else{var s=e.isBoolean(i)?i:i===n.val();n.prop("checked",s)}},getVal:function(n){var i;if(n.length>1)i=e.reduce(n,function(e,n){var i=t.$(n);return i.prop("checked")&&e.push(i.val()),e},[]);else{i=n.prop("checked");var r=n.val();"on"!==r&&null!=r&&(i=i?n.val():null)}return i}},{selector:"select",events:["change"],update:function(n,i,s,a){var l,u=a.selectOptions,h=u&&u.collection||void 0,d=n.prop("multiple");if(!u){u={};var f=function(e){return e.map(function(e,n){var i=t.$(n).data("stickit-bind-val");return{value:void 0!==i?i:n.value,label:n.text}}).get()};n.find("optgroup").length?(h={opt_labels:[]},n.find("> option").length&&(h.opt_labels.push(void 0),e.each(n.find("> option"),function(e){h[void 0]=f(t.$(e))})),e.each(n.find("optgroup"),function(e){var n=t.$(e).attr("label");h.opt_labels.push(n),h[n]=f(t.$(e).find("option"))})):h=f(n.find("option"))}u.valuePath=u.valuePath||"value",u.labelPath=u.labelPath||"label",u.disabledPath=u.disabledPath||"disabled";var p=function(n,i,o){e.each(n,function(n){var s,a,l,c=t.$("<option/>"),h=n,f=function(t,n,i){c.text(t),h=n,c.data("stickit-bind-val",h),e.isArray(h)||e.isObject(h)||c.val(h),i===!0&&c.prop("disabled","disabled")};"__default__"===n?(s=o.label,a=o.value,l=o.disabled):(s=r(n,u.labelPath),a=r(n,u.valuePath),l=r(n,u.disabledPath)),f(s,a,l);var p=function(){return!d&&null!=h&&null!=o&&h===o||!(!e.isObject(o)||!e.isEqual(h,o))};p()?c.prop("selected",!0):d&&e.isArray(o)&&e.each(o,function(t){e.isObject(t)&&(t=r(t,u.valuePath)),(t===h||e.isObject(t)&&e.isEqual(h,t))&&c.prop("selected",!0)}),i.append(c)})};if(n.find("*").remove(),e.isString(h)){var g=window;0===h.indexOf("this.")&&(g=this),h=h.replace(/^[a-z]*\.(.+)$/,"$1"),l=r(g,h)}else l=e.isFunction(h)?o.call(this,h,n,a):h;if(l instanceof t.Collection){var v=l,m=function(){var e=c(s,a.observe,a);o.call(this,a.update,n,e,s,a)},y=function(){v.off("add remove reset sort",m)},b=function(){y(),v.off("stickit:selectRefresh"),s.off("stickit:selectRefresh")};v.trigger("stickit:selectRefresh"),v.once("stickit:selectRefresh",y,this),v.on("add remove reset sort",m,this),s.trigger("stickit:selectRefresh"),s.once("stickit:selectRefresh",function(){s.off("stickit:unstuck",b)}),s.once("stickit:unstuck",b,this),l=l.toJSON()}if(u.defaultOption){var w=e.isFunction(u.defaultOption)?u.defaultOption.call(this,n,a):u.defaultOption;p(["__default__"],n,w)}if(e.isArray(l))p(l,n,i);else if(l.opt_labels)e.each(l.opt_labels,function(e){var r=t.$("<optgroup/>").attr("label",e);p(l[e],r,i),n.append(r)});else{var _,x=[];for(var k in l)_={},_[u.valuePath]=k,_[u.labelPath]=l[k],x.push(_);x=e.sortBy(x,u.comparator||u.labelPath),p(x,n,i)}},getVal:function(n){var i=n.find("option:selected");return n.prop("multiple")?e.map(i,function(e){return t.$(e).data("stickit-bind-val")}):i.data("stickit-bind-val")}}]),n})},function(e,t){},,function(e,t){e.exports='<div class="row" id="input">\n    <div class="container-fluid">\n        <div class="row">\n            <div class="col-sm-10">\n                <h3 class="page-header">\n                    <span><%- displayName %></span>\n                    <span><button class="btn btn-secondary" id="reset-button" type="button">Reset</button></span>\n                </h3>\n            </div>\n        </div>\n        <div class="row values-row">\n            <div id="values"></div>\n        </div>\n        <div class="row">\n            <form class="form-horizontal">\n                <div class="form-group">\n                    <!--<label for="text" class="col-sm-offset-2 col-sm-2 control-label">Text:</label>\n                <div class="col-sm-6 ">\n                    <input type="text" class="form-control" id="text" placeholder="Text">\n                </div>-->\n                    <div class="col-sm-2">&nbsp;</div>\n                    <div class="col-sm-8">\n                        <textarea class="form-control" placeholder="Enter text" rows="10"></textarea>\n                    </div>\n                    <div class="col-sm-2">&nbsp;</div>\n                </div>\n            </form>\n        </div>\n    </div>\n</div>\n'},function(e,t){e.exports='<div class="container-fluid" id="input">\n    <div class="row" id="input-navigation">\n        <div class="col-sm-2"><button class="btn btn-primary" id="back-button" type="button">Previous</button></div>\n        <div class="col-sm-8">&nbsp;</div>\n        <div class="col-sm-2"><button class="btn btn-primary" id="next-button" type="button">Next</button></div>\n    </div>\n    <div class="row" id="input-child"></div>\n</div>\n'},function(e,t,n){"use strict";var i=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(3),o=n(1),s=n(5),a=n(60),l=n(61);n(76);var c=function(e){function t(t){e.call(this,r.extend(t,{events:{"click #changeAccessionNumberButton":"onClickChangeAccessionNumberButton","click #deleteAccessionNumberButton":"onClickDeleteAccessionNumberButton"},regions:{navigation:"#navigation",output:"#output"},template:r.template(n(78))}))}return i(t,e),t.prototype.onBeforeShow=function(){this.showChildView("navigation",new a.WorksheetNavigationView({model:this.model})),this.showChildView("output",new l.WorksheetOutputView({model:this.model}))},t.prototype.onClickChangeAccessionNumberButton=function(){o.Application.instance.router.navigate("worksheet"),window.location.reload()},t.prototype.onClickDeleteAccessionNumberButton=function(){o.Application.instance.services.worksheetCommandService.deleteWorksheetStateSync({accessionNumber:this.model.accessionNumber}),this.onClickChangeAccessionNumberButton()},t.prototype.serializeData=function(){return{accessionNumber:this.model.accessionNumber}},t}(s.LayoutView);t.WorksheetSidebarView=c},function(e,t,n){"use strict";var i=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(3),o=n(1),s=n(5),a=n(37),l=n(39),c=function(e){function t(t){e.call(this,r.extend(t,{template:r.template("")})),this._tree=[],this._nodeId=0,this._featureCidToNodeIdMap={};for(var n=0,i=this.model.rootFeatureSet.childFeatureSets.models;n<i.length;n++){var o=i[n];this._tree.push(this.__constructFeatureSetTree(o))}r.bindAll(this,"onNodeSelected")}return i(t,e),t.prototype.initialize=function(){this.listenTo(o.Application.instance.radio.globalChannel,a.WorksheetFeatureInputEvent.NAME,this.onFeatureInput),this.listenTo(o.Application.instance.radio.globalChannel,l.WorksheetFeatureNavigationEvent.NAME,this.onFeatureNavigation)},t.prototype.onBeforeShow=function(){this.$el.treeview({data:this._tree,levels:0,onNodeSelected:this.onNodeSelected})},t.prototype.onFeatureInput=function(e){var t=this.__treeview,n=this._featureCidToNodeIdMap[e.feature.cid],i=t.getNode(n);if(i.feature.id!=e.feature.id)throw new Error("map mismatch");e.feature.currentState?i.icon="glyphicon glyphicon-check":delete i.icon,t.selectNode(n)},t.prototype.onFeatureNavigation=function(e){var t=this._featureCidToNodeIdMap[e.feature.cid];this.__treeview.selectNode(t)},t.prototype.onNodeSelected=function(e,t){if(t.feature)o.Application.instance.radio.globalChannel.trigger(l.WorksheetFeatureNavigationEvent.NAME,new l.WorksheetFeatureNavigationEvent({feature:t.feature}));else{var n=this.__treeview;n.toggleNodeExpanded(t.nodeId,{silent:!0}),n.unselectNode(t.nodeId,{silent:!0})}return!0},t.prototype.__constructFeatureSetTree=function(e){var t={ddId:this._nodeId++,text:e.displayName},n=[];if(e.childFeatureSets)for(var i=0,r=e.childFeatureSets.models;i<r.length;i++){var o=r[i];n.push(this.__constructFeatureSetTree(o))}if(e.features)for(var s=0,a=e.features.models;s<a.length;s++){var l=a[s],c={feature:l,ddId:this._nodeId++,icon:l.currentState?"glyphicon glyphicon-check":void 0,text:l.displayName,state:{selected:l.selected}};this._featureCidToNodeIdMap[l.cid]=c.ddId,n.push(c)}return n.length>0&&(t.nodes=n),t},Object.defineProperty(t.prototype,"__treeview",{get:function(){return this.$el.treeview(!0)},enumerable:!0,configurable:!0}),t}(s.ItemView);t.WorksheetNavigationView=c},function(e,t,n){"use strict";var i=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(3),o=n(1),s=n(5),a=n(37),l=n(39),c=n(62);n(70),n(73);var u=function(){function e(){}return Object.defineProperty(e.prototype,"fileExtension",{get:function(){return"csv"},enumerable:!0,configurable:!0}),e.prototype.format=function(t,n){var i="Feature name,Feature value\n";for(var r in n)for(var o=0,s=n[r].values;o<s.length;o++){var a=s[o];i+=e.__escapeCsv(r)+","+e.__escapeCsv(a)+"\n"}return i},Object.defineProperty(e.prototype,"mimeType",{get:function(){return"text/csv"},enumerable:!0,configurable:!0}),e.__escapeCsv=function(e){return'"'+e.replace(/"/g,'""')+'"'},e}(),h=function(){function e(){}return Object.defineProperty(e.prototype,"fileExtension",{get:function(){return"json"},enumerable:!0,configurable:!0}),e.prototype.format=function(e,t){var n=e.currentState;return n?JSON.stringify(n.toThryftJSON()):JSON.stringify({})},Object.defineProperty(e.prototype,"mimeType",{get:function(){return"application/json"},enumerable:!0,configurable:!0}),e}(),d=function(){function e(){}return Object.defineProperty(e.prototype,"fileExtension",{get:function(){return"tsv"},enumerable:!0,configurable:!0}),e.prototype.format=function(t,n){var i="Feature name\tFeature value\n";for(var r in n)for(var o=0,s=n[r].values;o<s.length;o++){var a=s[o];i+=e.__escapeTsv(r)+"\t"+e.__escapeTsv(a)+"\n"}return i},Object.defineProperty(e.prototype,"mimeType",{get:function(){return"text/tsv"},enumerable:!0,configurable:!0}),e.__escapeTsv=function(e){return'"'+e.replace(/"/g,'""')+'"'},e}(),f=function(e){function t(t){e.call(this,r.extend(t,{events:{"click .feature-name a":"onClickFeatureName","click #download":"onClickDownload","click #email":"onClickEmail"},id:"output",template:r.template(n(75))})),this._outputFormats={CSV:new u,JSON:new h,TSV:new d}}return i(t,e),t.prototype.initialize=function(){this._output=this.__calculateOutput(),this.listenTo(o.Application.instance.radio.globalChannel,a.WorksheetFeatureInputEvent.NAME,this.onFeatureInput),this.ui={formatSelect:"#format"}},t.prototype.onBeforeShow=function(){var e=this,t=this;this._clipboard=new c("#copy",{text:function(n){return t.__getSelectedOutputFormat().format(e.model,e._output)}})},t.prototype.onClickDownload=function(){var e=this.__getSelectedOutputFormat();this.__download(e.format(this.model,this._output),this.model.accessionNumber+"."+e.fileExtension,e.mimeType)},t.prototype.onClickEmail=function(){var e=this.__getSelectedOutputFormat().format(this.model,this._output);window.open("mailto:?to=&subject="+encodeURIComponent(this.model.accessionNumber)+"&body="+encodeURIComponent(e))},t.prototype.onClickFeatureName=function(e){o.Application.instance.radio.globalChannel.trigger(l.WorksheetFeatureNavigationEvent.NAME,new l.WorksheetFeatureNavigationEvent({feature:this._output[e.target.innerText].feature}))},t.prototype.onDestroy=function(){this._clipboard.destroy()},t.prototype.onFeatureInput=function(e){this._output=this.__calculateOutput(),this.render()},t.prototype.serializeData=function(){return r.isEmpty(this._output)?{output:void 0}:{output:this._output}},t.prototype.__calculateOutput=function(){var e=this.__calculateFeatureSetOutput(this.model.rootFeatureSet);return console.info("output: "+JSON.stringify(e)),e},t.prototype.__calculateFeatureSetOutput=function(e){for(var t={},n=0,i=e.childFeatureSets.models;n<i.length;n++){var o=i[n],s=this.__calculateFeatureSetOutput(o);t=r.extend(t,s)}for(var a=0,l=e.features.models;a<l.length;a++){var c=l[a],s=this.__calculateFeatureOutput(c);t=r.extend(t,s)}return t},t.prototype.__calculateFeatureOutput=function(e){var t=e.outputValues;if(0==t.length)return{};var n={};return n[e.displayName]={feature:e,values:t},n},t.prototype.__download=function(e,t,n){var i=document.createElement("a");if(n=n||"application/octet-stream",navigator.msSaveBlob)return navigator.msSaveBlob(new Blob([e],{type:n}),t);if("download"in i)return i.href="data:"+n+","+encodeURIComponent(e),i.setAttribute("download",t),document.body.appendChild(i),i.click(),document.body.removeChild(i),!0;var r=document.createElement("iframe");return document.body.appendChild(r),r.src="data:"+n+","+encodeURIComponent(e),setTimeout(function(){document.body.removeChild(r)},333),!0},t.prototype.__getSelectedOutputFormat=function(){return this._outputFormats[this.ui.formatSelect.val()]},t}(s.ItemView);t.WorksheetOutputView=f},function(e,t,n){var i,r,o;!function(s,a){r=[e,n(63),n(65),n(66)],i=a,o="function"==typeof i?i.apply(t,r):i,!(void 0!==o&&(e.exports=o))}(this,function(e,t,n,i){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,
enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function l(e,t){var n="data-clipboard-"+e;if(t.hasAttribute(n))return t.getAttribute(n)}var c=r(t),u=r(n),h=r(i),d=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),f=function(e){function t(e,n){o(this,t);var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i.resolveOptions(n),i.listenClick(e),i}return a(t,e),d(t,[{key:"resolveOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action="function"==typeof e.action?e.action:this.defaultAction,this.target="function"==typeof e.target?e.target:this.defaultTarget,this.text="function"==typeof e.text?e.text:this.defaultText}},{key:"listenClick",value:function(e){var t=this;this.listener=(0,h.default)(e,"click",function(e){return t.onClick(e)})}},{key:"onClick",value:function(e){var t=e.delegateTarget||e.currentTarget;this.clipboardAction&&(this.clipboardAction=null),this.clipboardAction=new c.default({action:this.action(t),target:this.target(t),text:this.text(t),trigger:t,emitter:this})}},{key:"defaultAction",value:function(e){return l("action",e)}},{key:"defaultTarget",value:function(e){var t=l("target",e);if(t)return document.querySelector(t)}},{key:"defaultText",value:function(e){return l("text",e)}},{key:"destroy",value:function(){this.listener.destroy(),this.clipboardAction&&(this.clipboardAction.destroy(),this.clipboardAction=null)}}]),t}(u.default);e.exports=f})},function(e,t,n){var i,r,o;!function(s,a){r=[e,n(64)],i=a,o="function"==typeof i?i.apply(t,r):i,!(void 0!==o&&(e.exports=o))}(this,function(e,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=n(t),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=function(){function e(t){i(this,e),this.resolveOptions(t),this.initSelection()}return s(e,[{key:"resolveOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action=e.action,this.emitter=e.emitter,this.target=e.target,this.text=e.text,this.trigger=e.trigger,this.selectedText=""}},{key:"initSelection",value:function(){this.text?this.selectFake():this.target&&this.selectTarget()}},{key:"selectFake",value:function(){var e=this,t="rtl"==document.documentElement.getAttribute("dir");this.removeFake(),this.fakeHandlerCallback=function(){return e.removeFake()},this.fakeHandler=document.body.addEventListener("click",this.fakeHandlerCallback)||!0,this.fakeElem=document.createElement("textarea"),this.fakeElem.style.fontSize="12pt",this.fakeElem.style.border="0",this.fakeElem.style.padding="0",this.fakeElem.style.margin="0",this.fakeElem.style.position="absolute",this.fakeElem.style[t?"right":"left"]="-9999px";var n=window.pageYOffset||document.documentElement.scrollTop;this.fakeElem.addEventListener("focus",window.scrollTo(0,n)),this.fakeElem.style.top=n+"px",this.fakeElem.setAttribute("readonly",""),this.fakeElem.value=this.text,document.body.appendChild(this.fakeElem),this.selectedText=(0,r.default)(this.fakeElem),this.copyText()}},{key:"removeFake",value:function(){this.fakeHandler&&(document.body.removeEventListener("click",this.fakeHandlerCallback),this.fakeHandler=null,this.fakeHandlerCallback=null),this.fakeElem&&(document.body.removeChild(this.fakeElem),this.fakeElem=null)}},{key:"selectTarget",value:function(){this.selectedText=(0,r.default)(this.target),this.copyText()}},{key:"copyText",value:function(){var e=void 0;try{e=document.execCommand(this.action)}catch(t){e=!1}this.handleResult(e)}},{key:"handleResult",value:function(e){this.emitter.emit(e?"success":"error",{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)})}},{key:"clearSelection",value:function(){this.target&&this.target.blur(),window.getSelection().removeAllRanges()}},{key:"destroy",value:function(){this.removeFake()}},{key:"action",set:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"copy";if(this._action=e,"copy"!==this._action&&"cut"!==this._action)throw new Error('Invalid "action" value, use either "copy" or "cut"')},get:function(){return this._action}},{key:"target",set:function(e){if(void 0!==e){if(!e||"object"!==("undefined"==typeof e?"undefined":o(e))||1!==e.nodeType)throw new Error('Invalid "target" value, use a valid Element');if("copy"===this.action&&e.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if("cut"===this.action&&(e.hasAttribute("readonly")||e.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes');this._target=e}},get:function(){return this._target}}]),e}();e.exports=a})},function(e,t){function n(e){var t;if("SELECT"===e.nodeName)e.focus(),t=e.value;else if("INPUT"===e.nodeName||"TEXTAREA"===e.nodeName)e.focus(),e.setSelectionRange(0,e.value.length),t=e.value;else{e.hasAttribute("contenteditable")&&e.focus();var n=window.getSelection(),i=document.createRange();i.selectNodeContents(e),n.removeAllRanges(),n.addRange(i),t=n.toString()}return t}e.exports=n},function(e,t){function n(){}n.prototype={on:function(e,t,n){var i=this.e||(this.e={});return(i[e]||(i[e]=[])).push({fn:t,ctx:n}),this},once:function(e,t,n){function i(){r.off(e,i),t.apply(n,arguments)}var r=this;return i._=t,this.on(e,i,n)},emit:function(e){var t=[].slice.call(arguments,1),n=((this.e||(this.e={}))[e]||[]).slice(),i=0,r=n.length;for(i;i<r;i++)n[i].fn.apply(n[i].ctx,t);return this},off:function(e,t){var n=this.e||(this.e={}),i=n[e],r=[];if(i&&t)for(var o=0,s=i.length;o<s;o++)i[o].fn!==t&&i[o].fn._!==t&&r.push(i[o]);return r.length?n[e]=r:delete n[e],this}},e.exports=n},function(e,t,n){function i(e,t,n){if(!e&&!t&&!n)throw new Error("Missing required arguments");if(!a.string(t))throw new TypeError("Second argument must be a String");if(!a.fn(n))throw new TypeError("Third argument must be a Function");if(a.node(e))return r(e,t,n);if(a.nodeList(e))return o(e,t,n);if(a.string(e))return s(e,t,n);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}function r(e,t,n){return e.addEventListener(t,n),{destroy:function(){e.removeEventListener(t,n)}}}function o(e,t,n){return Array.prototype.forEach.call(e,function(e){e.addEventListener(t,n)}),{destroy:function(){Array.prototype.forEach.call(e,function(e){e.removeEventListener(t,n)})}}}function s(e,t,n){return l(document.body,e,t,n)}var a=n(67),l=n(68);e.exports=i},function(e,t){t.node=function(e){return void 0!==e&&e instanceof HTMLElement&&1===e.nodeType},t.nodeList=function(e){var n=Object.prototype.toString.call(e);return void 0!==e&&("[object NodeList]"===n||"[object HTMLCollection]"===n)&&"length"in e&&(0===e.length||t.node(e[0]))},t.string=function(e){return"string"==typeof e||e instanceof String},t.fn=function(e){var t=Object.prototype.toString.call(e);return"[object Function]"===t}},function(e,t,n){function i(e,t,n,i,o){var s=r.apply(this,arguments);return e.addEventListener(n,s,o),{destroy:function(){e.removeEventListener(n,s,o)}}}function r(e,t,n,i){return function(n){n.delegateTarget=o(n.target,t),n.delegateTarget&&i.call(e,n)}}var o=n(69);e.exports=i},function(e,t){function n(e,t){for(;e&&e.nodeType!==i;){if(e.matches(t))return e;e=e.parentNode}}var i=9;if(Element&&!Element.prototype.matches){var r=Element.prototype;r.matches=r.matchesSelector||r.mozMatchesSelector||r.msMatchesSelector||r.oMatchesSelector||r.webkitMatchesSelector}e.exports=n},function(e,t,n){(function(t){!function(t,n){e.exports=n()}("clipboard",function(){if("undefined"==typeof document||!document.addEventListener)return null;var n={};return n.copy=function(){function e(){n=!1,i=null,r&&window.getSelection().removeAllRanges(),r=!1}function t(){var e=document.getSelection();if(!document.queryCommandEnabled("copy")&&e.isCollapsed){var t=document.createRange();t.selectNodeContents(document.body),e.addRange(t),r=!0}}var n=!1,i=null,r=!1;return document.addEventListener("copy",function(e){if(n){for(var t in i)e.clipboardData.setData(t,i[t]);e.preventDefault()}}),function(r){return new Promise(function(o,s){n=!0,i="string"==typeof r?{"text/plain":r}:r instanceof Node?{"text/html":(new XMLSerializer).serializeToString(r)}:r;try{if(t(),!document.execCommand("copy"))throw new Error("Unable to copy. Perhaps it's not available in your browser?");e(),o()}catch(t){e(),s(t)}})}}(),n.paste=function(){var e,t,n=!1;return document.addEventListener("paste",function(i){if(n){n=!1,i.preventDefault();var r=e;e=null,r(i.clipboardData.getData(t))}}),function(i){return new Promise(function(r,o){n=!0,e=r,t=i||"text/plain";try{document.execCommand("paste")||(n=!1,o(new Error("Unable to paste. Pasting only works in Internet Explorer at the moment.")))}catch(e){n=!1,o(new Error(e))}})}}(),"undefined"==typeof ClipboardEvent&&"undefined"!=typeof window.clipboardData&&"undefined"!=typeof window.clipboardData.setData&&(!function(n){function i(e,t){return function(){e.apply(t,arguments)}}function r(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],u(e,i(s,this),i(a,this))}function o(e){var t=this;return null===this._state?void this._deferreds.push(e):void h(function(){var n=t._state?e.onFulfilled:e.onRejected;if(null===n)return void(t._state?e.resolve:e.reject)(t._value);var i;try{i=n(t._value)}catch(t){return void e.reject(t)}e.resolve(i)})}function s(e){try{if(e===this)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var t=e.then;if("function"==typeof t)return void u(i(t,e),i(s,this),i(a,this))}this._state=!0,this._value=e,l.call(this)}catch(e){a.call(this,e)}}function a(e){this._state=!1,this._value=e,l.call(this)}function l(){for(var e=0,t=this._deferreds.length;t>e;e++)o.call(this,this._deferreds[e]);this._deferreds=null}function c(e,t,n,i){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=i}function u(e,t,n){var i=!1;try{e(function(e){i||(i=!0,t(e))},function(e){i||(i=!0,n(e))})}catch(e){if(i)return;i=!0,n(e)}}var h=r.immediateFn||"function"==typeof t&&t||function(e){setTimeout(e,1)},d=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};r.prototype.catch=function(e){return this.then(null,e)},r.prototype.then=function(e,t){var n=this;return new r(function(i,r){o.call(n,new c(e,t,i,r))})},r.all=function(){var e=Array.prototype.slice.call(1===arguments.length&&d(arguments[0])?arguments[0]:arguments);return new r(function(t,n){function i(o,s){try{if(s&&("object"==typeof s||"function"==typeof s)){var a=s.then;if("function"==typeof a)return void a.call(s,function(e){i(o,e)},n)}e[o]=s,0===--r&&t(e)}catch(e){n(e)}}if(0===e.length)return t([]);for(var r=e.length,o=0;o<e.length;o++)i(o,e[o])})},r.resolve=function(e){return e&&"object"==typeof e&&e.constructor===r?e:new r(function(t){t(e)})},r.reject=function(e){return new r(function(t,n){n(e)})},r.race=function(e){return new r(function(t,n){for(var i=0,r=e.length;r>i;i++)e[i].then(t,n)})},"undefined"!=typeof e&&e.exports?e.exports=r:n.Promise||(n.Promise=r)}(this),n.copy=function(e){return new Promise(function(t,n){if("string"!=typeof e&&!("text/plain"in e))throw new Error("You must provide a text/plain type.");var i="string"==typeof e?e:e["text/plain"],r=window.clipboardData.setData("Text",i);r?t():n(new Error("Copying was rejected."))})},n.paste=function(){return new Promise(function(e,t){var n=window.clipboardData.getData("Text");n?e(n):t(new Error("Pasting was rejected."))})}),n})}).call(t,n(71).setImmediate)},function(e,t,n){(function(e,i){function r(e,t){this._id=e,this._clearFn=t}var o=n(72).nextTick,s=Function.prototype.apply,a=Array.prototype.slice,l={},c=0;t.setTimeout=function(){return new r(s.call(setTimeout,window,arguments),clearTimeout)},t.setInterval=function(){return new r(s.call(setInterval,window,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(window,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},t.setImmediate="function"==typeof e?e:function(e){var n=c++,i=!(arguments.length<2)&&a.call(arguments,1);return l[n]=!0,o(function(){l[n]&&(i?e.apply(null,i):e.call(null),t.clearImmediate(n))}),n},t.clearImmediate="function"==typeof i?i:function(e){delete l[e]}}).call(t,n(71).setImmediate,n(71).clearImmediate)},function(e,t){function n(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function r(e){if(u===setTimeout)return setTimeout(e,0);if((u===n||!u)&&setTimeout)return u=setTimeout,setTimeout(e,0);try{return u(e,0)}catch(t){try{return u.call(null,e,0)}catch(t){return u.call(this,e,0)}}}function o(e){if(h===clearTimeout)return clearTimeout(e);if((h===i||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(e);try{return h(e)}catch(t){try{return h.call(null,e)}catch(t){return h.call(this,e)}}}function s(){g&&f&&(g=!1,f.length?p=f.concat(p):v=-1,p.length&&a())}function a(){if(!g){var e=r(s);g=!0;for(var t=p.length;t;){for(f=p,p=[];++v<t;)f&&f[v].run();v=-1,t=p.length}f=null,g=!1,o(e)}}function l(e,t){this.fun=e,this.array=t}function c(){}var u,h,d=e.exports={};!function(){try{u="function"==typeof setTimeout?setTimeout:n}catch(e){u=n}try{h="function"==typeof clearTimeout?clearTimeout:i}catch(e){h=i}}();var f,p=[],g=!1,v=-1;d.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];p.push(new l(e,t)),1!==p.length||g||r(a)},l.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=c,d.addListener=c,d.once=c,d.off=c,d.removeListener=c,d.removeAllListeners=c,d.emit=c,d.binding=function(e){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(e){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},function(e,t){},,function(e,t){e.exports='<% if (output) { %>\n    <% for (var outputKey in output) { _.each(output[outputKey].values, function(outputValue) { %>\n<div class="row">\n    <div class="col-sm-4 feature-name"><a><%- outputKey %></a></div>\n    <div class="col-sm-8 feature-value"><%- outputValue %></div>\n</div>\n    <% }); } %>\n<div class="row"><div class="col-sm-12">&nbsp;</div></div>\n<div class="row" id="actions">\n    <div class="col-sm-2"></div>\n    <div class="col-sm-10">\n        <div class="form-inline">\n            <a class="action btn btn-secondary" id="copy">Copy</a>\n            <a class="action btn btn-secondary" id="email">Email</a>\n            <a class="action btn btn-secondary" id="download">Download</a>\n            <select class="form-control" id="format">\n                <option>CSV</option>\n                <option>JSON</option>\n                <option>TSV</option>\r\n            </select>\n        </div>\n    </div>\n</div>\n<% } else { %>\nSelect values on the right to generate a description.\n<% } %>\n'},function(e,t){},,function(e,t){e.exports='<div class="panel-group" id="sidebar" role="tablist" aria-multiselectable="true">\r\n    <div class="panel panel-default">\r\n        <div class="panel-heading" role="tab" id="sidebarHeadingOne">\r\n            <h4 class="panel-title">\r\n                <a role="button" data-toggle="collapse" href="#sidebarCollapseOne" aria-expanded="true" aria-controls="sidebarCollapseOne">\r\n                    Accession number\r\n                </a>\r\n            </h4>\r\n            <div class="container-fluid">\r\n                <div class="row">\r\n                    <div class="col-sm-4" id="accessionNumber">\r\n                        <%- accessionNumber %>\r\n                    </div>\r\n                    <div class="col-sm-4">\r\n                        <button type="button" class="btn btn-primary" id="changeAccessionNumberButton">Change</button>\r\n                    </div>\r\n                    <div class="col-sm-4">\r\n                        <button type="button" class="btn btn-warning" id="deleteAccessionNumberButton">Delete</button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div id="sidebarCollapseOne" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="sidebarHeadingOne">\r\n            <div class="panel-body" id="output">\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class="panel panel-default">\r\n        <div class="panel-heading" role="tab" id="sidebarHeadingTwo">\r\n            <h4 class="panel-title">\r\n                <a class="collapsed" role="button" data-toggle="collapse" href="#sidebarCollapseTwo" aria-expanded="true" aria-controls="sidebarCollapseTwo">\r\n                    Features\r\n                </a>\r\n            </h4>\r\n        </div>\r\n        <div id="sidebarCollapseTwo" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="sidebarHeadingTwo">\r\n            <div class="panel-body" id="navigation">\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n'},function(e,t){},,function(e,t){e.exports='<div class="container-fluid" id="worksheet">\n    <div class="row" id="two-columns">\n        <div class="col-sm-4" id="left-column"></div>\n        <div class="col-sm-8" id="right-column"></div>\n    </div>\n</div>\n'},function(e,t,n){(function(e){"use strict";var i=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(5),o=function(t){function n(){t.call(this,{el:"#modal"}),this._ensureElement()}return i(n,t),n.prototype.getEl=function(t){var n=e(t);return n.on("hidden.bs.modal",this.empty),n},n.prototype.onEmpty=function(){this.$el.modal("hide")},n.prototype.onShow=function(){this.$el.on("hidden.bs.modal",{region:this},function(e){e.data.region.empty()}),this.$el.modal("show")},n}(r.Region);t.ModalRegion=o}).call(t,n(2))},function(e,t,n){"use strict";var i=n(84),r=n(86),o=function(){function e(){this._worksheetCommandService=new i.LocalWorksheetCommandService,this._worksheetQueryService=new r.LocalWorksheetQueryService}return Object.defineProperty(e.prototype,"worksheetCommandService",{get:function(){return this._worksheetCommandService},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"worksheetQueryService",{get:function(){return this._worksheetQueryService},enumerable:!0,configurable:!0}),e}();t.Services=o},function(e,t,n){"use strict";var i=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(85),o=n(86),s=function(e){function t(){e.apply(this,arguments)}return i(t,e),t.prototype.deleteWorksheetStateSync=function(e){console.info("delete "+e.accessionNumber),localStorage.removeItem(o.LocalWorksheetQueryService.getWorksheetStateItemKey(e.accessionNumber))},t.prototype.putWorksheetStateSync=function(e){var t=JSON.stringify(e.state.toThryftJSON());console.info("put "+t),localStorage.setItem(o.LocalWorksheetQueryService.getWorksheetStateItemKey(e.state.accessionNumber),t)},t}(r.AsyncToSyncWorksheetCommandService);t.LocalWorksheetCommandService=s},function(e,t){"use strict";var n=function(){function e(){}return e.prototype.deleteWorksheetStateAsync=function(e){try{this.deleteWorksheetStateSync({accessionNumber:e.accessionNumber}),e.success()}catch(t){e.error(null,t.message,t)}},e.prototype.putWorksheetStateAsync=function(e){try{this.putWorksheetStateSync({state:e.state}),e.success()}catch(t){e.error(null,t.message,t)}},e}();t.AsyncToSyncWorksheetCommandService=n},function(e,t,n){"use strict";var i=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(87),o=n(88),s=n(31),a=function(e){function t(){e.call(this),this._worksheetDefinition=o.WorksheetDefinition.fromThryftJSON(WORKSHEET_DEFINITION)}return i(t,e),t.prototype.getWorksheetAccessionNumbersSync=function(){for(var e=[],n=0;;n++){var i=localStorage.key(n);if(null==i)break;i.match("^"+t._WORKSHEET_ITEM_KEY_PREFIX)&&i.length!=t._WORKSHEET_ITEM_KEY_PREFIX.length&&e.push(i.substr(t._WORKSHEET_ITEM_KEY_PREFIX.length))}return e},t.prototype.getWorksheetDefinitionSync=function(){return this._worksheetDefinition},t.getWorksheetStateItemKey=function(e){return t._WORKSHEET_ITEM_KEY_PREFIX+e},t.prototype.getWorksheetStateSync=function(e){var n=localStorage.getItem(t.getWorksheetStateItemKey(e.accessionNumber));return console.info("state from service: "+n),null==n?new s.WorksheetState:s.WorksheetState.fromThryftJSON(JSON.parse(n))},t._WORKSHEET_ITEM_KEY_PREFIX="worksheet/state/",t}(r.AsyncToSyncWorksheetQueryService);t.LocalWorksheetQueryService=a},function(e,t){"use strict";var n=function(){function e(){}return e.prototype.getWorksheetAccessionNumbersAsync=function(e){try{e.success(this.getWorksheetAccessionNumbersSync())}catch(t){e.error(null,t.message,t)}},e.prototype.getWorksheetDefinitionAsync=function(e){try{e.success(this.getWorksheetDefinitionSync())}catch(t){e.error(null,t.message,t)}},e.prototype.getWorksheetStateAsync=function(e){try{e.success(this.getWorksheetStateSync({accessionNumber:e.accessionNumber}))}catch(t){e.error(null,t.message,t)}},e}();t.AsyncToSyncWorksheetQueryService=n},function(e,t,n){"use strict";var i=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(4),o=n(89),s=function(e){function t(t,n){e.call(this,t,n),this.validation={rootFeatureSet:{fn:function(e,t,n){return e instanceof o.WorksheetFeatureSetDefinition?e.isValid(!0)?void 0:e.validationError:"expected WorksheetDefinition.root_feature_set to be a WorksheetFeatureSetDefinition"},required:!0}}}return i(t,e),Object.defineProperty(t.prototype,"rootFeatureSet",{get:function(){return this.get("rootFeatureSet")},set:function(e){this.set("rootFeatureSet",e,{validate:!0})},enumerable:!0,configurable:!0}),t.fromThryftJSON=function(e){var n={};for(var i in e)"root_feature_set"==i&&(n.rootFeatureSet=o.WorksheetFeatureSetDefinition.fromThryftJSON(e[i]));var r=new t(n);if(!r.isValid(!0))throw new Error(r.validationError);return r},t.prototype.toThryftJSON=function(){var e={};return e.root_feature_set=this.rootFeatureSet.toThryftJSON(),e},t}(r.Model);t.WorksheetDefinition=s},function(e,t,n){"use strict";var i=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(4),o=n(90),s=function(e){function t(n,i){e.call(this,n,i),this.validation={id:{fn:function(e,t,n){if("string"!=typeof e)return"expected WorksheetFeatureSetDefinition.id to be a string"},required:!0},childFeatureSets:{fn:function(e,n,i){if("undefined"!=typeof n&&null!==n){if(!(e instanceof r.Collection))return"expected WorksheetFeatureSetDefinition.child_feature_sets to be a Backbone.Collection";if(e.model!==t)return"expected WorksheetFeatureSetDefinition.child_feature_sets to be a Backbone.Collection with model=WorksheetFeatureSetDefinition";for(var o=0,s=e.models;o<s.length;o++){var a=s[o];if(!a.isValid(!0))return a.validationError}}},minLength:1,required:!1},displayName:{fn:function(e,t,n){if("undefined"!=typeof t&&null!==t)return"string"!=typeof e?"expected WorksheetFeatureSetDefinition.display_name to be a string":/^\s*$/.test(e)?"WorksheetFeatureSetDefinition.display_name is blank":void 0},minLength:1,required:!1},features:{fn:function(e,t,n){if("undefined"!=typeof t&&null!==t){if(!(e instanceof r.Collection))return"expected WorksheetFeatureSetDefinition.features to be a Backbone.Collection";if(e.model!==o.WorksheetFeatureDefinition)return"expected WorksheetFeatureSetDefinition.features to be a Backbone.Collection with model=WorksheetFeatureDefinition";for(var i=0,s=e.models;i<s.length;i++){var a=s[i];if(!a.isValid(!0))return a.validationError}}},minLength:1,required:!1}}}return i(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this.get("id")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"childFeatureSets",{get:function(){return this.get("childFeatureSets")},set:function(e){this.set("childFeatureSets",e,{validate:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"displayName",{get:function(){return this.get("displayName")},set:function(e){this.set("displayName",e,{validate:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"features",{get:function(){return this.get("features")},set:function(e){this.set("features",e,{validate:!0})},enumerable:!0,configurable:!0}),t.fromThryftJSON=function(e){var n={};for(var i in e)"id"==i?n.id=e[i]:"child_feature_sets"==i?n.childFeatureSets=function(e){for(var n=[],i=0;i<e.length;i++)n.push(t.fromThryftJSON(e[i]));return new r.Collection(n)}(e[i]):"display_name"==i?n.displayName=e[i]:"features"==i&&(n.features=function(e){for(var t=[],n=0;n<e.length;n++)t.push(o.WorksheetFeatureDefinition.fromThryftJSON(e[n]));return new r.Collection(t)}(e[i]));var s=new t(n);if(!s.isValid(!0))throw new Error(s.validationError);return s},t.prototype.toThryftJSON=function(){var e={};return e.id=this.id,this.has("childFeatureSets")&&(e.child_feature_sets=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n].toThryftJSON());return t}(this.childFeatureSets.models)),this.has("displayName")&&(e.display_name=this.displayName),this.has("features")&&(e.features=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n].toThryftJSON());return t}(this.features.models)),e},t}(r.Model);t.WorksheetFeatureSetDefinition=s},function(e,t,n){"use strict";var i=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(4),o=n(91),s=function(e){function t(t,n){e.call(this,t,n),this.validation={id:{fn:function(e,t,n){if("string"!=typeof e)return"expected WorksheetFeatureDefinition.id to be a string"},required:!0},displayName:{fn:function(e,t,n){if("undefined"!=typeof t&&null!==t)return"string"!=typeof e?"expected WorksheetFeatureDefinition.display_name to be a string":/^\s*$/.test(e)?"WorksheetFeatureDefinition.display_name is blank":void 0},minLength:1,required:!1},values_:{fn:function(e,t,n){if("undefined"!=typeof t&&null!==t){if(!(e instanceof r.Collection))return"expected WorksheetFeatureDefinition.values_ to be a Backbone.Collection";if(e.model!==o.WorksheetFeatureValueDefinition)return"expected WorksheetFeatureDefinition.values_ to be a Backbone.Collection with model=WorksheetFeatureValueDefinition";for(var i=0,s=e.models;i<s.length;i++){var a=s[i];if(!a.isValid(!0))return a.validationError}}},minLength:1,required:!1}}}return i(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this.get("id")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"displayName",{get:function(){return this.get("displayName")},set:function(e){this.set("displayName",e,{validate:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"values_",{get:function(){return this.get("values_")},set:function(e){this.set("values_",e,{validate:!0})},enumerable:!0,configurable:!0}),t.fromThryftJSON=function(e){var n={};for(var i in e)"id"==i?n.id=e[i]:"display_name"==i?n.displayName=e[i]:"values_"==i&&(n.values_=function(e){for(var t=[],n=0;n<e.length;n++)t.push(o.WorksheetFeatureValueDefinition.fromThryftJSON(e[n]));return new r.Collection(t)}(e[i]));var s=new t(n);if(!s.isValid(!0))throw new Error(s.validationError);return s},t.prototype.toThryftJSON=function(){var e={};return e.id=this.id,this.has("displayName")&&(e.display_name=this.displayName),this.has("values_")&&(e.values_=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n].toThryftJSON());return t}(this.values_.models)),e},t}(r.Model);t.WorksheetFeatureDefinition=s},function(e,t,n){"use strict";var i=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(4),o=n(92),s=function(e){function t(t,n){e.call(this,t,n),this.validation={id:{fn:function(e,t,n){if("string"!=typeof e)return"expected WorksheetFeatureValueDefinition.id to be a string"},required:!0},displayName:{fn:function(e,t,n){if("undefined"!=typeof t&&null!==t)return"string"!=typeof e?"expected WorksheetFeatureValueDefinition.display_name to be a string":/^\s*$/.test(e)?"WorksheetFeatureValueDefinition.display_name is blank":void 0},minLength:1,required:!1},image:{fn:function(e,t,n){if("undefined"!=typeof t&&null!==t)return e instanceof o.WorksheetFeatureValueImage?e.isValid(!0)?void 0:e.validationError:"expected WorksheetFeatureValueDefinition.image to be a WorksheetFeatureValueImage"},required:!1}}}return i(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this.get("id")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"displayName",{get:function(){return this.get("displayName")},set:function(e){this.set("displayName",e,{validate:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"image",{get:function(){return this.get("image")},set:function(e){this.set("image",e,{validate:!0})},enumerable:!0,configurable:!0}),t.fromThryftJSON=function(e){var n={};for(var i in e)"id"==i?n.id=e[i]:"display_name"==i?n.displayName=e[i]:"image"==i&&(n.image=o.WorksheetFeatureValueImage.fromThryftJSON(e[i]));var r=new t(n);if(!r.isValid(!0))throw new Error(r.validationError);return r},t.prototype.toThryftJSON=function(){var e={};return e.id=this.id,this.has("displayName")&&(e.display_name=this.displayName),this.has("image")&&(e.image=this.image.toThryftJSON()),e},t}(r.Model);t.WorksheetFeatureValueDefinition=s},function(e,t,n){"use strict";var i=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(4),o=n(93),s=function(e){function t(t,n){e.call(this,t,n),this.validation={rights:{fn:function(e,t,n){return e instanceof o.WorksheetFeatureValueImageRights?e.isValid(!0)?void 0:e.validationError:"expected WorksheetFeatureValueImage.rights to be a WorksheetFeatureValueImageRights"},required:!0},thumbnailUrl:{fn:function(e,t,n){return"string"!=typeof e?"expected WorksheetFeatureValueImage.thumbnail_url to be a string":/^\s*$/.test(e)?"WorksheetFeatureValueImage.thumbnail_url is blank":void 0;
},minLength:1,required:!0},fullSizeUrl:{fn:function(e,t,n){if("undefined"!=typeof t&&null!==t)return"string"!=typeof e?"expected WorksheetFeatureValueImage.full_size_url to be a string":/^\s*$/.test(e)?"WorksheetFeatureValueImage.full_size_url is blank":void 0},minLength:1,required:!1}}}return i(t,e),Object.defineProperty(t.prototype,"rights",{get:function(){return this.get("rights")},set:function(e){this.set("rights",e,{validate:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"thumbnailUrl",{get:function(){return this.get("thumbnailUrl")},set:function(e){this.set("thumbnailUrl",e,{validate:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fullSizeUrl",{get:function(){return this.get("fullSizeUrl")},set:function(e){this.set("fullSizeUrl",e,{validate:!0})},enumerable:!0,configurable:!0}),t.fromThryftJSON=function(e){var n={};for(var i in e)"rights"==i?n.rights=o.WorksheetFeatureValueImageRights.fromThryftJSON(e[i]):"thumbnail_url"==i?n.thumbnailUrl=e[i]:"full_size_url"==i&&(n.fullSizeUrl=e[i]);var r=new t(n);if(!r.isValid(!0))throw new Error(r.validationError);return r},t.prototype.toThryftJSON=function(){var e={};return e.rights=this.rights.toThryftJSON(),e.thumbnail_url=this.thumbnailUrl,this.has("fullSizeUrl")&&(e.full_size_url=this.fullSizeUrl),e},t}(r.Model);t.WorksheetFeatureValueImage=s},function(e,t,n){"use strict";var i=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(4),o=function(e){function t(t,n){e.call(this,t,n),this.validation={author:{fn:function(e,t,n){return"string"!=typeof e?"expected WorksheetFeatureValueImageRights.author to be a string":/^\s*$/.test(e)?"WorksheetFeatureValueImageRights.author is blank":void 0},minLength:1,required:!0},license:{fn:function(e,t,n){return"string"!=typeof e?"expected WorksheetFeatureValueImageRights.license to be a string":/^\s*$/.test(e)?"WorksheetFeatureValueImageRights.license is blank":void 0},minLength:1,required:!0},sourceName:{fn:function(e,t,n){return"string"!=typeof e?"expected WorksheetFeatureValueImageRights.source_name to be a string":/^\s*$/.test(e)?"WorksheetFeatureValueImageRights.source_name is blank":void 0},minLength:1,required:!0},sourceUrl:{fn:function(e,t,n){if("string"!=typeof e)return"expected WorksheetFeatureValueImageRights.source_url to be a string"},required:!0}}}return i(t,e),Object.defineProperty(t.prototype,"author",{get:function(){return this.get("author")},set:function(e){this.set("author",e,{validate:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"license",{get:function(){return this.get("license")},set:function(e){this.set("license",e,{validate:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sourceName",{get:function(){return this.get("sourceName")},set:function(e){this.set("sourceName",e,{validate:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sourceUrl",{get:function(){return this.get("sourceUrl")},set:function(e){this.set("sourceUrl",e,{validate:!0})},enumerable:!0,configurable:!0}),t.fromThryftJSON=function(e){var n={};for(var i in e)"author"==i?n.author=e[i]:"license"==i?n.license=e[i]:"source_name"==i?n.sourceName=e[i]:"source_url"==i&&(n.sourceUrl=e[i]);var r=new t(n);if(!r.isValid(!0))throw new Error(r.validationError);return r},t.prototype.toThryftJSON=function(){var e={};return e.author=this.author,e.license=this.license,e.source_name=this.sourceName,e.source_url=this.sourceUrl,e},t}(r.Model);t.WorksheetFeatureValueImageRights=o},function(e,t,n){(function(e){Backbone.Validation=function(e){"use strict";var t={forceUpdate:!1,selector:"name",labelFormatter:"sentenceCase",valid:Function.prototype,invalid:Function.prototype},n={formatLabel:function(e,n){return l[t.labelFormatter](e,n)},format:function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return t.replace(/\{(\d+)\}/g,function(t,n){return"undefined"!=typeof e[n]?e[n]:t})}},i=function(t,n,r){return n=n||{},r=r||"",e.each(t,function(e,o){t.hasOwnProperty(o)&&(!e||"object"!=typeof e||e instanceof Date||e instanceof RegExp?n[r+o]=e:i(e,n,r+o+"."))}),n},r=function(){var r=function(t){return e.reduce(e.keys(t.validation||{}),function(e,t){return e[t]=void 0,e},{})},s=function(t,n){var i=t.validation?t.validation[n]||{}:{};return(e.isFunction(i)||e.isString(i))&&(i={fn:i}),e.isArray(i)||(i=[i]),e.reduce(i,function(t,n){return e.each(e.without(e.keys(n),"msg"),function(e){t.push({fn:c[e],val:n[e],msg:n.msg})}),t},[])},a=function(t,i,r,o){return e.reduce(s(t,i),function(s,a){var l=e.extend({},n,c),u=a.fn.call(l,r,i,a.val,t,o);return u!==!1&&s!==!1&&(u&&!s?a.msg||u:s)},"")},l=function(t,n){var r,o={},s=!0,l=e.clone(n),c=i(n);return e.each(c,function(e,n){r=a(t,n,e,l),r&&(o[n]=r,s=!1)}),{invalidAttrs:o,isValid:s}},u=function(t,n){return{preValidate:function(t,n){return a(this,t,n,e.extend({},this.attributes))},isValid:function(t){var n=i(this.attributes);return e.isString(t)?!a(this,t,n[t],e.extend({},this.attributes)):e.isArray(t)?e.reduce(t,function(t,i){return t&&!a(this,i,n[i],e.extend({},this.attributes))},!0,this):(t===!0&&this.validate(),!this.validation||this._isValid)},validate:function(o,s){var a=this,c=!o,u=e.extend({},n,s),h=r(a),d=e.extend({},h,a.attributes,o),f=i(o||d),p=l(a,d);if(a._isValid=p.isValid,e.each(h,function(e,n){var i=p.invalidAttrs.hasOwnProperty(n);i||u.valid(t,n,u.selector)}),e.each(h,function(e,n){var i=p.invalidAttrs.hasOwnProperty(n),r=f.hasOwnProperty(n);i&&(r||c)&&u.invalid(t,n,p.invalidAttrs[n],u.selector)}),e.defer(function(){a.trigger("validated",a._isValid,a,p.invalidAttrs),a.trigger("validated:"+(a._isValid?"valid":"invalid"),a,p.invalidAttrs)}),!u.forceUpdate&&e.intersection(e.keys(p.invalidAttrs),e.keys(f)).length>0)return p.invalidAttrs}}},h=function(t,n,i){e.extend(n,u(t,i))},d=function(e){delete e.validate,delete e.preValidate,delete e.isValid},f=function(e){h(this.view,e,this.options)},p=function(e){d(e)};return{version:"0.7.1",configure:function(n){e.extend(t,n)},bind:function(n,i){var r=n.model,s=n.collection;if(i=e.extend({},t,o,i),"undefined"==typeof r&&"undefined"==typeof s)throw"Before you execute the binding your view must have a model or a collection.\nSee http://thedersen.com/projects/backbone-validation/#using-form-model-validation for more information.";r?h(n,r,i):s&&(s.each(function(e){h(n,e,i)}),s.bind("add",f,{view:n,options:i}),s.bind("remove",p))},unbind:function(e){var t=e.model,n=e.collection;t&&d(e.model),n&&(n.each(function(e){d(e)}),n.unbind("add",f),n.unbind("remove",p))},mixin:u(null,t)}}(),o=r.callbacks={valid:function(e,t,n){e.$("["+n+'~="'+t+'"]').removeClass("invalid").removeAttr("data-error")},invalid:function(e,t,n,i){e.$("["+i+'~="'+t+'"]').addClass("invalid").attr("data-error",n)}},s=r.patterns={digits:/^\d+$/,number:/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/,email:/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i,url:/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i},a=r.messages={required:"{0} is required",acceptance:"{0} must be accepted",min:"{0} must be greater than or equal to {1}",max:"{0} must be less than or equal to {1}",range:"{0} must be between {1} and {2}",length:"{0} must be {1} characters",minLength:"{0} must be at least {1} characters",maxLength:"{0} must be at most {1} characters",rangeLength:"{0} must be between {1} and {2} characters",oneOf:"{0} must be one of: {1}",equalTo:"{0} must be the same as {1}",pattern:"{0} must be a valid {1}"},l=r.labelFormatters={none:function(e){return e},sentenceCase:function(e){return e.replace(/(?:^\w|[A-Z]|\b\w)/g,function(e,t){return 0===t?e.toUpperCase():" "+e.toLowerCase()}).replace("_"," ")},label:function(e,t){return t.labels&&t.labels[e]||l.sentenceCase(e,t)}},c=r.validators=function(){var t=String.prototype.trim?function(e){return null===e?"":String.prototype.trim.call(e)}:function(e){var t=/^\s+/,n=/\s+$/;return null===e?"":e.toString().replace(t,"").replace(n,"")},n=function(t){return e.isNumber(t)||e.isString(t)&&t.match(s.number)},i=function(n){return!(e.isNull(n)||e.isUndefined(n)||e.isString(n)&&""===t(n))};return{fn:function(t,n,i,r,o){return e.isString(i)&&(i=r[i]),i.call(r,t,n,o)},required:function(t,n,r,o,s){var l=e.isFunction(r)?r.call(o,t,n,s):r;return!(!l&&!i(t))&&(l&&!i(t)?this.format(a.required,this.formatLabel(n,o)):void 0)},acceptance:function(t,n,i,r){if("true"!==t&&(!e.isBoolean(t)||t===!1))return this.format(a.acceptance,this.formatLabel(n,r))},min:function(e,t,i,r){if(!n(e)||e<i)return this.format(a.min,this.formatLabel(t,r),i)},max:function(e,t,i,r){if(!n(e)||e>i)return this.format(a.max,this.formatLabel(t,r),i)},range:function(e,t,i,r){if(!n(e)||e<i[0]||e>i[1])return this.format(a.range,this.formatLabel(t,r),i[0],i[1])},length:function(e,n,r,o){if(!i(e)||t(e).length!==r)return this.format(a.length,this.formatLabel(n,o),r)},minLength:function(e,n,r,o){if(!i(e)||t(e).length<r)return this.format(a.minLength,this.formatLabel(n,o),r)},maxLength:function(e,n,r,o){if(!i(e)||t(e).length>r)return this.format(a.maxLength,this.formatLabel(n,o),r)},rangeLength:function(e,n,r,o){if(!i(e)||t(e).length<r[0]||t(e).length>r[1])return this.format(a.rangeLength,this.formatLabel(n,o),r[0],r[1])},oneOf:function(t,n,i,r){if(!e.include(i,t))return this.format(a.oneOf,this.formatLabel(n,r),i.join(", "))},equalTo:function(e,t,n,i,r){if(e!==r[n])return this.format(a.equalTo,this.formatLabel(t,i),this.formatLabel(n,i))},pattern:function(e,t,n,r){if(!i(e)||!e.toString().match(s[n]||n))return this.format(a.pattern,this.formatLabel(t,r),n)}}}();return r}(e)}).call(t,n(3))},function(e,t){},,function(e,t,n){var i,r;!function(o,s){i=[n(2)],r=function(e){return s(e)}.apply(t,i),!(void 0!==r&&(e.exports=r))}(this,function(e){!function(e){"use strict";function t(t){var n=[{re:/[\xC0-\xC6]/g,ch:"A"},{re:/[\xE0-\xE6]/g,ch:"a"},{re:/[\xC8-\xCB]/g,ch:"E"},{re:/[\xE8-\xEB]/g,ch:"e"},{re:/[\xCC-\xCF]/g,ch:"I"},{re:/[\xEC-\xEF]/g,ch:"i"},{re:/[\xD2-\xD6]/g,ch:"O"},{re:/[\xF2-\xF6]/g,ch:"o"},{re:/[\xD9-\xDC]/g,ch:"U"},{re:/[\xF9-\xFC]/g,ch:"u"},{re:/[\xC7-\xE7]/g,ch:"c"},{re:/[\xD1]/g,ch:"N"},{re:/[\xF1]/g,ch:"n"}];return e.each(n,function(){t=t?t.replace(this.re,this.ch):""}),t}function n(t){var n=arguments,i=t;[].shift.apply(n);var r,o=this.each(function(){var t=e(this);if(t.is("select")){var o=t.data("selectpicker"),s="object"==typeof i&&i;if(o){if(s)for(var a in s)s.hasOwnProperty(a)&&(o.options[a]=s[a])}else{var l=e.extend({},u.DEFAULTS,e.fn.selectpicker.defaults||{},t.data(),s);l.template=e.extend({},u.DEFAULTS.template,e.fn.selectpicker.defaults?e.fn.selectpicker.defaults.template:{},t.data().template,s.template),t.data("selectpicker",o=new u(this,l))}"string"==typeof i&&(r=o[i]instanceof Function?o[i].apply(o,n):o.options[i])}});return"undefined"!=typeof r?r:o}String.prototype.includes||!function(){var e={}.toString,t=function(){try{var e={},t=Object.defineProperty,n=t(e,e,e)&&t}catch(e){}return n}(),n="".indexOf,i=function(t){if(null==this)throw new TypeError;var i=String(this);if(t&&"[object RegExp]"==e.call(t))throw new TypeError;var r=i.length,o=String(t),s=o.length,a=arguments.length>1?arguments[1]:void 0,l=a?Number(a):0;l!=l&&(l=0);var c=Math.min(Math.max(l,0),r);return!(s+c>r)&&n.call(i,o,l)!=-1};t?t(String.prototype,"includes",{value:i,configurable:!0,writable:!0}):String.prototype.includes=i}(),String.prototype.startsWith||!function(){var e=function(){try{var e={},t=Object.defineProperty,n=t(e,e,e)&&t}catch(e){}return n}(),t={}.toString,n=function(e){if(null==this)throw new TypeError;var n=String(this);if(e&&"[object RegExp]"==t.call(e))throw new TypeError;var i=n.length,r=String(e),o=r.length,s=arguments.length>1?arguments[1]:void 0,a=s?Number(s):0;a!=a&&(a=0);var l=Math.min(Math.max(a,0),i);if(o+l>i)return!1;for(var c=-1;++c<o;)if(n.charCodeAt(l+c)!=r.charCodeAt(c))return!1;return!0};e?e(String.prototype,"startsWith",{value:n,configurable:!0,writable:!0}):String.prototype.startsWith=n}(),Object.keys||(Object.keys=function(e,t,n){n=[];for(t in e)n.hasOwnProperty.call(e,t)&&n.push(t);return n});var i={useDefault:!1,_set:e.valHooks.select.set};e.valHooks.select.set=function(t,n){return n&&!i.useDefault&&e(t).data("selected",!0),i._set.apply(this,arguments)};var r=null;e.fn.triggerNative=function(e){var t,n=this[0];n.dispatchEvent?("function"==typeof Event?t=new Event(e,{bubbles:!0}):(t=document.createEvent("Event"),t.initEvent(e,!0,!1)),n.dispatchEvent(t)):n.fireEvent?(t=document.createEventObject(),t.eventType=e,n.fireEvent("on"+e,t)):this.trigger(e)},e.expr.pseudos.icontains=function(t,n,i){var r=e(t),o=(r.data("tokens")||r.text()).toString().toUpperCase();return o.includes(i[3].toUpperCase())},e.expr.pseudos.ibegins=function(t,n,i){var r=e(t),o=(r.data("tokens")||r.text()).toString().toUpperCase();return o.startsWith(i[3].toUpperCase())},e.expr.pseudos.aicontains=function(t,n,i){var r=e(t),o=(r.data("tokens")||r.data("normalizedText")||r.text()).toString().toUpperCase();return o.includes(i[3].toUpperCase())},e.expr.pseudos.aibegins=function(t,n,i){var r=e(t),o=(r.data("tokens")||r.data("normalizedText")||r.text()).toString().toUpperCase();return o.startsWith(i[3].toUpperCase())};var o={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},s={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#x27;":"'","&#x60;":"`"},a=function(e){var t=function(t){return e[t]},n="(?:"+Object.keys(e).join("|")+")",i=RegExp(n),r=RegExp(n,"g");return function(e){return e=null==e?"":""+e,i.test(e)?e.replace(r,t):e}},l=a(o),c=a(s),u=function(t,n){i.useDefault||(e.valHooks.select.set=i._set,i.useDefault=!0),this.$element=e(t),this.$newElement=null,this.$button=null,this.$menu=null,this.$lis=null,this.options=n,null===this.options.title&&(this.options.title=this.$element.attr("title"));var r=this.options.windowPadding;"number"==typeof r&&(this.options.windowPadding=[r,r,r,r]),this.val=u.prototype.val,this.render=u.prototype.render,this.refresh=u.prototype.refresh,this.setStyle=u.prototype.setStyle,this.selectAll=u.prototype.selectAll,this.deselectAll=u.prototype.deselectAll,this.destroy=u.prototype.destroy,this.remove=u.prototype.remove,this.show=u.prototype.show,this.hide=u.prototype.hide,this.init()};u.VERSION="1.12.1",u.DEFAULTS={noneSelectedText:"Nothing selected",noneResultsText:"No results matched {0}",countSelectedText:function(e,t){return 1==e?"{0} item selected":"{0} items selected"},maxOptionsText:function(e,t){return[1==e?"Limit reached ({n} item max)":"Limit reached ({n} items max)",1==t?"Group limit reached ({n} item max)":"Group limit reached ({n} items max)"]},selectAllText:"Select All",deselectAllText:"Deselect All",doneButton:!1,doneButtonText:"Close",multipleSeparator:", ",styleBase:"btn",style:"btn-default",size:"auto",title:null,selectedTextFormat:"values",width:!1,container:!1,hideDisabled:!1,showSubtext:!1,showIcon:!0,showContent:!0,dropupAuto:!0,header:!1,liveSearch:!1,liveSearchPlaceholder:null,liveSearchNormalize:!1,liveSearchStyle:"contains",actionsBox:!1,iconBase:"glyphicon",tickIcon:"glyphicon-ok",showTick:!1,template:{caret:'<span class="caret"></span>'},maxOptions:!1,mobile:!1,selectOnTab:!1,dropdownAlignRight:!1,windowPadding:0},u.prototype={constructor:u,init:function(){var t=this,n=this.$element.attr("id");this.$element.addClass("bs-select-hidden"),this.liObj={},this.multiple=this.$element.prop("multiple"),this.autofocus=this.$element.prop("autofocus"),this.$newElement=this.createView(),this.$element.after(this.$newElement).appendTo(this.$newElement),this.$button=this.$newElement.children("button"),this.$menu=this.$newElement.children(".dropdown-menu"),this.$menuInner=this.$menu.children(".inner"),this.$searchbox=this.$menu.find("input"),this.$element.removeClass("bs-select-hidden"),this.options.dropdownAlignRight===!0&&this.$menu.addClass("dropdown-menu-right"),"undefined"!=typeof n&&(this.$button.attr("data-id",n),e('label[for="'+n+'"]').click(function(e){e.preventDefault(),t.$button.focus()})),this.checkDisabled(),this.clickListener(),this.options.liveSearch&&this.liveSearchListener(),this.render(),this.setStyle(),this.setWidth(),this.options.container&&this.selectPosition(),this.$menu.data("this",this),this.$newElement.data("this",this),this.options.mobile&&this.mobile(),this.$newElement.on({"hide.bs.dropdown":function(e){t.$menuInner.attr("aria-expanded",!1),t.$element.trigger("hide.bs.select",e)},"hidden.bs.dropdown":function(e){t.$element.trigger("hidden.bs.select",e)},"show.bs.dropdown":function(e){t.$menuInner.attr("aria-expanded",!0),t.$element.trigger("show.bs.select",e)},"shown.bs.dropdown":function(e){t.$element.trigger("shown.bs.select",e)}}),t.$element[0].hasAttribute("required")&&this.$element.on("invalid",function(){t.$button.addClass("bs-invalid").focus(),t.$element.on({"focus.bs.select":function(){t.$button.focus(),t.$element.off("focus.bs.select")},"shown.bs.select":function(){t.$element.val(t.$element.val()).off("shown.bs.select")},"rendered.bs.select":function(){this.validity.valid&&t.$button.removeClass("bs-invalid"),t.$element.off("rendered.bs.select")}})}),setTimeout(function(){t.$element.trigger("loaded.bs.select")})},createDropdown:function(){var t=this.multiple||this.options.showTick?" show-tick":"",n=this.$element.parent().hasClass("input-group")?" input-group-btn":"",i=this.autofocus?" autofocus":"",r=this.options.header?'<div class="popover-title"><button type="button" class="close" aria-hidden="true">&times;</button>'+this.options.header+"</div>":"",o=this.options.liveSearch?'<div class="bs-searchbox"><input type="text" class="form-control" autocomplete="off"'+(null===this.options.liveSearchPlaceholder?"":' placeholder="'+l(this.options.liveSearchPlaceholder)+'"')+' role="textbox" aria-label="Search"></div>':"",s=this.multiple&&this.options.actionsBox?'<div class="bs-actionsbox"><div class="btn-group btn-group-sm btn-block"><button type="button" class="actions-btn bs-select-all btn btn-default">'+this.options.selectAllText+'</button><button type="button" class="actions-btn bs-deselect-all btn btn-default">'+this.options.deselectAllText+"</button></div></div>":"",a=this.multiple&&this.options.doneButton?'<div class="bs-donebutton"><div class="btn-group btn-block"><button type="button" class="btn btn-sm btn-default">'+this.options.doneButtonText+"</button></div></div>":"",c='<div class="btn-group bootstrap-select'+t+n+'"><button type="button" class="'+this.options.styleBase+' dropdown-toggle" data-toggle="dropdown"'+i+' role="button"><span class="filter-option pull-left"></span>&nbsp;<span class="bs-caret">'+this.options.template.caret+'</span></button><div class="dropdown-menu open" role="combobox">'+r+o+s+'<ul class="dropdown-menu inner" role="listbox" aria-expanded="false"></ul>'+a+"</div></div>";return e(c)},createView:function(){var e=this.createDropdown(),t=this.createLi();return e.find("ul")[0].innerHTML=t,e},reloadLi:function(){var e=this.createLi();this.$menuInner[0].innerHTML=e},createLi:function(){var n=this,i=[],r=0,o=document.createElement("option"),s=-1,a=function(e,t,n,i){return"<li"+("undefined"!=typeof n&""!==n?' class="'+n+'"':"")+("undefined"!=typeof t&null!==t?' data-original-index="'+t+'"':"")+("undefined"!=typeof i&null!==i?'data-optgroup="'+i+'"':"")+">"+e+"</li>"},c=function(i,r,o,s){return'<a tabindex="0"'+("undefined"!=typeof r?' class="'+r+'"':"")+(o?' style="'+o+'"':"")+(n.options.liveSearchNormalize?' data-normalized-text="'+t(l(e(i).html()))+'"':"")+("undefined"!=typeof s||null!==s?' data-tokens="'+s+'"':"")+' role="option">'+i+'<span class="'+n.options.iconBase+" "+n.options.tickIcon+' check-mark"></span></a>'};if(this.options.title&&!this.multiple&&(s--,!this.$element.find(".bs-title-option").length)){var u=this.$element[0];o.className="bs-title-option",o.innerHTML=this.options.title,o.value="",u.insertBefore(o,u.firstChild);var h=e(u.options[u.selectedIndex]);void 0===h.attr("selected")&&void 0===this.$element.data("selected")&&(o.selected=!0)}return this.$element.find("option").each(function(t){var o=e(this);if(s++,!o.hasClass("bs-title-option")){var u=this.className||"",h=this.style.cssText,d=o.data("content")?o.data("content"):o.html(),f=o.data("tokens")?o.data("tokens"):null,p="undefined"!=typeof o.data("subtext")?'<small class="text-muted">'+o.data("subtext")+"</small>":"",g="undefined"!=typeof o.data("icon")?'<span class="'+n.options.iconBase+" "+o.data("icon")+'"></span> ':"",v=o.parent(),m="OPTGROUP"===v[0].tagName,y=m&&v[0].disabled,b=this.disabled||y;if(""!==g&&b&&(g="<span>"+g+"</span>"),n.options.hideDisabled&&(b&&!m||y))return void s--;if(o.data("content")||(d=g+'<span class="text">'+d+p+"</span>"),m&&o.data("divider")!==!0){if(n.options.hideDisabled&&b){if(void 0===v.data("allOptionsDisabled")){var w=v.children();v.data("allOptionsDisabled",w.filter(":disabled").length===w.length)}if(v.data("allOptionsDisabled"))return void s--}var _=" "+v[0].className||"";if(0===o.index()){r+=1;var x=v[0].label,k="undefined"!=typeof v.data("subtext")?'<small class="text-muted">'+v.data("subtext")+"</small>":"",S=v.data("icon")?'<span class="'+n.options.iconBase+" "+v.data("icon")+'"></span> ':"";x=S+'<span class="text">'+l(x)+k+"</span>",0!==t&&i.length>0&&(s++,i.push(a("",null,"divider",r+"div"))),s++,i.push(a(x,null,"dropdown-header"+_,r))}if(n.options.hideDisabled&&b)return void s--;i.push(a(c(d,"opt "+u+_,h,f),t,"",r))}else if(o.data("divider")===!0)i.push(a("",t,"divider"));else if(o.data("hidden")===!0)i.push(a(c(d,u,h,f),t,"hidden is-hidden"));else{var C=this.previousElementSibling&&"OPTGROUP"===this.previousElementSibling.tagName;if(!C&&n.options.hideDisabled)for(var F=e(this).prevAll(),E=0;E<F.length;E++)if("OPTGROUP"===F[E].tagName){for(var O=0,N=0;N<E;N++){var $=F[N];($.disabled||e($).data("hidden")===!0)&&O++}O===E&&(C=!0);break}C&&(s++,i.push(a("",null,"divider",r+"div"))),i.push(a(c(d,u,h,f),t))}n.liObj[t]=s}}),this.multiple||0!==this.$element.find("option:selected").length||this.options.title||this.$element.find("option").eq(0).prop("selected",!0).attr("selected","selected"),i.join("")},findLis:function(){return null==this.$lis&&(this.$lis=this.$menu.find("li")),this.$lis},render:function(t){var n,i=this;t!==!1&&this.$element.find("option").each(function(e){var t=i.findLis().eq(i.liObj[e]);i.setDisabled(e,this.disabled||"OPTGROUP"===this.parentNode.tagName&&this.parentNode.disabled,t),i.setSelected(e,this.selected,t)}),this.togglePlaceholder(),this.tabIndex();var r=this.$element.find("option").map(function(){if(this.selected){if(i.options.hideDisabled&&(this.disabled||"OPTGROUP"===this.parentNode.tagName&&this.parentNode.disabled))return;var t,n=e(this),r=n.data("icon")&&i.options.showIcon?'<i class="'+i.options.iconBase+" "+n.data("icon")+'"></i> ':"";return t=i.options.showSubtext&&n.data("subtext")&&!i.multiple?' <small class="text-muted">'+n.data("subtext")+"</small>":"","undefined"!=typeof n.attr("title")?n.attr("title"):n.data("content")&&i.options.showContent?n.data("content").toString():r+n.html()+t}}).toArray(),o=this.multiple?r.join(this.options.multipleSeparator):r[0];if(this.multiple&&this.options.selectedTextFormat.indexOf("count")>-1){var s=this.options.selectedTextFormat.split(">");if(s.length>1&&r.length>s[1]||1==s.length&&r.length>=2){n=this.options.hideDisabled?", [disabled]":"";var a=this.$element.find("option").not('[data-divider="true"], [data-hidden="true"]'+n).length,l="function"==typeof this.options.countSelectedText?this.options.countSelectedText(r.length,a):this.options.countSelectedText;o=l.replace("{0}",r.length.toString()).replace("{1}",a.toString())}}void 0==this.options.title&&(this.options.title=this.$element.attr("title")),"static"==this.options.selectedTextFormat&&(o=this.options.title),o||(o="undefined"!=typeof this.options.title?this.options.title:this.options.noneSelectedText),this.$button.attr("title",c(e.trim(o.replace(/<[^>]*>?/g,"")))),this.$button.children(".filter-option").html(o),this.$element.trigger("rendered.bs.select")},setStyle:function(e,t){this.$element.attr("class")&&this.$newElement.addClass(this.$element.attr("class").replace(/selectpicker|mobile-device|bs-select-hidden|validate\[.*\]/gi,""));var n=e?e:this.options.style;"add"==t?this.$button.addClass(n):"remove"==t?this.$button.removeClass(n):(this.$button.removeClass(this.options.style),this.$button.addClass(n))},liHeight:function(t){if(t||this.options.size!==!1&&!this.sizeInfo){var n=document.createElement("div"),i=document.createElement("div"),r=document.createElement("ul"),o=document.createElement("li"),s=document.createElement("li"),a=document.createElement("a"),l=document.createElement("span"),c=this.options.header&&this.$menu.find(".popover-title").length>0?this.$menu.find(".popover-title")[0].cloneNode(!0):null,u=this.options.liveSearch?document.createElement("div"):null,h=this.options.actionsBox&&this.multiple&&this.$menu.find(".bs-actionsbox").length>0?this.$menu.find(".bs-actionsbox")[0].cloneNode(!0):null,d=this.options.doneButton&&this.multiple&&this.$menu.find(".bs-donebutton").length>0?this.$menu.find(".bs-donebutton")[0].cloneNode(!0):null;if(l.className="text",n.className=this.$menu[0].parentNode.className+" open",i.className="dropdown-menu open",r.className="dropdown-menu inner",o.className="divider",l.appendChild(document.createTextNode("Inner text")),a.appendChild(l),s.appendChild(a),r.appendChild(s),r.appendChild(o),c&&i.appendChild(c),u){var f=document.createElement("span");u.className="bs-searchbox",f.className="form-control",u.appendChild(f),i.appendChild(u)}h&&i.appendChild(h),i.appendChild(r),d&&i.appendChild(d),n.appendChild(i),document.body.appendChild(n);var p=a.offsetHeight,g=c?c.offsetHeight:0,v=u?u.offsetHeight:0,m=h?h.offsetHeight:0,y=d?d.offsetHeight:0,b=e(o).outerHeight(!0),w="function"==typeof getComputedStyle&&getComputedStyle(i),_=w?null:e(i),x={vert:parseInt(w?w.paddingTop:_.css("paddingTop"))+parseInt(w?w.paddingBottom:_.css("paddingBottom"))+parseInt(w?w.borderTopWidth:_.css("borderTopWidth"))+parseInt(w?w.borderBottomWidth:_.css("borderBottomWidth")),horiz:parseInt(w?w.paddingLeft:_.css("paddingLeft"))+parseInt(w?w.paddingRight:_.css("paddingRight"))+parseInt(w?w.borderLeftWidth:_.css("borderLeftWidth"))+parseInt(w?w.borderRightWidth:_.css("borderRightWidth"))},k={vert:x.vert+parseInt(w?w.marginTop:_.css("marginTop"))+parseInt(w?w.marginBottom:_.css("marginBottom"))+2,horiz:x.horiz+parseInt(w?w.marginLeft:_.css("marginLeft"))+parseInt(w?w.marginRight:_.css("marginRight"))+2};document.body.removeChild(n),this.sizeInfo={liHeight:p,headerHeight:g,searchHeight:v,actionsHeight:m,doneButtonHeight:y,dividerHeight:b,menuPadding:x,menuExtras:k}}},setSize:function(){if(this.findLis(),this.liHeight(),this.options.header&&this.$menu.css("padding-top",0),this.options.size!==!1){var t,n,i,r,o,s,a,l,c=this,u=this.$menu,h=this.$menuInner,d=e(window),f=this.$newElement[0].offsetHeight,p=this.$newElement[0].offsetWidth,g=this.sizeInfo.liHeight,v=this.sizeInfo.headerHeight,m=this.sizeInfo.searchHeight,y=this.sizeInfo.actionsHeight,b=this.sizeInfo.doneButtonHeight,w=this.sizeInfo.dividerHeight,_=this.sizeInfo.menuPadding,x=this.sizeInfo.menuExtras,k=this.options.hideDisabled?".disabled":"",S=function(){var t,n=c.$newElement.offset(),i=e(c.options.container);c.options.container&&!i.is("body")?(t=i.offset(),t.top+=parseInt(i.css("borderTopWidth")),t.left+=parseInt(i.css("borderLeftWidth"))):t={top:0,left:0};var r=c.options.windowPadding;o=n.top-t.top-d.scrollTop(),s=d.height()-o-f-t.top-r[2],a=n.left-t.left-d.scrollLeft(),l=d.width()-a-p-t.left-r[1],o-=r[0],a-=r[3]};if(S(),"auto"===this.options.size){var C=function(){var d,f=function(t,n){return function(i){return n?i.classList?i.classList.contains(t):e(i).hasClass(t):!(i.classList?i.classList.contains(t):e(i).hasClass(t))}},w=c.$menuInner[0].getElementsByTagName("li"),k=Array.prototype.filter?Array.prototype.filter.call(w,f("hidden",!1)):c.$lis.not(".hidden"),C=Array.prototype.filter?Array.prototype.filter.call(k,f("dropdown-header",!0)):k.filter(".dropdown-header");S(),t=s-x.vert,n=l-x.horiz,c.options.container?(u.data("height")||u.data("height",u.height()),i=u.data("height"),u.data("width")||u.data("width",u.width()),r=u.data("width")):(i=u.height(),r=u.width()),c.options.dropupAuto&&c.$newElement.toggleClass("dropup",o>s&&t-x.vert<i),c.$newElement.hasClass("dropup")&&(t=o-x.vert),"auto"===c.options.dropdownAlignRight&&u.toggleClass("dropdown-menu-right",a>l&&n-x.horiz<r-p),d=k.length+C.length>3?3*g+x.vert-2:0,u.css({"max-height":t+"px",overflow:"hidden","min-height":d+v+m+y+b+"px"}),h.css({"max-height":t-v-m-y-b-_.vert+"px","overflow-y":"auto","min-height":Math.max(d-_.vert,0)+"px"})};C(),this.$searchbox.off("input.getSize propertychange.getSize").on("input.getSize propertychange.getSize",C),d.off("resize.getSize scroll.getSize").on("resize.getSize scroll.getSize",C)}else if(this.options.size&&"auto"!=this.options.size&&this.$lis.not(k).length>this.options.size){var F=this.$lis.not(".divider").not(k).children().slice(0,this.options.size).last().parent().index(),E=this.$lis.slice(0,F+1).filter(".divider").length;t=g*this.options.size+E*w+_.vert,c.options.container?(u.data("height")||u.data("height",u.height()),i=u.data("height")):i=u.height(),c.options.dropupAuto&&this.$newElement.toggleClass("dropup",o>s&&t-x.vert<i),u.css({"max-height":t+v+m+y+b+"px",overflow:"hidden","min-height":""}),h.css({"max-height":t-_.vert+"px","overflow-y":"auto","min-height":""})}}},setWidth:function(){if("auto"===this.options.width){this.$menu.css("min-width","0");var e=this.$menu.parent().clone().appendTo("body"),t=this.options.container?this.$newElement.clone().appendTo("body"):e,n=e.children(".dropdown-menu").outerWidth(),i=t.css("width","auto").children("button").outerWidth();e.remove(),t.remove(),this.$newElement.css("width",Math.max(n,i)+"px")}else"fit"===this.options.width?(this.$menu.css("min-width",""),this.$newElement.css("width","").addClass("fit-width")):this.options.width?(this.$menu.css("min-width",""),
this.$newElement.css("width",this.options.width)):(this.$menu.css("min-width",""),this.$newElement.css("width",""));this.$newElement.hasClass("fit-width")&&"fit"!==this.options.width&&this.$newElement.removeClass("fit-width")},selectPosition:function(){this.$bsContainer=e('<div class="bs-container" />');var t,n,i,r=this,o=e(this.options.container),s=function(e){r.$bsContainer.addClass(e.attr("class").replace(/form-control|fit-width/gi,"")).toggleClass("dropup",e.hasClass("dropup")),t=e.offset(),o.is("body")?n={top:0,left:0}:(n=o.offset(),n.top+=parseInt(o.css("borderTopWidth"))-o.scrollTop(),n.left+=parseInt(o.css("borderLeftWidth"))-o.scrollLeft()),i=e.hasClass("dropup")?0:e[0].offsetHeight,r.$bsContainer.css({top:t.top-n.top+i,left:t.left-n.left,width:e[0].offsetWidth})};this.$button.on("click",function(){var t=e(this);r.isDisabled()||(s(r.$newElement),r.$bsContainer.appendTo(r.options.container).toggleClass("open",!t.hasClass("open")).append(r.$menu))}),e(window).on("resize scroll",function(){s(r.$newElement)}),this.$element.on("hide.bs.select",function(){r.$menu.data("height",r.$menu.height()),r.$bsContainer.detach()})},setSelected:function(e,t,n){n||(this.togglePlaceholder(),n=this.findLis().eq(this.liObj[e])),n.toggleClass("selected",t).find("a").attr("aria-selected",t)},setDisabled:function(e,t,n){n||(n=this.findLis().eq(this.liObj[e])),t?n.addClass("disabled").children("a").attr("href","#").attr("tabindex",-1).attr("aria-disabled",!0):n.removeClass("disabled").children("a").removeAttr("href").attr("tabindex",0).attr("aria-disabled",!1)},isDisabled:function(){return this.$element[0].disabled},checkDisabled:function(){var e=this;this.isDisabled()?(this.$newElement.addClass("disabled"),this.$button.addClass("disabled").attr("tabindex",-1).attr("aria-disabled",!0)):(this.$button.hasClass("disabled")&&(this.$newElement.removeClass("disabled"),this.$button.removeClass("disabled").attr("aria-disabled",!1)),this.$button.attr("tabindex")!=-1||this.$element.data("tabindex")||this.$button.removeAttr("tabindex")),this.$button.click(function(){return!e.isDisabled()})},togglePlaceholder:function(){var e=this.$element.val();this.$button.toggleClass("bs-placeholder",null===e||""===e||e.constructor===Array&&0===e.length)},tabIndex:function(){this.$element.data("tabindex")!==this.$element.attr("tabindex")&&this.$element.attr("tabindex")!==-98&&"-98"!==this.$element.attr("tabindex")&&(this.$element.data("tabindex",this.$element.attr("tabindex")),this.$button.attr("tabindex",this.$element.data("tabindex"))),this.$element.attr("tabindex",-98)},clickListener:function(){var t=this,n=e(document);n.data("spaceSelect",!1),this.$button.on("keyup",function(e){/(32)/.test(e.keyCode.toString(10))&&n.data("spaceSelect")&&(e.preventDefault(),n.data("spaceSelect",!1))}),this.$button.on("click",function(){t.setSize()}),this.$element.on("shown.bs.select",function(){if(t.options.liveSearch||t.multiple){if(!t.multiple){var e=t.liObj[t.$element[0].selectedIndex];if("number"!=typeof e||t.options.size===!1)return;var n=t.$lis.eq(e)[0].offsetTop-t.$menuInner[0].offsetTop;n=n-t.$menuInner[0].offsetHeight/2+t.sizeInfo.liHeight/2,t.$menuInner[0].scrollTop=n}}else t.$menuInner.find(".selected a").focus()}),this.$menuInner.on("click","li a",function(n){var i=e(this),o=i.parent().data("originalIndex"),s=t.$element.val(),a=t.$element.prop("selectedIndex"),l=!0;if(t.multiple&&1!==t.options.maxOptions&&n.stopPropagation(),n.preventDefault(),!t.isDisabled()&&!i.parent().hasClass("disabled")){var c=t.$element.find("option"),u=c.eq(o),h=u.prop("selected"),d=u.parent("optgroup"),f=t.options.maxOptions,p=d.data("maxOptions")||!1;if(t.multiple){if(u.prop("selected",!h),t.setSelected(o,!h),i.blur(),f!==!1||p!==!1){var g=f<c.filter(":selected").length,v=p<d.find("option:selected").length;if(f&&g||p&&v)if(f&&1==f)c.prop("selected",!1),u.prop("selected",!0),t.$menuInner.find(".selected").removeClass("selected"),t.setSelected(o,!0);else if(p&&1==p){d.find("option:selected").prop("selected",!1),u.prop("selected",!0);var m=i.parent().data("optgroup");t.$menuInner.find('[data-optgroup="'+m+'"]').removeClass("selected"),t.setSelected(o,!0)}else{var y="string"==typeof t.options.maxOptionsText?[t.options.maxOptionsText,t.options.maxOptionsText]:t.options.maxOptionsText,b="function"==typeof y?y(f,p):y,w=b[0].replace("{n}",f),_=b[1].replace("{n}",p),x=e('<div class="notify"></div>');b[2]&&(w=w.replace("{var}",b[2][f>1?0:1]),_=_.replace("{var}",b[2][p>1?0:1])),u.prop("selected",!1),t.$menu.append(x),f&&g&&(x.append(e("<div>"+w+"</div>")),l=!1,t.$element.trigger("maxReached.bs.select")),p&&v&&(x.append(e("<div>"+_+"</div>")),l=!1,t.$element.trigger("maxReachedGrp.bs.select")),setTimeout(function(){t.setSelected(o,!1)},10),x.delay(750).fadeOut(300,function(){e(this).remove()})}}}else c.prop("selected",!1),u.prop("selected",!0),t.$menuInner.find(".selected").removeClass("selected").find("a").attr("aria-selected",!1),t.setSelected(o,!0);!t.multiple||t.multiple&&1===t.options.maxOptions?t.$button.focus():t.options.liveSearch&&t.$searchbox.focus(),l&&(s!=t.$element.val()&&t.multiple||a!=t.$element.prop("selectedIndex")&&!t.multiple)&&(r=[o,u.prop("selected"),h],t.$element.triggerNative("change"))}}),this.$menu.on("click","li.disabled a, .popover-title, .popover-title :not(.close)",function(n){n.currentTarget==this&&(n.preventDefault(),n.stopPropagation(),t.options.liveSearch&&!e(n.target).hasClass("close")?t.$searchbox.focus():t.$button.focus())}),this.$menuInner.on("click",".divider, .dropdown-header",function(e){e.preventDefault(),e.stopPropagation(),t.options.liveSearch?t.$searchbox.focus():t.$button.focus()}),this.$menu.on("click",".popover-title .close",function(){t.$button.click()}),this.$searchbox.on("click",function(e){e.stopPropagation()}),this.$menu.on("click",".actions-btn",function(n){t.options.liveSearch?t.$searchbox.focus():t.$button.focus(),n.preventDefault(),n.stopPropagation(),e(this).hasClass("bs-select-all")?t.selectAll():t.deselectAll()}),this.$element.change(function(){t.render(!1),t.$element.trigger("changed.bs.select",r),r=null})},liveSearchListener:function(){var n=this,i=e('<li class="no-results"></li>');this.$button.on("click.dropdown.data-api",function(){n.$menuInner.find(".active").removeClass("active"),n.$searchbox.val()&&(n.$searchbox.val(""),n.$lis.not(".is-hidden").removeClass("hidden"),i.parent().length&&i.remove()),n.multiple||n.$menuInner.find(".selected").addClass("active"),setTimeout(function(){n.$searchbox.focus()},10)}),this.$searchbox.on("click.dropdown.data-api focus.dropdown.data-api touchend.dropdown.data-api",function(e){e.stopPropagation()}),this.$searchbox.on("input propertychange",function(){if(n.$lis.not(".is-hidden").removeClass("hidden"),n.$lis.filter(".active").removeClass("active"),i.remove(),n.$searchbox.val()){var r,o=n.$lis.not(".is-hidden, .divider, .dropdown-header");if(r=n.options.liveSearchNormalize?o.not(":a"+n._searchStyle()+'("'+t(n.$searchbox.val())+'")'):o.not(":"+n._searchStyle()+'("'+n.$searchbox.val()+'")'),r.length===o.length)i.html(n.options.noneResultsText.replace("{0}",'"'+l(n.$searchbox.val())+'"')),n.$menuInner.append(i),n.$lis.addClass("hidden");else{r.addClass("hidden");var s,a=n.$lis.not(".hidden");a.each(function(t){var n=e(this);n.hasClass("divider")?void 0===s?n.addClass("hidden"):(s&&s.addClass("hidden"),s=n):n.hasClass("dropdown-header")&&a.eq(t+1).data("optgroup")!==n.data("optgroup")?n.addClass("hidden"):s=null}),s&&s.addClass("hidden"),o.not(".hidden").first().addClass("active")}}})},_searchStyle:function(){var e={begins:"ibegins",startsWith:"ibegins"};return e[this.options.liveSearchStyle]||"icontains"},val:function(e){return"undefined"!=typeof e?(this.$element.val(e),this.render(),this.$element):this.$element.val()},changeAll:function(t){if(this.multiple){"undefined"==typeof t&&(t=!0),this.findLis();var n=this.$element.find("option"),i=this.$lis.not(".divider, .dropdown-header, .disabled, .hidden"),r=i.length,o=[];if(t){if(i.filter(".selected").length===i.length)return}else if(0===i.filter(".selected").length)return;i.toggleClass("selected",t);for(var s=0;s<r;s++){var a=i[s].getAttribute("data-original-index");o[o.length]=n.eq(a)[0]}e(o).prop("selected",t),this.render(!1),this.togglePlaceholder(),this.$element.triggerNative("change")}},selectAll:function(){return this.changeAll(!0)},deselectAll:function(){return this.changeAll(!1)},toggle:function(e){e=e||window.event,e&&e.stopPropagation(),this.$button.trigger("click")},keydown:function(n){var i,r,o,s,a,l,c,u,h,d=e(this),f=d.is("input")?d.parent().parent():d.parent(),p=f.data("this"),g=":not(.disabled, .hidden, .dropdown-header, .divider)",v={32:" ",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9"};if(p.options.liveSearch&&(f=d.parent().parent()),p.options.container&&(f=p.$menu),i=e('[role="listbox"] li',f),h=p.$newElement.hasClass("open"),!h&&(n.keyCode>=48&&n.keyCode<=57||n.keyCode>=96&&n.keyCode<=105||n.keyCode>=65&&n.keyCode<=90))return p.options.container?p.$button.trigger("click"):(p.setSize(),p.$menu.parent().addClass("open"),h=!0),void p.$searchbox.focus();if(p.options.liveSearch&&(/(^9$|27)/.test(n.keyCode.toString(10))&&h&&(n.preventDefault(),n.stopPropagation(),p.$menuInner.click(),p.$button.focus()),i=e('[role="listbox"] li'+g,f),d.val()||/(38|40)/.test(n.keyCode.toString(10))||0===i.filter(".active").length&&(i=p.$menuInner.find("li"),i=p.options.liveSearchNormalize?i.filter(":a"+p._searchStyle()+"("+t(v[n.keyCode])+")"):i.filter(":"+p._searchStyle()+"("+v[n.keyCode]+")"))),i.length){if(/(38|40)/.test(n.keyCode.toString(10)))r=i.index(i.find("a").filter(":focus").parent()),s=i.filter(g).first().index(),a=i.filter(g).last().index(),o=i.eq(r).nextAll(g).eq(0).index(),l=i.eq(r).prevAll(g).eq(0).index(),c=i.eq(o).prevAll(g).eq(0).index(),p.options.liveSearch&&(i.each(function(t){e(this).hasClass("disabled")||e(this).data("index",t)}),r=i.index(i.filter(".active")),s=i.first().data("index"),a=i.last().data("index"),o=i.eq(r).nextAll().eq(0).data("index"),l=i.eq(r).prevAll().eq(0).data("index"),c=i.eq(o).prevAll().eq(0).data("index")),u=d.data("prevIndex"),38==n.keyCode?(p.options.liveSearch&&r--,r!=c&&r>l&&(r=l),r<s&&(r=s),r==u&&(r=a)):40==n.keyCode&&(p.options.liveSearch&&r++,r==-1&&(r=0),r!=c&&r<o&&(r=o),r>a&&(r=a),r==u&&(r=s)),d.data("prevIndex",r),p.options.liveSearch?(n.preventDefault(),d.hasClass("dropdown-toggle")||(i.removeClass("active").eq(r).addClass("active").children("a").focus(),d.focus())):i.eq(r).children("a").focus();else if(!d.is("input")){var m,y,b=[];i.each(function(){e(this).hasClass("disabled")||e.trim(e(this).children("a").text().toLowerCase()).substring(0,1)==v[n.keyCode]&&b.push(e(this).index())}),m=e(document).data("keycount"),m++,e(document).data("keycount",m),y=e.trim(e(":focus").text().toLowerCase()).substring(0,1),y!=v[n.keyCode]?(m=1,e(document).data("keycount",m)):m>=b.length&&(e(document).data("keycount",0),m>b.length&&(m=1)),i.eq(b[m-1]).children("a").focus()}if((/(13|32)/.test(n.keyCode.toString(10))||/(^9$)/.test(n.keyCode.toString(10))&&p.options.selectOnTab)&&h){if(/(32)/.test(n.keyCode.toString(10))||n.preventDefault(),p.options.liveSearch)/(32)/.test(n.keyCode.toString(10))||(p.$menuInner.find(".active a").click(),d.focus());else{var w=e(":focus");w.click(),w.focus(),n.preventDefault(),e(document).data("spaceSelect",!0)}e(document).data("keycount",0)}(/(^9$|27)/.test(n.keyCode.toString(10))&&h&&(p.multiple||p.options.liveSearch)||/(27)/.test(n.keyCode.toString(10))&&!h)&&(p.$menu.parent().removeClass("open"),p.options.container&&p.$newElement.removeClass("open"),p.$button.focus())}},mobile:function(){this.$element.addClass("mobile-device")},refresh:function(){this.$lis=null,this.liObj={},this.reloadLi(),this.render(),this.checkDisabled(),this.liHeight(!0),this.setStyle(),this.setWidth(),this.$lis&&this.$searchbox.trigger("propertychange"),this.$element.trigger("refreshed.bs.select")},hide:function(){this.$newElement.hide()},show:function(){this.$newElement.show()},remove:function(){this.$newElement.remove(),this.$element.remove()},destroy:function(){this.$newElement.before(this.$element).remove(),this.$bsContainer?this.$bsContainer.remove():this.$menu.remove(),this.$element.off(".bs.select").removeData("selectpicker").removeClass("bs-select-hidden selectpicker")}};var h=e.fn.selectpicker;e.fn.selectpicker=n,e.fn.selectpicker.Constructor=u,e.fn.selectpicker.noConflict=function(){return e.fn.selectpicker=h,this},e(document).data("keycount",0).on("keydown.bs.select",'.bootstrap-select [data-toggle=dropdown], .bootstrap-select [role="listbox"], .bs-searchbox input',u.prototype.keydown).on("focusin.modal",'.bootstrap-select [data-toggle=dropdown], .bootstrap-select [role="listbox"], .bs-searchbox input',function(e){e.stopPropagation()}),e(window).on("load.bs.select.data-api",function(){e(".selectpicker").each(function(){var t=e(this);n.call(t,t.data())})})}(e)})},function(e,t){},,function(e,t,n){(function(e){!function(e,t,n,i){"use strict";var r="treeview",o={};o.settings={injectStyle:!0,levels:2,expandIcon:"glyphicon glyphicon-plus",collapseIcon:"glyphicon glyphicon-minus",emptyIcon:"glyphicon",nodeIcon:"",selectedIcon:"",checkedIcon:"glyphicon glyphicon-check",uncheckedIcon:"glyphicon glyphicon-unchecked",color:i,backColor:i,borderColor:i,onhoverColor:"#F5F5F5",selectedColor:"#FFFFFF",selectedBackColor:"#428bca",searchResultColor:"#D9534F",searchResultBackColor:i,enableLinks:!1,highlightSelected:!0,highlightSearchResults:!0,showBorder:!0,showIcon:!0,showCheckbox:!1,showTags:!1,multiSelect:!1,onNodeChecked:i,onNodeCollapsed:i,onNodeDisabled:i,onNodeEnabled:i,onNodeExpanded:i,onNodeSelected:i,onNodeUnchecked:i,onNodeUnselected:i,onSearchComplete:i,onSearchCleared:i},o.options={silent:!1,ignoreChildren:!1},o.searchOptions={ignoreCase:!0,exactMatch:!1,revealResults:!0};var s=function(t,n){return this.$element=e(t),this.elementId=t.id,this.styleId=this.elementId+"-style",this.init(n),{options:this.options,init:e.proxy(this.init,this),remove:e.proxy(this.remove,this),getNode:e.proxy(this.getNode,this),getParent:e.proxy(this.getParent,this),getSiblings:e.proxy(this.getSiblings,this),getSelected:e.proxy(this.getSelected,this),getUnselected:e.proxy(this.getUnselected,this),getExpanded:e.proxy(this.getExpanded,this),getCollapsed:e.proxy(this.getCollapsed,this),getChecked:e.proxy(this.getChecked,this),getUnchecked:e.proxy(this.getUnchecked,this),getDisabled:e.proxy(this.getDisabled,this),getEnabled:e.proxy(this.getEnabled,this),selectNode:e.proxy(this.selectNode,this),unselectNode:e.proxy(this.unselectNode,this),toggleNodeSelected:e.proxy(this.toggleNodeSelected,this),collapseAll:e.proxy(this.collapseAll,this),collapseNode:e.proxy(this.collapseNode,this),expandAll:e.proxy(this.expandAll,this),expandNode:e.proxy(this.expandNode,this),toggleNodeExpanded:e.proxy(this.toggleNodeExpanded,this),revealNode:e.proxy(this.revealNode,this),checkAll:e.proxy(this.checkAll,this),checkNode:e.proxy(this.checkNode,this),uncheckAll:e.proxy(this.uncheckAll,this),uncheckNode:e.proxy(this.uncheckNode,this),toggleNodeChecked:e.proxy(this.toggleNodeChecked,this),disableAll:e.proxy(this.disableAll,this),disableNode:e.proxy(this.disableNode,this),enableAll:e.proxy(this.enableAll,this),enableNode:e.proxy(this.enableNode,this),toggleNodeDisabled:e.proxy(this.toggleNodeDisabled,this),search:e.proxy(this.search,this),clearSearch:e.proxy(this.clearSearch,this)}};s.prototype.init=function(t){this.tree=[],this.nodes=[],t.data&&("string"==typeof t.data&&(t.data=e.parseJSON(t.data)),this.tree=e.extend(!0,[],t.data),delete t.data),this.options=e.extend({},o.settings,t),this.destroy(),this.subscribeEvents(),this.setInitialStates({nodes:this.tree},0),this.render()},s.prototype.remove=function(){this.destroy(),e.removeData(this,r),e("#"+this.styleId).remove()},s.prototype.destroy=function(){this.initialized&&(this.$wrapper.remove(),this.$wrapper=null,this.unsubscribeEvents(),this.initialized=!1)},s.prototype.unsubscribeEvents=function(){this.$element.off("click"),this.$element.off("nodeChecked"),this.$element.off("nodeCollapsed"),this.$element.off("nodeDisabled"),this.$element.off("nodeEnabled"),this.$element.off("nodeExpanded"),this.$element.off("nodeSelected"),this.$element.off("nodeUnchecked"),this.$element.off("nodeUnselected"),this.$element.off("searchComplete"),this.$element.off("searchCleared")},s.prototype.subscribeEvents=function(){this.unsubscribeEvents(),this.$element.on("click",e.proxy(this.clickHandler,this)),"function"==typeof this.options.onNodeChecked&&this.$element.on("nodeChecked",this.options.onNodeChecked),"function"==typeof this.options.onNodeCollapsed&&this.$element.on("nodeCollapsed",this.options.onNodeCollapsed),"function"==typeof this.options.onNodeDisabled&&this.$element.on("nodeDisabled",this.options.onNodeDisabled),"function"==typeof this.options.onNodeEnabled&&this.$element.on("nodeEnabled",this.options.onNodeEnabled),"function"==typeof this.options.onNodeExpanded&&this.$element.on("nodeExpanded",this.options.onNodeExpanded),"function"==typeof this.options.onNodeSelected&&this.$element.on("nodeSelected",this.options.onNodeSelected),"function"==typeof this.options.onNodeUnchecked&&this.$element.on("nodeUnchecked",this.options.onNodeUnchecked),"function"==typeof this.options.onNodeUnselected&&this.$element.on("nodeUnselected",this.options.onNodeUnselected),"function"==typeof this.options.onSearchComplete&&this.$element.on("searchComplete",this.options.onSearchComplete),"function"==typeof this.options.onSearchCleared&&this.$element.on("searchCleared",this.options.onSearchCleared)},s.prototype.setInitialStates=function(t,n){if(t.nodes){n+=1;var i=t,r=this;e.each(t.nodes,function(e,t){t.nodeId=r.nodes.length,t.parentId=i.nodeId,t.hasOwnProperty("selectable")||(t.selectable=!0),t.state=t.state||{},t.state.hasOwnProperty("checked")||(t.state.checked=!1),t.state.hasOwnProperty("disabled")||(t.state.disabled=!1),t.state.hasOwnProperty("expanded")||(!t.state.disabled&&n<r.options.levels&&t.nodes&&t.nodes.length>0?t.state.expanded=!0:t.state.expanded=!1),t.state.hasOwnProperty("selected")||(t.state.selected=!1),r.nodes.push(t),t.nodes&&r.setInitialStates(t,n)})}},s.prototype.clickHandler=function(t){this.options.enableLinks||t.preventDefault();var n=e(t.target),i=this.findNode(n);if(i&&!i.state.disabled){var r=n.attr("class")?n.attr("class").split(" "):[];-1!==r.indexOf("expand-icon")?(this.toggleExpandedState(i,o.options),this.render()):-1!==r.indexOf("check-icon")?(this.toggleCheckedState(i,o.options),this.render()):(i.selectable?this.toggleSelectedState(i,o.options):this.toggleExpandedState(i,o.options),this.render())}},s.prototype.findNode=function(e){var t=e.closest("li.list-group-item").attr("data-nodeid"),n=this.nodes[t];return n||console.log("Error: node does not exist"),n},s.prototype.toggleExpandedState=function(e,t){e&&this.setExpandedState(e,!e.state.expanded,t)},s.prototype.setExpandedState=function(t,n,i){n!==t.state.expanded&&(n&&t.nodes?(t.state.expanded=!0,i.silent||this.$element.trigger("nodeExpanded",e.extend(!0,{},t))):n||(t.state.expanded=!1,i.silent||this.$element.trigger("nodeCollapsed",e.extend(!0,{},t)),t.nodes&&!i.ignoreChildren&&e.each(t.nodes,e.proxy(function(e,t){this.setExpandedState(t,!1,i)},this))))},s.prototype.toggleSelectedState=function(e,t){e&&this.setSelectedState(e,!e.state.selected,t)},s.prototype.setSelectedState=function(t,n,i){n!==t.state.selected&&(n?(this.options.multiSelect||e.each(this.findNodes("true","g","state.selected"),e.proxy(function(e,t){this.setSelectedState(t,!1,i)},this)),t.state.selected=!0,i.silent||this.$element.trigger("nodeSelected",e.extend(!0,{},t))):(t.state.selected=!1,i.silent||this.$element.trigger("nodeUnselected",e.extend(!0,{},t))))},s.prototype.toggleCheckedState=function(e,t){e&&this.setCheckedState(e,!e.state.checked,t)},s.prototype.setCheckedState=function(t,n,i){n!==t.state.checked&&(n?(t.state.checked=!0,i.silent||this.$element.trigger("nodeChecked",e.extend(!0,{},t))):(t.state.checked=!1,i.silent||this.$element.trigger("nodeUnchecked",e.extend(!0,{},t))))},s.prototype.setDisabledState=function(t,n,i){n!==t.state.disabled&&(n?(t.state.disabled=!0,this.setExpandedState(t,!1,i),this.setSelectedState(t,!1,i),this.setCheckedState(t,!1,i),i.silent||this.$element.trigger("nodeDisabled",e.extend(!0,{},t))):(t.state.disabled=!1,i.silent||this.$element.trigger("nodeEnabled",e.extend(!0,{},t))))},s.prototype.render=function(){this.initialized||(this.$element.addClass(r),this.$wrapper=e(this.template.list),this.injectStyle(),this.initialized=!0),this.$element.empty().append(this.$wrapper.empty()),this.buildTree(this.tree,0)},s.prototype.buildTree=function(t,n){if(t){n+=1;var i=this;e.each(t,function(t,r){for(var o=e(i.template.item).addClass("node-"+i.elementId).addClass(r.state.checked?"node-checked":"").addClass(r.state.disabled?"node-disabled":"").addClass(r.state.selected?"node-selected":"").addClass(r.searchResult?"search-result":"").attr("data-nodeid",r.nodeId).attr("style",i.buildStyleOverride(r)),s=0;n-1>s;s++)o.append(i.template.indent);var a=[];if(r.nodes?(a.push("expand-icon"),a.push(r.state.expanded?i.options.collapseIcon:i.options.expandIcon)):a.push(i.options.emptyIcon),o.append(e(i.template.icon).addClass(a.join(" "))),i.options.showIcon){var a=["node-icon"];a.push(r.icon||i.options.nodeIcon),r.state.selected&&(a.pop(),a.push(r.selectedIcon||i.options.selectedIcon||r.icon||i.options.nodeIcon)),o.append(e(i.template.icon).addClass(a.join(" ")))}if(i.options.showCheckbox){var a=["check-icon"];a.push(r.state.checked?i.options.checkedIcon:i.options.uncheckedIcon),o.append(e(i.template.icon).addClass(a.join(" ")))}return o.append(i.options.enableLinks?e(i.template.link).attr("href",r.href).append(r.text):r.text),i.options.showTags&&r.tags&&e.each(r.tags,function(t,n){o.append(e(i.template.badge).append(n))}),i.$wrapper.append(o),r.nodes&&r.state.expanded&&!r.state.disabled?i.buildTree(r.nodes,n):void 0})}},s.prototype.buildStyleOverride=function(e){if(e.state.disabled)return"";var t=e.color,n=e.backColor;return this.options.highlightSelected&&e.state.selected&&(this.options.selectedColor&&(t=this.options.selectedColor),this.options.selectedBackColor&&(n=this.options.selectedBackColor)),this.options.highlightSearchResults&&e.searchResult&&!e.state.disabled&&(this.options.searchResultColor&&(t=this.options.searchResultColor),this.options.searchResultBackColor&&(n=this.options.searchResultBackColor)),"color:"+t+";background-color:"+n+";"},s.prototype.injectStyle=function(){this.options.injectStyle&&!n.getElementById(this.styleId)&&e('<style type="text/css" id="'+this.styleId+'"> '+this.buildStyle()+" </style>").appendTo("head")},s.prototype.buildStyle=function(){var e=".node-"+this.elementId+"{";return this.options.color&&(e+="color:"+this.options.color+";"),this.options.backColor&&(e+="background-color:"+this.options.backColor+";"),this.options.showBorder?this.options.borderColor&&(e+="border:1px solid "+this.options.borderColor+";"):e+="border:none;",e+="}",this.options.onhoverColor&&(e+=".node-"+this.elementId+":not(.node-disabled):hover{background-color:"+this.options.onhoverColor+";}"),this.css+e},s.prototype.template={list:'<ul class="list-group"></ul>',item:'<li class="list-group-item"></li>',indent:'<span class="indent"></span>',icon:'<span class="icon"></span>',link:'<a href="#" style="color:inherit;"></a>',badge:'<span class="badge"></span>'},s.prototype.css=".treeview .list-group-item{cursor:pointer}.treeview span.indent{margin-left:10px;margin-right:10px}.treeview span.icon{width:12px;margin-right:5px}.treeview .node-disabled{color:silver;cursor:not-allowed}",s.prototype.getNode=function(e){return this.nodes[e]},s.prototype.getParent=function(e){var t=this.identifyNode(e);return this.nodes[t.parentId]},s.prototype.getSiblings=function(e){var t=this.identifyNode(e),n=this.getParent(t),i=n?n.nodes:this.tree;return i.filter(function(e){return e.nodeId!==t.nodeId})},s.prototype.getSelected=function(){return this.findNodes("true","g","state.selected")},s.prototype.getUnselected=function(){return this.findNodes("false","g","state.selected")},s.prototype.getExpanded=function(){return this.findNodes("true","g","state.expanded")},s.prototype.getCollapsed=function(){return this.findNodes("false","g","state.expanded")},s.prototype.getChecked=function(){return this.findNodes("true","g","state.checked")},s.prototype.getUnchecked=function(){return this.findNodes("false","g","state.checked")},s.prototype.getDisabled=function(){return this.findNodes("true","g","state.disabled")},s.prototype.getEnabled=function(){return this.findNodes("false","g","state.disabled")},s.prototype.selectNode=function(t,n){this.forEachIdentifier(t,n,e.proxy(function(e,t){this.setSelectedState(e,!0,t)},this)),this.render()},s.prototype.unselectNode=function(t,n){this.forEachIdentifier(t,n,e.proxy(function(e,t){this.setSelectedState(e,!1,t)},this)),this.render()},s.prototype.toggleNodeSelected=function(t,n){this.forEachIdentifier(t,n,e.proxy(function(e,t){this.toggleSelectedState(e,t)},this)),this.render()},s.prototype.collapseAll=function(t){var n=this.findNodes("true","g","state.expanded");this.forEachIdentifier(n,t,e.proxy(function(e,t){this.setExpandedState(e,!1,t)},this)),this.render()},s.prototype.collapseNode=function(t,n){this.forEachIdentifier(t,n,e.proxy(function(e,t){this.setExpandedState(e,!1,t)},this)),this.render()},s.prototype.expandAll=function(t){if(t=e.extend({},o.options,t),t&&t.levels)this.expandLevels(this.tree,t.levels,t);else{var n=this.findNodes("false","g","state.expanded");this.forEachIdentifier(n,t,e.proxy(function(e,t){this.setExpandedState(e,!0,t)},this))}this.render()},s.prototype.expandNode=function(t,n){this.forEachIdentifier(t,n,e.proxy(function(e,t){this.setExpandedState(e,!0,t),e.nodes&&t&&t.levels&&this.expandLevels(e.nodes,t.levels-1,t)},this)),this.render()},s.prototype.expandLevels=function(t,n,i){i=e.extend({},o.options,i),e.each(t,e.proxy(function(e,t){this.setExpandedState(t,n>0,i),t.nodes&&this.expandLevels(t.nodes,n-1,i)},this))},s.prototype.revealNode=function(t,n){this.forEachIdentifier(t,n,e.proxy(function(e,t){for(var n=this.getParent(e);n;)this.setExpandedState(n,!0,t),n=this.getParent(n)},this)),this.render()},s.prototype.toggleNodeExpanded=function(t,n){this.forEachIdentifier(t,n,e.proxy(function(e,t){this.toggleExpandedState(e,t)},this)),this.render()},s.prototype.checkAll=function(t){var n=this.findNodes("false","g","state.checked");this.forEachIdentifier(n,t,e.proxy(function(e,t){this.setCheckedState(e,!0,t)},this)),this.render()},s.prototype.checkNode=function(t,n){this.forEachIdentifier(t,n,e.proxy(function(e,t){this.setCheckedState(e,!0,t)},this)),this.render()},s.prototype.uncheckAll=function(t){var n=this.findNodes("true","g","state.checked");this.forEachIdentifier(n,t,e.proxy(function(e,t){this.setCheckedState(e,!1,t)},this)),this.render()},s.prototype.uncheckNode=function(t,n){this.forEachIdentifier(t,n,e.proxy(function(e,t){this.setCheckedState(e,!1,t)},this)),this.render()},s.prototype.toggleNodeChecked=function(t,n){this.forEachIdentifier(t,n,e.proxy(function(e,t){this.toggleCheckedState(e,t)},this)),this.render()},s.prototype.disableAll=function(t){var n=this.findNodes("false","g","state.disabled");this.forEachIdentifier(n,t,e.proxy(function(e,t){this.setDisabledState(e,!0,t)},this)),this.render()},s.prototype.disableNode=function(t,n){this.forEachIdentifier(t,n,e.proxy(function(e,t){this.setDisabledState(e,!0,t)},this)),this.render()},s.prototype.enableAll=function(t){var n=this.findNodes("true","g","state.disabled");this.forEachIdentifier(n,t,e.proxy(function(e,t){this.setDisabledState(e,!1,t)},this)),this.render()},s.prototype.enableNode=function(t,n){this.forEachIdentifier(t,n,e.proxy(function(e,t){this.setDisabledState(e,!1,t)},this)),this.render()},s.prototype.toggleNodeDisabled=function(t,n){this.forEachIdentifier(t,n,e.proxy(function(e,t){this.setDisabledState(e,!e.state.disabled,t)},this)),this.render()},s.prototype.forEachIdentifier=function(t,n,i){n=e.extend({},o.options,n),t instanceof Array||(t=[t]),e.each(t,e.proxy(function(e,t){i(this.identifyNode(t),n)},this))},s.prototype.identifyNode=function(e){return"number"==typeof e?this.nodes[e]:e},s.prototype.search=function(t,n){n=e.extend({},o.searchOptions,n),this.clearSearch({render:!1});var i=[];if(t&&t.length>0){n.exactMatch&&(t="^"+t+"$");var r="g";n.ignoreCase&&(r+="i"),i=this.findNodes(t,r),e.each(i,function(e,t){t.searchResult=!0})}return n.revealResults?this.revealNode(i):this.render(),this.$element.trigger("searchComplete",e.extend(!0,{},i)),i},s.prototype.clearSearch=function(t){t=e.extend({},{render:!0},t);var n=e.each(this.findNodes("true","g","searchResult"),function(e,t){t.searchResult=!1});t.render&&this.render(),this.$element.trigger("searchCleared",e.extend(!0,{},n))},s.prototype.findNodes=function(t,n,i){n=n||"g",i=i||"text";var r=this;return e.grep(this.nodes,function(e){var o=r.getNodeValue(e,i);return"string"==typeof o?o.match(new RegExp(t,n)):void 0})},s.prototype.getNodeValue=function(e,t){var n=t.indexOf(".");if(n>0){var r=e[t.substring(0,n)],o=t.substring(n+1,t.length);return this.getNodeValue(r,o)}return e.hasOwnProperty(t)?e[t].toString():i};var a=function(e){t.console&&t.console.error(e)};e.fn[r]=function(t,n){var i;return this.each(function(){var o=e.data(this,r);"string"==typeof t?o?e.isFunction(o[t])&&"_"!==t.charAt(0)?(n instanceof Array||(n=[n]),i=o[t].apply(o,n)):a("No such method : "+t):a("Not initialized, can not call method : "+t):"boolean"==typeof t?i=o:e.data(this,r,new s(this,e.extend(!0,{},t)))}),i||this}}(e,window,document)}).call(t,n(2))}])});
//# sourceMappingURL=./public/js/dressdiscover.min.js.map